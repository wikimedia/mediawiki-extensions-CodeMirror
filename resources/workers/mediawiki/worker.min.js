(()=>{var ta=(gt,vt)=>()=>(vt||gt((vt={exports:{}}).exports,vt),vt.exports);var sa=ta((mc,ea)=>{ea.exports=(gt,vt,Tt,ce,is,ns)=>{self.onmessage=async({data:[Qt,Ot]})=>{switch(Qt){case"setConfig":gt(Ot);break;case"getConfig":postMessage([Qt,vt()]);break;case"setI18N":ce(Ot);break;case"getI18N":postMessage([Qt,is()]);break;case"setLintConfig":ns(Ot);break;case"lint":postMessage([Qt,await Tt(Ot),Ot])}}}});var ia=ta(()=>{"use strict";(()=>{var gt=Object.defineProperty,vt=Object.defineProperties,Tt=Object.getOwnPropertyDescriptors,ce=Object.getOwnPropertySymbols,is=Object.prototype.hasOwnProperty,ns=Object.prototype.propertyIsEnumerable,Qt=P=>{throw TypeError(P)},Ot=(P,L,U)=>L in P?gt(P,L,{enumerable:!0,configurable:!0,writable:!0,value:U}):P[L]=U,wt=(P,L)=>{for(var U in L||(L={}))is.call(L,U)&&Ot(P,U,L[U]);if(ce)for(var U of ce(L))ns.call(L,U)&&Ot(P,U,L[U]);return P},zt=(P,L)=>vt(P,Tt(L)),ra=(P,L)=>{var U={};for(var ot in P)is.call(P,ot)&&L.indexOf(ot)<0&&(U[ot]=P[ot]);if(P!=null&&ce)for(var ot of ce(P))L.indexOf(ot)<0&&ns.call(P,ot)&&(U[ot]=P[ot]);return U},la=(P,L)=>()=>(L||P((L={exports:{}}).exports,L),L.exports),qt=(P,L,U)=>Ot(P,typeof L!="symbol"?L+"":L,U),Ms=(P,L,U)=>L.has(P)||Qt("Cannot "+U),m=(P,L,U)=>(Ms(P,L,"read from private field"),U?U.call(P):L.get(P)),N=(P,L,U)=>L.has(P)?Qt("Cannot add the same private member more than once"):L instanceof WeakSet?L.add(P):L.set(P,U),F=(P,L,U,ot)=>(Ms(P,L,"write to private field"),ot?ot.call(P,U):L.set(P,U),U),M=(P,L,U)=>(Ms(P,L,"access private method"),U),oa=(P,L,U,ot)=>({set _(rs){F(P,L,rs,U)},get _(){return m(P,L,ot)}}),aa=la((P,L)=>{var U=Object.create,ot=Object.defineProperty,rs=Object.getOwnPropertyDescriptor,Rs=Object.getOwnPropertyNames,ca=Object.prototype.hasOwnProperty,Nn=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),ue=t=>{throw TypeError(t)},Fn=(t,e,s)=>e in t?ot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,En=(t,e)=>ot(t,"name",{value:e,configurable:!0}),I=(t,e)=>function(){return t&&(e=(0,t[Rs(t)[0]])(t=0)),e},Wn=(t,e)=>function(){return e||(0,t[Rs(t)[0]])((e={exports:{}}).exports,e),e.exports},it=(t,e)=>{for(var s in e)ot(t,s,{get:e[s],enumerable:!0})},ua=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Rs(e))!ca.call(t,i)&&i!==s&&ot(t,i,{get:()=>e[i],enumerable:!(n=rs(e,i))||n.enumerable});return t},X=t=>ua(ot({},"__esModule",{value:!0}),t),tt=t=>{var e;return[,,,U((e=t==null?void 0:t[Nn("metadata")])!=null?e:null)]},jn=["class","method","getter","setter","accessor","field","value","get","set"],Te=t=>t!==void 0&&typeof t!="function"?ue("Function expected"):t,ha=(t,e,s,n,i)=>({kind:jn[t],name:e,metadata:n,addInitializer:l=>s._?ue("Already initialized"):i.push(Te(l||null))}),_s=(t,e)=>Fn(e,Nn("metadata"),t[3]),J=(t,e,s,n)=>{for(var i=0,l=t[e>>1],r=l&&l.length;i<r;i++)e&1?l[i].call(s):n=l[i].call(s,n);return n},Q=(t,e,s,n,i,l)=>{var r,c,a,o,h,u=e&7,d=!!(e&8),g=!!(e&16),p=u>3?t.length+1:u?d?1:2:0,k=jn[u+5],S=u>3&&(t[p-1]=[]),$=t[p]||(t[p]=[]),x=u&&(!g&&!d&&(i=i.prototype),u<5&&(u>3||!g)&&rs(u<4?i:{get[s](){return pt(this,l)},set[s](y){return $t(this,l,y)}},s));u?g&&u<4&&En(l,(u>2?"set ":u>1?"get ":"")+s):En(i,s);for(var b=n.length-1;b>=0;b--)o=ha(u,s,a={},t[3],$),u&&(o.static=d,o.private=g,h=o.access={has:g?y=>ga(i,y):y=>s in y},u^3&&(h.get=g?y=>(u^1?pt:qs)(y,i,u^4?l:x.get):y=>y[s]),u>2&&(h.set=g?(y,f)=>$t(y,i,f,u^4?l:x.set):(y,f)=>y[s]=f)),c=(0,n[b])(u?u<4?g?l:x[k]:u>4?void 0:{get:x.get,set:x.set}:i,o),a._=1,u^4||c===void 0?Te(c)&&(u>4?S.unshift(c):u?g?l=c:x[k]=c:i=c):typeof c!="object"||c===null?ue("Object expected"):(Te(r=c.get)&&(x.get=r),Te(r=c.set)&&(x.set=r),Te(r=c.init)&&S.unshift(r));return u||_s(t,i),x&&ot(i,s,x),g?u^4?l:x:i},da=(t,e,s)=>Fn(t,typeof e!="symbol"?e+"":e,s),zs=(t,e,s)=>e.has(t)||ue("Cannot "+s),ga=(t,e)=>Object(e)!==e?ue('Cannot use the "in" operator on this value'):t.has(e),pt=(t,e,s)=>(zs(t,e,"read from private field"),s?s.call(t):e.get(t)),Bt=(t,e,s)=>e.has(t)?ue("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),$t=(t,e,s,n)=>(zs(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s),qs=(t,e,s)=>(zs(t,e,"access private method"),s),pa=(t,e,s,n)=>({set _(i){$t(t,e,i,s)},get _(){return pt(t,e,n)}}),Ln,ls,On=I({"base.ts"(){"use strict";Ln=(()=>{let t={redirect:1,onlyinclude:1,noinclude:1,include:1,comment:1,ext:1,arg:2,"magic-word":2,template:2,heading:2,html:3,table:4,hr:5,"double-underscore":5,link:6,category:6,file:6,quote:7,"ext-link":8,"free-ext-link":9,"magic-link":9,list:10,dd:10,converter:11,"list-range":11};return Object.setPrototypeOf(t,null),t})(),ls=(()=>{let t=["bold-header","format-leakage","fostered-content","h1","illegal-attr","insecure-style","invalid-gallery","invalid-imagemap","invalid-invoke","invalid-isbn","lonely-apos","lonely-bracket","lonely-http","nested-link","no-arg","no-duplicate","no-ignored","obsolete-attr","obsolete-tag","parsing-order","pipe-like","table-layout","tag-like","unbalanced-header","unclosed-comment","unclosed-quote","unclosed-table","unescaped","unknown-page","unmatched-tag","unterminated-url","url-encoding","var-anchor","void-ext"];return Object.freeze(t),t})()}});function At(t,e,s){return s===1?t.replace(/\0(\d+)g\x7F/gu,(n,i)=>At(String(e[i]),e,2)):s===2?t.replace(/\0(\d+)n\x7F/gu,(n,i)=>String(e[i])):t.replace(/\0(\d+)\x7F/gu,(n,i)=>e[i])}var Ut,Bs,he,de,ge,pe,Pn,yt,Yt,Mn,Rn,os,_n,zn,qn,Ne,fe,ft=I({"util/string.ts"(){"use strict";Ut=String.raw` \xA0\u1680\u2000-\u200A\u202F\u205F\u3000`,Bs=String.raw`[^[\]<>"\0-\x1F\x7F${Ut}\uFFFD]`,he=String.raw`(?:\[[\da-f:.]+\]|${Bs})`,de=String.raw`(?:${Bs}|\0\d+[cn!~]\x7F)*`,ge=t=>t.trim().toLowerCase(),pe=(t,e)=>s=>s.replace(t,e),Pn=pe(/[\0\x7F]|\r$/gmu,""),yt=pe(/\0\d+[cn]\x7F/gu,""),Yt=(t,e="")=>t.map(s=>typeof s=="string"?s:s.text()).join(e),Mn={lt:"<",gt:">",lbrack:"[",rbrack:"]",lbrace:"{",rbrace:"}",nbsp:" ",amp:"&",quot:'"'},Rn=pe(/&(?:#(\d+|[Xx][\da-fA-F]+)|([lg]t|[LG]T|[lr]brac[ke]|nbsp|amp|AMP|quot|QUOT));/gu,(t,e,s)=>e?String.fromCodePoint(+((/^x/iu.test(e)?"0":"")+e)):Mn[s.toLowerCase()]),os=t=>Rn(t),_n=pe(/&#(\d+|x[\da-f]+);/giu,(t,e)=>String.fromCodePoint(+((/^x/iu.test(e)?"0":"")+e))),zn={"&":"amp","<":"lt",">":"gt",'"':"quot","\n":"#10"},qn=t=>pe(t,e=>`&${zn[e]};`),Ne=qn(/[&<>]/gu),fe=(t,e={})=>{let{pre:s="",post:n="",sep:i=""}=e;return s+t.map(l=>l.print()).join(i)+n}}}),fa=Wn({"i18n/en.json"(t,e){e.exports={"attributes-of-closing-tag":"attributes of a closing tag","bold-apostrophes":"bold apostrophes","bold-in-header":"bold text in a section header",close:null,"closing-and-self-closing":"tag that is both closing and self-closing",comment:null,"conflicting-image-parameter":"conflicting image $1 parameter","content-outside-table":"content to be moved outside the table",decode:null,delink:null,"duplicate-attribute":"duplicate $1 attribute","duplicate-category":"duplicate category","duplicate-id":"duplicate HTML id","duplicate-image-parameter":"duplicate image $1 parameter","duplicate-parameter":"duplicate template parameter",encode:null,escape:null,expand:null,"ext-in-html":"extension tag in HTML tag attributes",frame:null,"full-width-punctuation":"full-width punctuation","header-in-html":"section header in HTML tag attributes","horizontal-alignment":null,"html-in-table":"HTML tag in table attributes","illegal-attribute-name":"invalid attribute name","illegal-attribute-value":"invalid attribute value","illegal-module":"invalid Scribunto module name","imagemap-without-image":"<imagemap> without an image","in-url":"$1 in URL","inconsistent-table":"inconsistent table layout","insecure-style":"insecure style","invalid-attribute":"element containing an invalid attribute name","invalid-content":"invalid content in <$1>","invalid-conversion-flag":"invalid conversion flag","invalid-gallery":"invalid gallery image","invalid-image-parameter":"invalid image parameter","invalid-imagemap-link":"invalid link in <imagemap>","invalid-isbn":"invalid ISBN","invalid-parameter":"invalid parameter of <$1>","invalid-self-closing":"invalid self-closing tag","invisible-triple-braces":"invisible content inside triple braces","italic-apostrophes":"italic apostrophes","left-bracket":"opening bracket","link-in-extlink":"internal link in an external link",lonely:'lonely "$1"',"missing-extension":"missing file extension","missing-function":"missing Scribunto module function name",newline:null,"no-self-closing":"no self-closing","nonzero-tabindex":"nonzero tabindex","nothing-in":"nothing should be in <$1>","obsolete-attribute":"obsolete attribute","obsolete-tag":"obsolete HTML tag",open:null,prefix:null,"pipe-in-link":'additional "|" in the link text',"pipe-in-table":'additional "|" in a table cell',remove:null,"template-in-link":"template in an internal link target","unbalanced-in-section-header":"unbalanced $1 in a section header",unclosed:"unclosed $1","unclosed-comment":"unclosed HTML comment","unclosed-quotes":"unclosed quotes","unclosed-table":"unclosed table","unclosed-tag":"unclosed tag","unescaped-query":"unescaped query string in an anonymous parameter","unexpected-argument":"unexpected template argument","unmatched-closing":"unmatched closing tag","unnecessary-encoding":"unnecessary percent-encoding in an internal link",uppercase:null,"useless-attribute":"useless attribute","useless-fragment":"useless fragment","useless-link-text":"useless link text","variable-anchor":"variable anchor in a section header","vertical-alignment":null,whitespace:null}}}),ma=Wn({"config/minimum.json"(t,e){e.exports={ext:[],html:[["b","bdi","del","i","ins","u","font","big","small","sub","sup","h1","h2","h3","h4","h5","h6","cite","code","em","s","strike","strong","tt","var","div","center","blockquote","ol","ul","dl","table","caption","pre","ruby","rb","rp","rt","rtc","p","span","abbr","dfn","kbd","samp","data","time","mark","tr","td","th","q","bdo"],["li","dt","dd"],["br","wbr","hr","meta","link"]],namespaces:{0:"",6:"File",10:"Template",14:"Category",828:"Module"},nsid:{"":0,file:6,template:10,category:14,module:828},functionHook:["msgnw"],variable:["!","=","pageid","articlepath","server","servername","scriptpath","stylepath"],parserFunction:[{msgnw:"msgnw",pageid:"pageid",articlepath:"articlepath",server:"server",servername:"servername",scriptpath:"scriptpath",stylepath:"stylepath","#language":"language","#special":"special","#speciale":"speciale","#tag":"tag","#formatdate":"formatdate","#dateformat":"formatdate","#invoke":"invoke","#while":"while","#dowhile":"dowhile","#loop":"loop","#forargs":"forargs","#fornumargs":"fornumargs","#if":"if","#ifeq":"ifeq","#switch":"switch","#ifexist":"ifexist","#ifexpr":"ifexpr","#iferror":"iferror","#time":"time","#timel":"timel","#expr":"expr","#rel2abs":"rel2abs","#titleparts":"titleparts","#categorytree":"categorytree","#urldecode":"urldecode","#choose":"choose","#var":"var","#varexists":"varexists","#var_final":"var_final","#vardefine":"vardefine","#vardefineecho":"vardefineecho","#widget":"widget","#related":"related","#regex":"regex","#regex_var":"regex_var","#regexquote":"regexquote","#regexall":"regexall","#len":"len","#pos":"pos","#rpos":"rpos","#sub":"sub","#count":"count","#rmatch":"rmatch","#rreplace":"rreplace","#replace":"replace","#rsplit":"rsplit","#explode":"explode","#tab":"tab","#seo":"seo","#babel":"babel","#translation":"translation","#commaseparatedlist":"commaseparatedlist","#coordinates":"coordinates","#lst":"lst","#lsth":"lsth","#lstx":"lstx","#assessment":"assessment","#mentor":"mentor","#property":"property","#target":"target","#section":"lst","#section-x":"lstx","#section-h":"lsth","#statements":"statements","#useliquidthreads":"useliquidthreads","#lqtpagelimit":"lqtpagelimit","#avatar":"avatar","#img":"img","#chart":"chart"},{"!":"!","=":"=","#FORMAL":"formal","#bcp47":"bcp47","#dir":"dir","#interwikilink":"interwikilink","#interlanguagelink":"interlanguagelink","#contentmodel":"contentmodel","#timef":"timef","#timefl":"timefl"},["msg","raw"],["subst","safesubst"]],doubleUnderscore:[[],[]],protocol:"bitcoin:|ftp://|ftps://|geo:|git://|gopher://|http://|https://|irc://|ircs://|magnet:|mailto:|matrix:|mms://|news:|nntp://|redis://|sftp://|sip:|sips:|sms:|ssh://|svn://|tel:|telnet://|urn:|wikipedia://|worldwind://|xmpp:",interwiki:[],img:{},redirection:["#redirect"],variants:[]}}}),St,Bn,Us,Dt=I({"util/constants.ts"(){"use strict";St=11,Bn=fa(),Us=ma()}});function me(t){let e=new Map,s=new WeakMap;return n=>{let i=typeof n=="string"?e:s;if(i.has(n)){let r=i.get(n);return r.lastIndex=0,r}let l=t(n);return i.set(n,l),l}}var Fe,Un,Kt=I({"../common/dist/index.mjs"(){"use strict";Fe=t=>decodeURIComponent(t.replace(/%(?![\da-f]{2})/giu,"%25")),Un=me}}),at,ut=I({"lib/rect.ts"(){"use strict";var t,e,s,n,i,l;at=(l=class{constructor(r,c){N(this,n),N(this,t),N(this,e),N(this,s),F(this,t,r),F(this,e,c)}get start(){return m(this,e)}get top(){return M(this,n,i).call(this).top}get left(){return M(this,n,i).call(this).left}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakSet,i=function(){var r;return(r=m(this,s))!=null||F(this,s,m(this,t).getRootNode().posFromIndex(m(this,e))),m(this,s)},l)}}),Dn,Hn,Ee,Ds,Hs,_,Z,Nt,as,V,Gs,Ht,Vs,Zs,Xs,We,xe,Js,te,Gn,D=I({"util/lint.ts"(){"use strict";Kt(),Lt(),ut(),q(),Dn=new Set(["tr","td","th","caption"]),Hn=new Set(["Template:!!","Template:!-"]),Ee=t=>{let e=t.childNodes.find(s=>s.text().trim());if(!e||e.type==="text"&&e.data.trim().startsWith("!")||e.is("magic-word")&&e.name==="!"||e.is("template")&&Hn.has(e.name)||e.is("html")&&Dn.has(e.name))return!1;if(e.is("arg"))return e.length>1&&Ee(e.childNodes[1]);if(e.is("magic-word"))try{let s=e.getPossibleValues().map(Ee);return s.includes(2)?2:s.includes(1)&&1}catch(s){}return e.is("template")||e.is("magic-word")&&e.name==="invoke"?1:2},Ds=(t,e,s,n)=>({line:t+s-1,character:(s===1?e:0)+n}),Hs=t=>(e,s,n,i,l="error")=>{let{start:r}=s,{top:c,left:a}=s instanceof at?s:new at(e,r),{offsetHeight:o,offsetWidth:h}=e,{startIndex:u,startLine:d,startCol:g}=t(e,r,c,a),{line:p,character:k}=Ds(d,g,o,h);return{rule:n,message:T.msg(i),severity:l,startIndex:u,endIndex:u+e.toString().length,startLine:d,endLine:p,startCol:g,endCol:k}},_=Hs((t,e,s,n)=>{let i=t.getRelativeIndex(),{top:l,left:r}=t.parentNode.posFromIndex(i);return{startIndex:e+i,startLine:s+l,startCol:l?r:n+r}}),Z=Hs((t,e,s,n)=>({startIndex:e,startLine:s,startCol:n})),Nt=(t,e,s,n=0)=>({desc:T.msg(e),range:[t.startIndex+n,t.endIndex],text:s}),as=(t,e,s)=>({desc:T.msg(e),range:[t,t],text:s}),V=(t,e=0,s="")=>typeof t=="number"?{desc:T.msg("remove"),range:[t,t+e],text:s}:Nt(t,"remove",s,e),Gs=(t,e)=>Nt(t,"decode",Fe(e.text().replace(/%(?=21|3[ce]|5[bd]|7[b-d])/giu,"%25"))),Ht=(t,e,s=0)=>({desc:T.msg("close"),range:[t+s,t],text:e}),Vs=t=>({desc:T.msg("open"),range:[t+1,t+2],text:""}),Zs=(t,e)=>Nt(t,"comment",`<!--${e}-->`),Xs=(t,e)=>Nt(t,"uppercase",e.toUpperCase()),We=(t,e=0)=>({desc:T.msg("whitespace"),range:[t,t+e],text:" "}),xe=(t,e,s=1)=>({desc:T.msg("escape"),range:[t,t+s],text:e.repeat(s)}),Js=(t,e)=>({desc:T.msg("escape"),range:[t,t+e.length],text:e.replace(/\|/gu,"&#124;")}),te=(t,e,s,n)=>{if(t&&(n||T.viewOnly&&t[0]===It.rev))return t[1];let i=e();return(n||T.viewOnly)&&s([It.rev,i]),i},Gn=(t,e)=>t==="ol"&&e==="type"?["1","a","A","i","I"]:t==="th"&&e==="scope"?["row","col","rowgroup","colgroup"]:e==="dir"?["ltr","rtl","auto"]:e==="aria-hidden"?["true","false"]:[]}}),Vn,Qs,Zn=I({"parser/selector.ts"(){"use strict";Vn=(t,e,s)=>{if(t.includes("#")){let n=t.indexOf("#");return(n===0||t.slice(0,n)===e)&&t.slice(n+1)===s}return!t||t===e},Qs=(t,e,s)=>{let n=t.split(",");return({type:i,name:l})=>n.some(r=>Vn(r.trim(),i,l))}}}),cs,Ys=I({"mixin/cached.ts"(){"use strict";D(),cs=(t=!0)=>e=>{let s=new WeakMap;return function(...n){return te(s.get(this),()=>e.apply(this,n),i=>{s.set(this,i)},t)}}}}),Xn,xa=I({"mixin/nodeLike.ts"(){"use strict";Xn=t=>{class e extends t{get firstChild(){return this.childNodes[0]}get lastChild(){return this.childNodes[this.childNodes.length-1]}get offsetHeight(){return this.getDimension().height}get offsetWidth(){return this.getDimension().width}}return e}}}),Jn,Qn,us,je,Le,hs,Oe,Pe,Me,ee,Yn=I({"lib/node.ts"(){"use strict";D(),Lt(),Ys(),xa(),q(),Qn=[Xn],Jn=[cs(!1)],ee=class{constructor(){J(Me,5,this),da(this,"childNodes",[]),Bt(this,us),Bt(this,je),Bt(this,Le),Bt(this,hs),Bt(this,Oe),Bt(this,Pe,{})}get parentNode(){return pt(this,us)}get nextSibling(){return pt(this,je)}get previousSibling(){return pt(this,Le)}getChildNodes(){let{childNodes:t}=this;return Object.isFrozen(t)?[...t]:t}getAttribute(t){return t==="padding"?0:this[t]}setAttribute(t,e){switch(t){case"parentNode":$t(this,us,e),e||($t(this,je,void 0),$t(this,Le,void 0));break;case"nextSibling":$t(this,je,e);break;case"previousSibling":$t(this,Le,e);break;case"aIndex":T.viewOnly&&$t(this,Oe,[It.rev,e]);break;default:this[t]=e}}getRootNode(){return te(pt(this,hs),()=>{var t,e;return(e=(t=this.parentNode)==null?void 0:t.getRootNode())!=null?e:this},t=>{let[,e]=t;e.type==="root"&&$t(this,hs,t)})}indexFromPos(t,e){this.lspError("AstNode.indexFromPos")}posFromIndex(t){let{length:e}=String(this);if(t+=t<0?e:0,t>=0&&t<=e){let s=this.getLines(),n=s.findIndex(([,,i])=>t<=i);return{top:n,left:t-s[n][1]}}}getDimension(){let t=this.getLines(),e=t[t.length-1];return{height:t.length,width:e[2]-e[1]}}getGaps(t){return 0}getRelativeIndex(t){if(t===void 0){let{parentNode:e}=this;return e?e.getRelativeIndex(e.childNodes.indexOf(this)):0}return te(pt(this,Pe)[t],()=>{let{childNodes:e}=this,s=t+(t<0?e.length:0),n=this.getAttribute("padding");for(let i=0;i<s;i++)T.viewOnly&&(pt(this,Pe)[i]=[It.rev,n]),n+=e[i].toString().length+this.getGaps(i);return n},e=>{pt(this,Pe)[t]=e})}getAbsoluteIndex(){return te(pt(this,Oe),()=>{let{parentNode:t}=this;return t?t.getAbsoluteIndex()+this.getRelativeIndex():0},t=>{$t(this,Oe,t)})}getBoundingClientRect(){this.lspError("AstNode.getBoundingClientRect")}is(t){return this.type===t}getLines(){let t=[],e=0;for(let s of String(this).split(`
`)){let n=e+s.length;t.push([s,e,n]),e=n+1}return t}seal(t,e){let s=!e&&!!this[t];Object.defineProperty(this,t,{enumerable:s,configurable:!0})}lspError(t){throw new Error(`${t} method is only available in the LSP version!`)}},Me=tt(null),us=new WeakMap,je=new WeakMap,Le=new WeakMap,hs=new WeakMap,Oe=new WeakMap,Pe=new WeakMap,Q(Me,1,"getLines",Jn,ee),ee=Q(Me,0,"AstNode",Qn,ee),J(Me,1,ee)}}),Kn,ba=I({"mixin/elementLike.ts"(){"use strict";Zn(),Kn=t=>{var e,s;class n extends t{constructor(){super(...arguments),N(this,e)}getElementBy(l){for(let r of this.childNodes){if(r.type==="text")continue;if(l(r))return r;let c=r.getElementBy(l);if(c)return c}}querySelector(l){return this.getElementBy(M(this,e,s).call(this,l))}getElementsBy(l,r=[]){for(let c of this.childNodes)c.type!=="text"&&(l(c)&&r.push(c),c.getElementsBy(l,r));return r}querySelectorAll(l){return this.getElementsBy(M(this,e,s).call(this,l))}escape(){}}return e=new WeakSet,s=function(i){return Qs(i,this)},n}}}),tr,Ks,er,Re,va=I({"lib/element.ts"(){"use strict";ft(),Lt(),Zn(),Yn(),ba(),tr=[Kn],Re=class extends(er=ee){get length(){return this.childNodes.length}text(t){return Yt(this.childNodes,t)}normalize(){let t=this.getChildNodes(),e=s=>{var n,i;t.splice(s,1),(n=t[s-1])==null||n.setAttribute("nextSibling",t[s]),(i=t[s])==null||i.setAttribute("previousSibling",t[s-1])};for(let s=t.length-1;s>=0;s--){let{type:n,data:i}=t[s];n!=="text"||t.length===1||this.getGaps(s-(s&&1))||i===""&&e(s)}this.setAttribute("childNodes",t)}removeAt(t){this.lspError("AstElement.removeAt")}insertAt(t,e=this.length){return xn(this,e,0,[t]),t}closest(t){let e=Qs(t,this),{parentNode:s}=this;for(;s;){if(e(s))return s;({parentNode:s}=s)}}append(...t){this.safeAppend(t)}safeAppend(t){for(let e of t)this.insertAt(e)}safeReplaceChildren(t){}setText(t,e=0){e+=e<0?this.length:0;let s=this.childNodes[e],{data:n}=s;return s.replaceData(t),n}toString(t,e=""){return this.childNodes.map(s=>s.toString(t)).join(e)}caretPositionFromIndex(t){this.lspError("AstElement.caretPositionFromIndex")}elementFromIndex(t){this.lspError("AstElement.elementFromIndex")}elementFromPoint(t,e){this.lspError("AstElement.elementFromPoint")}lint(t=this.getAbsoluteIndex(),e){{let s=[];for(let n=0,i=t+this.getAttribute("padding");n<this.length;n++){let l=this.childNodes[n];l.setAttribute("aIndex",i);let r=l.lint(i,e);r.length>0&&s.push(...r),i+=l.toString().length+this.getGaps(n)}return s}}print(t={}){let e=t.class;return this.toString()?(e===""?"":`<span class="wpb-${e!=null?e:this.type}${this.getAttribute("invalid")?" wpb-invalid":""}">`)+fe(this.childNodes,t)+(e===""?"":"</span>"):""}json(t,e=this.getAbsoluteIndex()){this.lspError("AstElement.json")}},Ks=tt(er),Re=Q(Ks,0,"AstElement",tr,Re),J(Ks,1,Re)}}),ds,ti,ei,sr,ir,nr,rr,si,lr,ii,wa=I({"lib/text.ts"(){"use strict";var t,e,s;ft(),D(),q(),Yn(),ds=String.raw`[${Ut}\t]*`,ti=String.raw`[^\S\n]*`,ei=String.raw`<${ti}(?:/${ti})?([a-z]\w*)|\{+|\}+|\[{2,}|\[(?![^[]*?\])|((?:^|\])[^[]*?)\]+|(?:rfc|pmid)(?=[-:：]?${ds}\d)|isbn(?=[-:：]?${ds}(?:\d(?:${ds}|-)){6})`,sr=new RegExp(String.raw`${ei}|https?[:/]/+`,"giu"),ir=new RegExp(ei,"giu"),nr=new Set(["attr-value","ext-link-text","link-text"]),rr={"[":/[[\]]/u,"{":/[{}]/u,"]":/[[\]](?=[^[\]]*$)/u,"}":/[{}](?=[^{}]*$)/u},si=new Set(["html","head","style","title","body","a","audio","img","video","embed","iframe","object","canvas","script","col","colgroup","tbody","tfoot","thead","button","input","label","option","select","textarea"]),lr=(()=>{try{return new RegExp(String.raw`[\p{L}\p{N}_]`,"u")}catch(n){return/\w/u}})(),ii=(s=class extends ee{constructor(n){super(),N(this,t),qt(this,"data",""),this.data=n}get type(){return"text"}toString(n){var i;return n&&!((i=this.parentNode)!=null&&i.getAttribute("built"))?yt(this.data):this.data}text(){return this.data}lint(n=this.getAbsoluteIndex(),i){var l,r,c;{if(i===!1)return[];let{data:a,parentNode:o,nextSibling:h,previousSibling:u}=this;if(!o)throw new Error("An isolated text node cannot be linted!");let{type:d,name:g,parentNode:p}=o;if(d==="attr-value"){let{name:B,tag:Y}=p;if(Y==="ref"&&(B==="name"||B==="follow")||B==="group"&&(Y==="ref"||Y==="references")||Y==="choose"&&(B==="before"||B==="after"))return[]}if(i!=null||(i=d==="free-ext-link"||d==="ext-link-url"||d==="ext-link-text"||d==="image-parameter"&&g==="link"||d==="attr-value"?ir:sr),a.search(i)===-1)return[];i.lastIndex=0;let k=[],S=h==null?void 0:h.type,$=h==null?void 0:h.name,x=u==null?void 0:u.type,b=this.getRootNode(),y=b.toString(),{ext:f,html:w,variants:v}=b.getAttribute("config"),{top:A,left:C}=b.posFromIndex(n),{lintConfig:E}=T,W=E.rules["tag-like"],R=typeof W=="object"&&W[1]?new Set(Object.keys(W[1]).filter(B=>B!=="invalid"&&B!=="disallowed")):new Set,H=new Set(["onlyinclude","noinclude","includeonly",...f,...w[0],...w[1],...w[2],...R,...E.getSeverity("tag-like","disallowed")?si:[]]);for(let B=i.exec(a);B;B=i.exec(a)){let[,Y,kt]=B,{index:st,0:G}=B;if(kt&&kt!=="]"){let{length:xt}=kt;st+=xt,G=G.slice(xt)}G=G.toLowerCase();let[j]=G,et=j==="r"||j==="p"||j==="i",K=j==="{",nt=j==="}",ct=j==="[",ht=j==="]",{length:rt}=G;if(j==="<"&&!H.has(Y.toLowerCase())||ct&&d==="ext-link-text"&&(/&(?:rbrack|#93|#x5[Dd];);/u.test(a.slice(st+1))||h!=null&&h.is("ext")&&$==="nowiki"&&(l=h.innerText)!=null&&l.includes("]"))||et&&(!o.isPlain()||nr.has(d)))continue;ht&&(st||rt>1)&&i.lastIndex--;let Rt=n+st,_t=Rt+rt,dt,Ct,Ce=y[_t],$n=y[Rt-1],An=K||ct,In=K&&$n==="-"&&v.length>0,Cn=nt&&Ce==="-"&&v.length>0,Xo=ct&&S==="free-ext-link"&&!a.slice(st+1).trim()||ht&&x==="free-ext-link"&&!a.slice(0,st).includes("]");if(et)dt="lonely-http",G=G.toUpperCase(),Ct=E.getSeverity(dt,G);else if(j==="<"){dt="tag-like";let xt;/^<\/?\s/u.test(G)||!/[\s/>]/u.test(Ce!=null?Ce:"")?xt="invalid":R.has(Y)?xt=Y:si.has(Y)&&!f.includes(Y)&&(xt="disallowed"),Ct=E.getSeverity(dt,xt)}else if(In||Cn)dt="lonely-bracket",Ct=E.getSeverity(dt,"converter"),In&&st>0?(G="-{",st--,Rt--,rt=2):Cn&&st<a.length-1&&(G="}-",_t++,rt=2);else if(Xo)dt="lonely-bracket",Ct=E.getSeverity(dt,"extLink");else if(An||nt||ht)if(dt="lonely-bracket",rt>1||K&&Ce===j||nt&&$n===j)Ct=E.getSeverity(dt,"double");else{if(!ct||d!=="ext-link-text"){let xt=rr[j],Tn=An?a.slice(st+1):a.slice(0,st);if(K&&((r=xt.exec(Tn))==null?void 0:r[0])==="}"||nt&&((c=xt.exec(Tn))==null?void 0:c[0])==="{")continue;if(!Tn.includes(j)){let Ko=An?"nextSibling":"previousSibling",ae=this[Ko];for(;ae&&(ae.type!=="text"||!xt.test(ae.data));)ae=ae[Ko];if(ae&&xt.exec(ae.data)[0]!==j)continue}}Ct=E.getSeverity(dt,"single")}else dt="lonely-http",Ct=E.getSeverity(dt);if(!Ct)continue;let Jo=this.posFromIndex(st),{line:Qo,character:Yo}=Ds(A,C,Jo.top+1,Jo.left),oe={rule:dt,message:T.msg("lonely",et||j==="h"||In||Cn?G:j),severity:Ct,startIndex:Rt,endIndex:_t,startLine:Qo,endLine:Qo,startCol:Yo,endCol:Yo+rt};if(E.computeEditInfo)if(j==="<")oe.suggestions=[xe(Rt,"&lt;")];else if(j==="h"&&d!=="link-text"&&lr.test($n||""))oe.suggestions=[We(Rt)];else if(ct&&d==="ext-link-text"){let xt=o.getAbsoluteIndex()+o.toString().length;oe.suggestions=[xe(xt,"&#93;")]}else if(ht&&Xo){let xt=n-u.toString().length;oe.suggestions=[as(xt,"left-bracket","[")]}else et&&(oe.suggestions=[...B[0]===G?[]:[Xs(oe,G)],...Ce===":"||Ce==="："?[We(_t,1)]:[]]);k.push(oe)}return k}}replaceData(n){M(this,t,e).call(this,n)}splitText(n){this.lspError("AstText.splitText")}escape(){}print(){return Ne(this.data)}},t=new WeakSet,e=function(n){this.setAttribute("data",n)},s)}}),se,be=I({"mixin/hidden.ts"(){"use strict";se=(t=!0,e=!0)=>s=>{class n extends s{text(){return""}lint(l){return t?[]:super.lint(l)}}return n}}}),jt,Pt=I({"mixin/noEscape.ts"(){"use strict";jt=t=>{}}}),ie,ve=I({"src/syntax.ts"(){"use strict";var t,e;z(),ie=(e=class extends O{constructor(s,n,i,l,r){super(s,i,l,r),N(this,t),F(this,t,n)}get type(){return m(this,t)}lint(s=this.getAbsoluteIndex()){return super.lint(s,!1)}},t=new WeakMap,e)}}),Mt,Gt=I({"mixin/padded.ts"(){"use strict";Mt=({length:t})=>e=>{class s extends e{getAttribute(i){return i==="padding"?t:super.getAttribute(i)}}return s}}}),bt,Vt=I({"src/atom.ts"(){"use strict";var t,e;z(),bt=(e=class extends O{constructor(s,n,i,l,r){super(s,i,l,r),N(this,t),F(this,t,n)}get type(){return m(this,t)}set type(s){F(this,t,s)}getAttribute(s){var n;return s==="invalid"?this.type==="converter-flag"&&!!((n=this.parentNode)!=null&&n.isInvalidFlag(this)):super.getAttribute(s)}},t=new WeakMap,e)}}),or,ar,ni,cr,Zt,gs=I({"src/link/base.ts"(){"use strict";var t,e,s,n;D(),Dt(),ut(),Gt(),Pt(),q(),z(),Vt(),or=i=>i==="redirect-target"||i==="link",ar=[jt,Mt("[[")],Zt=(n=class extends(cr=O){constructor(i,l,r,c=[],a="|"){if(super(void 0,r,c,{}),N(this,t,!0),N(this,e),N(this,s),this.insertAt(new bt(i,"link-target",r,c,{})),l!==void 0){let o=new O(l,r,c,{});o.type="link-text",o.setAttribute("stage",St-1),this.insertAt(o)}F(this,e,a)}get link(){}get fragment(){}afterBuild(){F(this,s,this.getTitle()),m(this,e).includes("\0")&&F(this,e,this.buildFromStr(m(this,e),0)),this.setAttribute("name",m(this,s).title),super.afterBuild()}setAttribute(i,l){i==="bracket"?F(this,t,l):i==="title"?F(this,s,l):super.setAttribute(i,l)}toString(i){let l=super.toString(i,m(this,e));return m(this,t)?`[[${l}]]`:l}text(){let i=super.text("|");return m(this,t)?`[[${i}]]`:i}getAttribute(i){return i==="title"?m(this,s):super.getAttribute(i)}getGaps(i){return i===0?m(this,e).length:1}lint(i=this.getAbsoluteIndex(),l){{let r=super.lint(i,l),{childNodes:[c,a],type:o}=this,{encoded:h,fragment:u}=m(this,s),{lintConfig:d}=T,{computeEditInfo:g,fix:p}=d,k=new at(this,i),S="unknown-page",$=d.getSeverity(S);if($&&c.childNodes.some(({type:x})=>x==="template")&&r.push(_(c,k,S,"template-in-link",$)),S="url-encoding",$=d.getSeverity(S),$&&h){let x=_(c,k,S,"unnecessary-encoding",$);(g||p)&&(x.fix=Gs(x,c)),r.push(x)}if(S="pipe-like",$=d.getSeverity(S,"link"),$&&(o==="link"||o==="category")){let x=a==null?void 0:a.childNodes.findIndex(y=>y.type==="text"&&y.data.includes("|")),b=a==null?void 0:a.childNodes[x];if(b){let y=_(a,k,S,"pipe-in-link",$);if(g){let f=y.startIndex+a.getRelativeIndex(x);y.suggestions=[Js(f,b.data)]}r.push(y)}}if(S="no-ignored",$=d.getSeverity(S,"fragment"),$&&u!==void 0&&!or(o)){let x=_(c,k,S,"useless-fragment",$);if(g||p){let b=c.childNodes.findIndex(f=>f.type==="text"&&f.data.includes("#")),y=c.childNodes[b];y&&(x.fix=V(x,c.getRelativeIndex(b)+y.data.indexOf("#")))}r.push(x)}return r}}getTitle(i,l){return this.normalizeTitle(this.firstChild.text(),0,{halfParsed:l,temporary:i,decode:!0,selfLink:!0})}print(){return super.print(m(this,t)?{pre:"[[",post:"]]",sep:m(this,e)}:{sep:m(this,e)})}json(i,l=this.getAbsoluteIndex()){let r=super.json(void 0,l)}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n),ni=tt(cr),Zt=Q(ni,0,"LinkBaseToken",ar,Zt),J(ni,1,Zt)}}),ur,ri,hr,Ft,ne=I({"src/nowiki/base.ts"(){"use strict";Pt(),z(),ur=[jt],Ft=class extends(hr=O){get innerText(){return this.firstChild.data}constructor(t="",e,s){super(t,e,s)}},ri=tt(hr),Ft=Q(ri,0,"NowikiBaseToken",ur,Ft),J(ri,1,Ft)}}),dr,li,gr,mt,Xt=I({"src/nowiki/noinclude.ts"(){"use strict";be(),ne(),dr=[se()],mt=class extends(gr=Ft){get type(){return"noinclude"}toString(t){return t?"":super.toString()}},li=tt(gr),mt=Q(li,0,"NoincludeToken",dr,mt),J(li,1,mt)}}),pr,ya=I({"src/link/redirectTarget.ts"(){"use strict";D(),q(),gs(),Xt(),pr=class extends Zt{get type(){return"redirect-target"}constructor(t,e,s,n){super(t,void 0,s,n),e!==void 0&&this.insertAt(new mt(e,s,n))}getTitle(){return this.normalizeTitle(this.firstChild.toString(),0,{halfParsed:!0,decode:!0})}lint(t=this.getAbsoluteIndex()){{let e=super.lint(t,!1),s="no-ignored",{lintConfig:n}=T,i=n.getSeverity(s,"redirect");if(i&&this.length===2){let l=_(this.lastChild,{start:t},s,"useless-link-text",i);l.startIndex--,l.startCol--,(n.computeEditInfo||n.fix)&&(l.fix=V(l)),e.push(l)}return e}}}}}),fr,oi,mr,_e,ka=I({"src/redirect.ts"(){"use strict";var t,e,s;be(),Pt(),z(),ve(),ya(),fr=[se(!1,!1),jt],_e=(s=class extends(mr=O){constructor(n,i,l,r,c,a,o=[]){super(void 0,a,o),N(this,t),N(this,e),F(this,t,n),F(this,e,c),this.append(new ie(i,"redirect-syntax",a,o),new pr(l,r==null?void 0:r.slice(1),a,o))}get type(){return"redirect"}getAttribute(n){return n==="padding"?m(this,t).length:super.getAttribute(n)}toString(n){return m(this,t)+super.toString(n)+m(this,e)}lint(n=this.getAbsoluteIndex()){{let i=n+m(this,t).length+this.firstChild.toString().length;return this.lastChild.setAttribute("aIndex",i),this.lastChild.lint(i)}}print(){return super.print({pre:m(this,t),post:m(this,e)})}},t=new WeakMap,e=new WeakMap,s),oi=tt(mr),_e=Q(oi,0,"RedirectToken",fr,_e),J(oi,1,_e)}}),xr={};it(xr,{parseRedirect:()=>br});var br,Sa=I({"parser/redirect.ts"(){"use strict";q(),ka(),br=(t,e,s)=>{var n;(n=e.regexRedirect)!=null||(e.regexRedirect=new RegExp(String.raw`^(\s*)((?:${e.redirection.join("|")})\s*(?::\s*)?)\[\[([^\n|\]]+)(\|.*?)?\]\](\s*)`,"iu"));let i=e.regexRedirect.exec(t);return i&&T.normalizeTitle(i[3],0,!1,e,{halfParsed:!0,temporary:!0,decode:!0}).valid?(t=`\0${s.length}o${t.slice(i[0].length)}`,new _e(...i.slice(1),e,s),t):!1}}}),vr,ai,wr,ze,$a=I({"src/onlyinclude.ts"(){"use strict";Gt(),Pt(),z(),vr=[jt,Mt("<onlyinclude>")],ze=class extends(wr=O){get type(){return"onlyinclude"}toString(t){return`<onlyinclude>${super.toString(t)}</onlyinclude>`}isPlain(){return!0}print(){return super.print({pre:'<span class="wpb-ext">&lt;onlyinclude&gt;</span>',post:'<span class="wpb-ext">&lt;/onlyinclude&gt;</span>'})}},ai=tt(wr),ze=Q(ai,0,"OnlyincludeToken",vr,ze),J(ai,1,ze)}}),qe,ps=I({"mixin/gapped.ts"(){"use strict";qe=(t=1)=>e=>{class s extends e{getGaps(){return t}}return s}}}),yr,ci,kr,re,ui=I({"src/tagPair/index.ts"(){"use strict";var t,e;ps(),Pt(),z(),yr=[qe(),jt],re=(e=class extends(kr=O){constructor(s,n,i,l,r,c=[]){super(void 0,r),N(this,t),qt(this,"closed"),qt(this,"selfClosing"),this.setAttribute("name",s.toLowerCase()),F(this,t,[s,l||s]),this.closed=l!=="",this.selfClosing=l===void 0,this.append(n,i);let a=typeof n=="string"?-1:c.indexOf(n);c.splice(a===-1?1/0:a,0,this)}get innerText(){return this.selfClosing?void 0:this.lastChild.text()}toString(s){let{selfClosing:n,firstChild:i,lastChild:l}=this,[r,c]=m(this,t);return n?`<${r}${i.toString(s)}/>`:`<${r}${i.toString(s)}>${l.toString(s)}${this.closed?`</${c}>`:""}`}text(){let[s,n]=m(this,t);return this.selfClosing?`<${s}${this.firstChild.text()}/>`:`<${s}${super.text(">")}${this.closed?`</${n}>`:""}`}getAttribute(s){return s==="padding"?m(this,t)[0].length+1:super.getAttribute(s)}print(){let[s,n]=m(this,t);return super.print(this.selfClosing?{pre:`&lt;${s}`,post:"/&gt;"}:{pre:`&lt;${s}`,sep:"&gt;",post:this.closed?`&lt;/${n}&gt;`:""})}},t=new WeakMap,e),ci=tt(kr),re=Q(ci,0,"TagPairToken",yr,re),J(ci,1,re)}}),Sr,Aa=I({"src/tagPair/translate.ts"(){"use strict";var t,e,s;z(),ui(),ve(),Xt(),Sr=(s=class extends re{constructor(n,i,l,r=[]){let c=new ie(n,"translate-attr",l,r);i=i==null?void 0:i.replace(/(<tvar\|[^>]+>)([\s\S]*?)(<\/>)/gu,(o,h,u,d)=>(new mt(h,l,r),new mt(d,l,r),`\0${r.length-1}n${u}\0${r.length}n`)).replace(/(<tvar\s+name\s*=(?:\s*(?:(["'])[\s\S]*?\2|[^"'\s>]+))?\s*>)([\s\S]*?)(<\/tvar\s*>)/giu,(o,h,u,d,g)=>(new mt(h,l,r),new mt(g,l,r),`\0${r.length-1}n${d}\0${r.length}n`));let a=new O(i,l,r);a.type="translate-inner",super("translate",c,a,"translate",l,r),N(this,t),this.seal("closed",!0),this.seal("selfClosing",!0)}get type(){return"translate"}toString(n){return n?this.lastChild.toString(!0):super.toString()}text(){return this.lastChild.text()}print(){return`<span class="wpb-ext">&lt;translate${M(this,t,e).call(this)?'<span class="wpb-ext-attrs"> <span class="wpb-ext-attr"><span class="wpb-attr-key">nowrap</span></span></span>':""}&gt;${this.lastChild.print({class:"ext-inner"})}&lt;/translate&gt;</span>`}},t=new WeakSet,e=function(){return this.firstChild.toString()===" nowrap"},s)}}),$r,hi,Ar,Be,Ia=I({"src/tagPair/include.ts"(){"use strict";D(),ut(),be(),q(),ui(),$r=[se(!1)],Be=class extends(Ar=re){get type(){return"include"}constructor(t,e="",s,n,i,l){super(t,e,s!=null?s:"",s===void 0||n!=null?n:"",i,l)}toString(t){return t?"":super.toString()}lint(t=this.getAbsoluteIndex()){{let e=[],{firstChild:s,closed:n,name:i}=this,l=new at(this,t),r=["no-ignored","unclosed-comment"],{lintConfig:c}=T,{computeEditInfo:a}=c,o=r.map(h=>c.getSeverity(h,"include"));if(o[0]&&s.data.trim()){let h=_(s,l,r[0],"useless-attribute",o[0]);a&&(h.suggestions=[V(h)]),e.push(h)}if(o[1]&&!n){let h=Z(this,l,r[1],T.msg("unclosed",`<${i}>`),o[1]);a&&(h.suggestions=[Ht(h.endIndex,`</${i}>`)]),e.push(h)}return e}}},hi=tt(Ar),Be=Q(hi,0,"IncludeToken",$r,Be),J(hi,1,Be)}}),fs,di=I({"mixin/attributesParent.ts"(){"use strict";fs=(t=0)=>e=>{var s,n;class i extends e{constructor(){super(...arguments),N(this,s)}hasAttr(r){this.lspError("AttributesParent.hasAttr")}getAttr(r){return M(this,s,n).call(this).getAttr(r)}}return s=new WeakSet,n=function(){return this.childNodes[t]},i}}}),lt,gi,pi,Ue,ms,fi,le,mi,xi,bi,xs,vi,Et,Ir,Cr,Tr,Nr,Ca=I({"util/sharable.ts"(){"use strict";lt=new Set(["align"]),gi=new Set(["cite"]),pi=new Set(["cite","datetime"]),Ue=new Set(["width"]),ms=new Set(["axis","align","bgcolor","height","width","valign"]),fi=new Set([...ms,"abbr","headers","scope","rowspan","colspan"]),le=new Set(["type"]),mi=new Set(["summary","align","bgcolor","cellpadding","cellspacing","frame","rules","width"]),xi=new Set(["clear"]),bi=new Set(["bgcolor","align","valign"]),xs=new Set(["qid","forcemathmode","type","display"]),vi=new Set(["enclose","inline","lang","line","linelinks","style","class","id","dir","copy","highlight","start"]),Et=new Set,Ir=new Set(["id","class","style","lang","dir","title","tabindex","aria-describedby","aria-flowto","aria-hidden","aria-label","aria-labelledby","aria-level","aria-owns","role","about","property","resource","datatype","typeof","itemid","itemprop","itemref","itemscope","itemtype"]),Cr={div:lt,h1:lt,h2:lt,h3:lt,h4:lt,h5:lt,h6:lt,blockquote:gi,q:gi,p:lt,br:xi,pre:Ue,ins:pi,del:pi,ul:le,ol:new Set(["type","start","reversed"]),li:new Set(["type","value"]),table:new Set([...mi,"border"]),caption:lt,tr:bi,td:fi,th:fi,font:new Set(["size","color","face"]),hr:Ue,data:new Set(["value"]),time:new Set(["datetime"]),meta:new Set(["itemprop","content"]),link:new Set(["itemprop","href","title"]),gallery:le,poem:lt,categorytree:lt,combooption:lt,math:Et,chem:Et,ce:Et,img:new Set(["alt","src","width","height","loading","srcset"])},Tr={gallery:new Set(["mode","showfilename","caption","perrow","widths","heights","showthumbnails"]),poem:new Set(["compact"]),categorytree:new Set(["hideroot","onlyroot","depth","mode","hideprefix","namespaces","showcount","notranslations"]),combooption:new Set(["name","for","inline"]),nowiki:Et,indicator:new Set(["name"]),langconvert:new Set(["from","to"]),ref:new Set(["group","name","follow","dir","details"]),references:new Set(["group","responsive"]),charinsert:new Set(["label"]),choose:new Set(["uncached","before","after"]),option:new Set(["weight"]),imagemap:Et,inputbox:Et,templatestyles:new Set(["src","wrapper"]),dynamicpagelist:Et,poll:new Set(["id","show-results-before-voting"]),sm2:le,flashmp3:le,score:new Set(["line_width_inches","lang","override_midi","raw","note-language","override_audio","override_ogg","sound","vorbis"]),seo:new Set(["title","title_mode","title_separator","keywords","description","robots","google_bot","image","image_width","image_height","image_alt","type","site_name","locale","section","author","published_time","twitter_site"]),tab:new Set(["nested","name","index","class","block","inline","openname","closename","collapsed","dropdown","style","bgcolor","container","id","title"]),tabs:new Set(["plain","class","container","id","title","style"]),combobox:new Set(["placeholder","value","id","class","text","dropdown","style"]),math:new Set([...xs,"chem"]),chem:xs,ce:xs,hiero:Et,phonos:new Set(["ipa","class","text","lang","wikibase","file"]),section:new Set(["begin","end"]),source:vi,syntaxhighlight:vi,templatedata:Et,timeline:new Set(["method","font"]),quiz:new Set(["display","shuffleanswers","points","shuffle","case"]),languages:Et},Nr={table:mi,td:new Set([...ms,"scope"]),th:ms,br:xi,caption:lt,div:lt,hr:Ue,h1:lt,h2:lt,h3:lt,h4:lt,h5:lt,h6:lt,li:le,p:lt,pre:Ue,tr:bi,ul:le}}}),Fr,Er,Wr,jr,bs,Ta=I({"src/attribute.ts"(){"use strict";var t,e,s,n,i,l,r;D(),ft(),Dt(),Ca(),ut(),q(),z(),Vt(),Fr=/expression|(?:accelerator|-o-link(?:-source)?|-o-replace)\s*:|(?:url|src|image(?:-set)?)\s*\(|attr\s*\([^)]+[\s,]url/u,Er=/(?:^|\s|\*\/)(?:javascript|vbscript)(?:\W|$)/iu,Wr=new Set(["ext","arg","magic-word","template"]),jr=new Set(["about","property","resource","datatype","typeof","itemid","itemprop","itemref","itemscope","itemtype"]),bs=(r=class extends O{constructor(c,a,o,h="",u,d=[],g=T.getConfig(),p=[]){let k=new bt(o,"attr-key",g,p),S;if(o==="title"||a==="img"&&o==="alt")S=new O(u,g,p,{}),S.type="attr-value",S.setAttribute("stage",St-1);else if(a==="gallery"&&o==="caption"||a==="choose"&&(o==="before"||o==="after")){let $=zt(wt({},g),{excludes:[...g.excludes,"heading","html","table","hr","list"]});S=new O(u,$,p,{}),S.type="attr-value",S.setAttribute("stage",1)}else S=new bt(u,"attr-value",g,p,{});super(void 0,g,p),N(this,i),N(this,t),N(this,e),N(this,s),N(this,n),F(this,t,c),this.append(k,S),F(this,s,h),F(this,n,[...d]),F(this,e,a),this.setAttribute("name",ge(yt(o)))}get type(){return m(this,t)}get tag(){return m(this,e)}get balanced(){return!m(this,s)||m(this,n)[0]===m(this,n)[1]}afterBuild(){m(this,s).includes("\0")&&F(this,s,this.buildFromStr(m(this,s),0)),this.parentNode&&F(this,e,this.parentNode.name),this.setAttribute("name",ge(this.firstChild.text())),super.afterBuild()}toString(c){let[a="",o=""]=m(this,n);return m(this,s)?super.toString(c,m(this,s)+a)+o:this.firstChild.toString(c)}text(){return m(this,s)?`${super.text(`${m(this,s).trim()}"`)}"`:this.firstChild.text()}getGaps(){var c,a;return m(this,s)?m(this,s).length+((a=(c=m(this,n)[0])==null?void 0:c.length)!=null?a:0):0}lint(c=this.getAbsoluteIndex(),a){var o;{let h=super.lint(c,a),{balanced:u,firstChild:d,lastChild:g,name:p,tag:k}=this,S=new at(this,c),$=["unclosed-quote","obsolete-attr"],{lintConfig:x}=T,b=$.map(f=>x.getSeverity(f,p));if(b[0]&&!u){let f=_(g,S,$[0],"unclosed-quotes",b[0]);f.startIndex--,f.startCol--,x.computeEditInfo&&(f.suggestions=[Ht(f.endIndex,m(this,n)[0])]),h.push(f)}let y=M(this,i,l).call(this,c,S);return y&&h.push(y),b[1]&&(o=Nr[k])!=null&&o.has(p)&&h.push(_(d,S,$[1],"obsolete-attribute",b[1])),h}}getValue(){return m(this,s)?this.lastChild.text().trim():this.type==="ext-attr"||""}escape(){}getAttribute(c){return c==="invalid"?M(this,i,l).call(this):super.getAttribute(c)}print(){let[c="",a=""]=m(this,n);return m(this,s)?super.print({sep:Ne(m(this,s))+c,post:a}):super.print()}json(c,a=this.getAbsoluteIndex()){let o=super.json(void 0,a)}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakSet,l=function(c,a){let{firstChild:o,lastChild:h,type:u,name:d,tag:g,parentNode:p}=this,k=!h.childNodes.some(({type:v})=>Wr.has(v)),S=this.getValue(),$=Tr[g],x=Cr[g],{length:b}=this.toString(),y="illegal-attr",f,w;if({lintConfig:f}=T,{computeEditInfo:w}=f,!($!=null&&$.has(d))&&!(x!=null&&x.has(d))&&(u==="ext-attr"?$||x:!/\{\{[^{]+\}\}/u.test(d))&&(u==="ext-attr"&&!x||!/^(?:xmlns:[\w:.-]+|data-(?!ooui|mw|parsoid)[^:]*)$/u.test(d)&&(g==="meta"||g==="link"||!Ir.has(d)))||(d==="itemtype"||d==="itemid"||d==="itemref")&&!(p!=null&&p.hasAttr("itemscope"))){if(c===void 0)return!0;{let v=f.getSeverity(y,"unknown");if(v){let A=_(o,a,y,"illegal-attribute-name",v);return w&&(A.suggestions=[V(c,b)]),A}}}else if(d==="style"&&typeof S=="string"&&Fr.test(S)){if(c===void 0)return!0;{y="insecure-style";let v=f.getSeverity(y);return v&&_(h,a,y,"insecure-style",v)}}else if(d==="tabindex"&&typeof S=="string"&&S!=="0"){if(c===void 0)return!0;{let v=f.getSeverity(y,"tabindex");if(v){let A=_(h,a,y,"nonzero-tabindex",v);return w&&(A.suggestions=[V(c,b),Nt(A,"0 tabindex","0")]),A}}}else if(typeof S=="string"&&((/^xmlns:[\w:.-]+$/u.test(d)||jr.has(d))&&Er.test(S)||k&&(d==="href"||g==="img"&&d==="src")&&!new RegExp(String.raw`^(?:${this.getAttribute("config").protocol}|//)\S+$`,"iu").test(S))){if(c===void 0)return!0;{let v=f.getSeverity(y,"value");return v&&_(h,a,y,"illegal-attribute-value",v)}}else if(k&&u!=="ext-attr"){let v=Gn(g,d),A=String(S).toLowerCase();if(v.length>0&&v.every(C=>C!==A)){if(c===void 0)return!0;{let C=f.getSeverity(y,"value");return C&&_(h,a,y,"illegal-attribute-value",C)}}}return!1},r)}}),wi,Lr,Or,vs,yi=I({"src/attributes.ts"(){"use strict";var t,e,s,n;D(),ft(),ut(),q(),z(),Vt(),Ta(),wi=i=>i.slice(0,-1),Lr=i=>`${wi(i)}-dirty`,Or=(()=>{try{return new RegExp(String.raw`[\p{L}\p{N}]`,"u")}catch(i){return/[^\W_]/u}})(),vs=(n=class extends O{constructor(i,l,r,c,a=[]){if(super(void 0,c,a,{}),N(this,e),N(this,t),F(this,t,l),this.setAttribute("name",r),i){let o=/([^\s/](?:(?!\0\d+~\x7F)[^\s/=])*)(?:((?:\s(?:\s|\0\d+[cn]\x7F)*)?(?:=|\0\d+~\x7F)(?:\s|\0\d+[cn]\x7F)*)(?:(["'])([\s\S]*?)(\3|$)|(\S*)))?/gu,h="",u=o.exec(i),d=0,g=()=>{h&&(super.insertAt(new bt(h,Lr(l),c,a,{})),h="")};for(;u;){let{index:p,0:k,1:S,2:$,3:x,4:b,5:y,6:f}=u;if(h+=i.slice(d,p),/^(?:[\w:]|\0\d+t\x7F)(?:[\w:.-]|\0\d+t\x7F)*$/u.test(yt(S).trim())){let w=b!=null?b:f,v=[x,y],A=new bs(wi(l),r,S,$,w,v,c,a);g(),super.insertAt(A)}else h+=k;({lastIndex:d}=o),u=o.exec(i)}h+=i.slice(d),g()}}get type(){return m(this,t)}afterBuild(){let{parentNode:i}=this;i!=null&&i.is("td")&&this.setAttribute("name",i.subtype),super.afterBuild()}getAttrTokens(i){return this.childNodes.filter(l=>l instanceof bs&&(!i||l.name===ge(i)))}hasAttr(i){return this.getAttrTokens(i).length>0}getAttrToken(i){let l=this.getAttrTokens(i);return l[l.length-1]}getAttr(i){var l;return(l=this.getAttrToken(i))==null?void 0:l.getValue()}lint(i=this.getAbsoluteIndex(),l){{let r=super.lint(i,l),{parentNode:c,childNodes:a}=this,o=new Map,h=new Set,u=new at(this,i),d=["no-ignored","no-duplicate"],{lintConfig:g}=T,{computeEditInfo:p,fix:k}=g,S=["closingTag","invalidAttributes","nonWordAttributes"].map(x=>g.getSeverity(d[0],x));if(S[0]&&M(this,e,s).call(this)){let x=Z(this,u,d[0],"attributes-of-closing-tag",S[0]);if(p){let b=c.getAbsoluteIndex();x.suggestions=[V(x),Vs(b)]}r.push(x)}for(let x of a)if(x instanceof bs){let{name:b}=x;o.has(b)?(h.add(b),o.get(b).push(x)):o.set(b,[x])}else{let b=x.text().trim(),y=S[Or.test(b)?1:2];if(b&&y){let f=_(x,u,d[0],"invalid-attribute",y);p&&(f.suggestions=[V(f,0," ")]),r.push(f)}}let $=g.getSeverity(d[1],"attribute");if($&&h.size>0)for(let x of h){let b=o.get(x).map(y=>{let f=y.getValue();return[y,f===!0?"":f]});r.push(...b.map(([y,f],w)=>{let v=_(y,u,d[1],T.msg("duplicate-attribute",x),$);if(p||k){let A=V(v);!f||b.slice(0,w).some(([,C])=>C===f)?v.fix=A:p&&(v.suggestions=[A])}return v}))}return r}}getAttribute(i){return i==="invalid"?M(this,e,s).call(this):super.getAttribute(i)}print(){return this.toString()?`<span class="wpb-${this.type}${M(this,e,s).call(this)?" wpb-invalid":""}">${this.childNodes.map(i=>i.print(i instanceof bt?{class:i.toString().trim()&&"attr-dirty"}:void 0)).join("")}</span>`:""}},t=new WeakMap,e=new WeakSet,s=function(){let{parentNode:i}=this;return(i==null?void 0:i.type)==="html"&&i.closing&&this.text().trim()!==""},n)}}),Pr={};it(Pr,{PreToken:()=>Mr});var Mr,Na=I({"src/pre.ts"(){"use strict";Dt(),z(),Xt(),Mr=class extends O{get type(){return"ext-inner"}constructor(t,e,s=[]){if(t){let n=/<nowiki>/giu,i=/<\/nowiki>/giu,{length:l}=n.source,r=n.exec(t);r&&(i.lastIndex=r.index+l);let c=i.exec(t),a=0,o="";for(;r&&c;)new mt(r[0],e,s),new mt(c[0],e,s),o+=`${t.slice(a,r.index)}\0${s.length-1}n${t.slice(r.index+l,c.index)}\0${s.length}n`,a=c.index+l+1,n.lastIndex=a,r=n.exec(t),r&&(i.lastIndex=r.index+l),c=i.exec(t);t=o+t.slice(a)}super(t,e,s,{}),this.setAttribute("stage",St-1)}isPlain(){return!0}lint(t=this.getAbsoluteIndex()){return super.lint(t,/<\s*\/\s*(pre)\b/giu)}}}}),ws,ki=I({"mixin/multiLine.ts"(){"use strict";ws=t=>{class e extends t{toString(n){return super.toString(n,`
`)}text(){return super.text(`
`).replace(/\n\s*\n/gu,`
`)}getGaps(){return 1}print(){return super.print({sep:`
`})}}return e}}}),Rr={};it(Rr,{ParamTagToken:()=>we});var _r,Si,zr,we,qr=I({"src/paramTag/index.ts"(){"use strict";D(),ut(),As(),ki(),q(),z(),Vt(),_r=[ws],we=class extends(zr=O){get type(){return"ext-inner"}constructor(t,e,s=T.getConfig(),n=[],i){if(super(void 0,s,n,{}),e){let l=bt;this.append(...e.split(`
`).map(r=>i?r:Xe(r,s,n,t)).map(r=>new l(r,"param-line",s,n,{})))}n.splice(n.indexOf(this),1),n.push(this)}lint(t=this.getAbsoluteIndex()){{let e="no-ignored",{lintConfig:s}=T,n=s.getSeverity(e,this.name);if(!n)return[];let i=new at(this,t),l=T.msg("invalid-parameter",this.name),r=[];for(let c of this.childNodes){c.setAttribute("aIndex",t);let a=c.childNodes.filter(({type:o})=>o!=="comment"&&o!=="include"&&o!=="noinclude");if(a.some(({type:o})=>o==="ext"))r.push(_(c,i,e,l,n));else{let o=a.findIndex(({type:u})=>u!=="text"),h=a.slice(0,o===-1?void 0:o).map(String).join("");if(h&&!(o===-1?/^[a-z]+(?:\[\])?\s*=/iu:/^[a-z]+(?:\[\])?\s*(?:=|$)/iu).test(h)){let u=_(c,i,e,l,n);s.computeEditInfo&&(u.suggestions=[V(u)]),r.push(u)}else{let u=c.lint(t,!1);u.length>0&&r.push(...u)}}t+=c.toString().length+1}return r}}},Si=tt(zr),we=Q(Si,0,"ParamTagToken",_r,we),J(Si,1,we)}}),Br,$i,Ur,ye,Dr=I({"src/heading.ts"(){"use strict";var t,e,s,n;D(),Lt(),ut(),Pt(),q(),z(),ve(),Br=[jt],ye=(n=class extends(Ur=O){constructor(i,l,r,c=[]){super(void 0,r,c),N(this,e),N(this,t),F(this,t,i);let a=new O(l[0],r,c);a.type="heading-title",a.setAttribute("stage",2);let o=new ie(l[1],"heading-trail",r,c);this.append(a,o)}get type(){return"heading"}get level(){return m(this,t)}toString(i){let l=M(this,e,s).call(this);return l+this.firstChild.toString(i)+l+this.lastChild.toString(i)}text(){let i=M(this,e,s).call(this);return i+this.firstChild.text()+i}getAttribute(i){return i==="invalid"?this.inHtmlAttrs()===2:i==="padding"?this.level:super.getAttribute(i)}getGaps(){return this.level}lint(i=this.getAbsoluteIndex(),l){{let r=super.lint(i,l),{firstChild:c,level:a}=this,o=c.toString(),h=o.startsWith("="),u=h||o.endsWith("="),d=new at(this,i),g=this.inHtmlAttrs(),p=["h1","unbalanced-header","format-leakage"],{lintConfig:k}=T,{computeEditInfo:S,fix:$}=k,x=p.map(b=>k.getSeverity(b,"apostrophe"));if(x[0]&&this.level===1){let b=_(c,d,p[0],"<h1>",x[0]);S&&!u&&(b.suggestions=[Nt(b,"h2",`=${o}=`)]),r.push(b)}if(x[1]&&u){let b=T.msg("unbalanced-in-section-header",'"="'),y=_(c,d,p[1],b,x[1]);if(!(!S||o==="="))if(h){let[f]=/^=+/u.exec(o),w=a+f.length;y.suggestions=[{desc:`h${a}`,range:[y.startIndex,y.startIndex+f.length],text:""}],w<7&&y.suggestions.push({desc:`h${w}`,range:[y.endIndex,y.endIndex],text:f})}else{let f=/[^=](=+)$/u.exec(o)[1],w=a+f.length;y.suggestions=[{desc:`h${a}`,range:[y.endIndex-f.length,y.endIndex],text:""}],w<7&&y.suggestions.push({desc:`h${w}`,range:[y.startIndex,y.startIndex],text:f})}r.push(y)}if(g){let b="parsing-order",y=k.getSeverity(b,g===2?"heading":"templateInTable");y&&r.push(Z(this,d,b,"header-in-html",y))}if(x[2]){let b=this.getRootNode().toString(),y=c.childNodes.filter(js("quote")),f=y.filter(({bold:v})=>v),w=y.filter(({italic:v})=>v);if(f.length%2){let v=_(f[f.length-1],zt(wt({},d),{start:i+a,left:d.left+a}),p[2],T.msg("unbalanced-in-section-header","bold-apostrophes"),x[2]);if(S||$){let A=i+a+o.length,C=V(v);b.slice(v.endIndex,A).trim()?S&&(v.suggestions=[C,Ht(A,"'''")]):f.length===1&&w.length===0?v.fix=C:S&&(v.suggestions=[C])}r.push(v)}if(w.length%2){let v=_(w[w.length-1],{start:i+a},p[2],T.msg("unbalanced-in-section-header","italic-apostrophes"),x[2]);if(S||$){let A=i+a+o.length;b.slice(v.endIndex,A).trim()?S&&(v.suggestions=[Ht(A,"''")]):w.length===1&&f.length===0?v.fix=V(v):S&&(v.suggestions=[V(v)])}r.push(v)}}return r}}print(){let i=M(this,e,s).call(this);return super.print({pre:i,sep:i})}json(i,l=this.getAbsoluteIndex()){let r=super.json(void 0,l)}},t=new WeakMap,e=new WeakSet,s=function(){return"=".repeat(this.level)},n),$i=tt(Ur),ye=Q($i,0,"HeadingToken",Br,ye),J($i,1,ye)}}),Hr,Gr,Fa=I({"src/parameter.ts"(){"use strict";ft(),D(),q(),z(),Hr=new RegExp(`https?://${he}${de}$`,"iu"),Gr=class extends O{get type(){return"parameter"}get anon(){return this.firstChild.length===0}get duplicated(){}constructor(t,e,s,n=[]){super(void 0,s,n);let i=new O(typeof t=="number"?void 0:t,s,n,{}),l=new O(e,s,n);i.type="parameter-key",i.setAttribute("stage",2),l.type="parameter-value",l.setAttribute("stage",2),this.append(i,l)}trimName(t,e=!0){let s=(typeof t=="string"?t:t.toString(!0)).replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1");return this.setAttribute("name",s),s}afterBuild(){if(!this.anon){let{parentNode:t,firstChild:e}=this,s=this.trimName(e);t&&t.getArgs(s,!1,!1).add(this)}super.afterBuild()}toString(t){return this.anon?this.lastChild.toString(t):super.toString(t,"=")}text(){return this.anon?this.lastChild.text():super.text("=")}getGaps(){return this.anon?0:1}lint(t=this.getAbsoluteIndex(),e){var s;{let n=super.lint(t,e),i="unescaped",{lintConfig:l}=T,r=l.getSeverity(i);if(r){let{firstChild:c}=this,a=(s=Hr.exec(c.text()))==null?void 0:s[0];try{if(a&&new URL(a).search){let o=_(c,{start:t},i,"unescaped-query",r);o.startIndex=o.endIndex,o.startLine=o.endLine,o.startCol=o.endCol,o.endIndex++,o.endCol++,(l.computeEditInfo||l.fix)&&(o.fix=xe(o.startIndex,"{{=}}")),n.push(o)}}catch(o){}}return n}}print(){return super.print({sep:this.anon?"":"="})}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e)}}}}),Vr,Ai,Zr,ke,Ea=I({"src/transclude.ts"(){"use strict";var t,e,s,n,i,l,r,c,a;ft(),D(),Lt(),ut(),ps(),Pt(),q(),z(),Fa(),Vt(),ve(),Vr=[jt,qe()],ke=(a=class extends(Zr=O){constructor(o,h,u,d=[]){var g,p;let k,S=/^(?:\s|\0\d+[cn]\x7F)*\0(\d+)h\x7F(?:\s|\0\d+[cn]\x7F)*/u.exec(o);S&&(k=Number(S[1]),o=o.replace(`\0${k}h`,d[k].toString().replace(/^\n/u,""))),super(void 0,u,d,{}),N(this,l),qt(this,"modifier",""),N(this,t,"template"),N(this,e,":"),N(this,s,!1),N(this,n,new Map),N(this,i);let{parserFunction:[$,x],variable:b,functionHook:y}=u,f=(g=/^(?:\s|\0\d+[cn]\x7F)*\0\d+s\x7F/u.exec(o))==null?void 0:g[0];if(f)this.setAttribute("modifier",f),o=o.slice(f.length);else if(o.includes(":")){let[W,...R]=o.split(":"),[H]=/^(?:\s|\0\d+[cn]\x7F)*/u.exec((p=R[0])!=null?p:"");this.setModifier(`${W}:${H}`)&&(o=R.join(":").slice(H.length))}let w=o.search(/[:：]/u),v=o[w]==="：",A=w!==-1;if(A||h.length===0&&!m(this,s)){let W=A?o.slice(0,w):o,R=A&&o.slice(w+1),H=yt(W),B=A?H.slice(H.search(/\S/u))+(v?"：":""):H.trim(),Y=B.toLowerCase(),kt=Array.isArray(x),st=kt?x.includes(B):Object.prototype.hasOwnProperty.call(x,B),G=!kt&&st?x[B]:Object.prototype.hasOwnProperty.call($,Y)&&$[Y],j=kt&&st||!("functionHook"in u)||y.includes(G),et=kt&&st||b.includes(G);if(A?G&&j:et){this.setAttribute("name",G||Y.replace(/^#|：$/u,"")),F(this,t,"magic-word"),v&&F(this,e,"：");let K=new ie(W,"magic-word-name",u,d);if(super.insertAt(K),R!==!1&&h.unshift([R]),this.name==="invoke")for(let nt=0;nt<2;nt++){let ct=h.shift();if(!ct)break;let ht=new bt(ct.join("="),`invoke-${nt?"function":"module"}`,u,d);super.insertAt(ht)}}}if(this.type==="template"){let W=yt(o).trim();if(!this.normalizeTitle(W,10,{halfParsed:!0,temporary:!0}).valid)throw d.pop(),new SyntaxError("Invalid template name");let R=new bt(o,"template-name",u,d,{});super.insertAt(R)}typeof k=="number"&&(d[k]=void 0);let C=this.isTemplate(),E=1;for(let W=0;W<h.length;W++){let R=h[W];C||this.name==="switch"&&W>0||this.name==="tag"&&W>1||(R[0]=R.join("="),R.length=1),R.length===1&&(R.unshift(E),E++),this.insertAt(new Gr(...R,u,d))}this.seal("modifier")}get type(){return m(this,t)}get module(){}get function(){}setModifier(o){let{parserFunction:[,,h,u]}=this.getAttribute("config"),d=yt(o).trim();if(o&&!d.endsWith(":"))return!1;let g=d.slice(0,-1).toLowerCase(),p=h.includes(g),k=u.includes(g);return m(this,s)&&p||!m(this,s)&&(k||!o)||(It.running||this.length>1)&&(p||k||!o)?(this.setAttribute("modifier",o),F(this,s,p),!!o):!1}isTemplate(){return this.type==="template"||this.name==="invoke"}afterBuild(){this.modifier.includes("\0")&&this.setAttribute("modifier",this.buildFromStr(this.modifier,0)),super.afterBuild(),this.isTemplate()&&this.type==="template"&&(F(this,i,M(this,l,r).call(this)),this.setAttribute("name",m(this,i).title))}toString(o){let{childNodes:h,length:u,firstChild:d,modifier:g,type:p}=this;return`{{${g}${p==="magic-word"?d.toString(o)+(u===1?"":m(this,e))+h.slice(1).map(k=>k.toString(o)).join("|"):super.toString(o,"|")}}}`}text(){let{childNodes:o,length:h,firstChild:u,modifier:d,type:g,name:p}=this;return g==="magic-word"&&p==="vardefine"?"":`{{${d}${g==="magic-word"?u.text()+(h===1?"":m(this,e))+Yt(o.slice(1),"|"):super.text("|")}}}`}getAttribute(o){switch(o){case"padding":return this.modifier.length+2;case"title":return m(this,i);case"colon":return m(this,e);case"invalid":return this.type==="magic-word"&&this.name==="invoke"&&(this.length===2||!M(this,l,r).call(this).valid);default:return super.getAttribute(o)}}lint(o=this.getAbsoluteIndex(),h){{let u=super.lint(o,h);if(!this.isTemplate())return u;let{type:d,childNodes:g,length:p}=this,k=new at(this,o),{lintConfig:S}=T,{computeEditInfo:$}=S,x=d==="magic-word",b="no-ignored",y=S.getSeverity(b,"fragment");if(x&&!M(this,l,r).call(this).valid)b="invalid-invoke",y=S.getSeverity(b,"name"),y&&u.push(_(g[1],k,b,"illegal-module",y));else if(y){let f=g[x?1:0],w=f.childNodes.findIndex(A=>A.type==="text"&&os(A.data).includes("#")),v=f.childNodes[w];if(v){let A=_(f,k,b,"useless-fragment",y);$&&(A.suggestions=[V(A,f.getRelativeIndex(w)+v.data.indexOf("#"))]),u.push(A)}}if(b="invalid-invoke",y=S.getSeverity(b,"function"),y&&x&&p===2)return u.push(Z(this,k,b,"missing-function",y)),u;if(b="no-duplicate",y=S.getSeverity(b,"parameter"),y){let f=this.getDuplicatedArgs().filter(([,v])=>!v[0].querySelector("ext")),w="duplicate-parameter";for(let[,v]of f)u.push(...v.map(A=>{let C=_(A,k,b,w,y);return $&&(C.suggestions=[V(C,-1)]),C}))}return u}}insertAt(o,h=this.length){return super.insertAt(o,h),o.anon?M(this,l,c).call(this,o):o.name&&this.getArgs(o.name,!1,!1).add(o),o}getAllArgs(){return this.childNodes.filter(js("parameter"))}getAnonArgs(){return this.getAllArgs().filter(({anon:o})=>o)}getArgs(o,h,u=!0){let d=String(o).replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),g;return m(this,n).has(d)?g=m(this,n).get(d):(g=new Set(this.getAllArgs().filter(({name:p})=>d===p)),m(this,n).set(d,g)),g}getDuplicatedArgs(){return[...m(this,n)].filter(([,{size:o}])=>o>1).map(([o,h])=>[o,[...h]])}getPossibleValues(){let{type:o,name:h,childNodes:u}=this;if(o==="template")throw new Error("TranscludeToken.getPossibleValues method is only for specific magic words!");let d,g;switch(h){case"if":case"ifexist":case"ifexpr":case"iferror":d=2;break;case"ifeq":d=3;break;case"switch":{let p=u.slice(2),k=p[p.length-1];g=[...p.filter(({anon:S})=>!S),...k!=null&&k.anon?[k]:[]].map(({lastChild:S})=>S);break}default:throw new Error("TranscludeToken.getPossibleValues method is only for specific magic words!")}g!=null||(g=u.slice(d,d+2).map(({lastChild:p})=>p));for(let p=0;p<g.length;){let{length:k,0:S}=g[p].childNodes.filter($=>$.text().trim());if(k===0)g.splice(p,1);else if(k>1||S.type!=="magic-word")p++;else try{let $=S.getPossibleValues();g.splice(p,1,...$),p+=$.length}catch($){p++}}return g}print(){let{childNodes:o,length:h,firstChild:u,modifier:d,type:g}=this;return`<span class="wpb-${g}${this.getAttribute("invalid")?" wpb-invalid":""}">{{${g==="magic-word"?Ne(d)+u.print()+(h===1?"":m(this,e))+fe(o.slice(1),{sep:"|"}):(d?`<span class="wpb-magic-word">${Ne(d)}</span>`:"")+fe(o,{sep:"|"})}}}</span>`}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakMap,l=new WeakSet,r=function(){let o=this.type==="template";return this.normalizeTitle(this.childNodes[o?0:1].text(),o?10:828,{temporary:!0})},c=function(o){let h=this.getAnonArgs(),u=typeof o!="number";for(let d=u?h.indexOf(o):o-1;d<h.length;d++){let g=h[d],{name:p}=g,k=String(d+1);(p!==k||g===o)&&(g.setAttribute("name",k),this.getArgs(k,!1,!1).add(g))}},a),Ai=tt(Zr),ke=Q(Ai,0,"TranscludeToken",Vr,ke),J(Ai,1,ke)}}),Xr,Ii,Jr,De,Wa=I({"src/hidden.ts"(){"use strict";be(),z(),Xr=[se()],De=class extends(Jr=O){get type(){return"hidden"}getAttribute(t){return t==="invalid"||super.getAttribute(t)}},Ii=tt(Jr),De=Q(Ii,0,"HiddenToken",Xr,De),J(Ii,1,De)}}),Qr,Ci,Yr,He,ja=I({"src/arg.ts"(){"use strict";var t,e,s;ft(),D(),ut(),Gt(),ps(),Pt(),q(),z(),Vt(),Wa(),Qr=[jt,Mt("{{{"),qe()],He=(s=class extends(Yr=O){constructor(n,i,l=[]){super(void 0,i,l,{}),N(this,t);for(let r=0;r<n.length;r++){let c=n[r];if(r===0){let a=new bt(c,"arg-name",i,l,{});super.insertAt(a)}else if(r>1){let a=new De(c,i,l);super.insertAt(a)}else{let a=new O(c,i,l);a.type="arg-default",a.setAttribute("stage",2),super.insertAt(a)}}}get type(){return"arg"}get default(){}toString(n){return`{{{${super.toString(n,"|")}}}}`}text(){return`{{{${Yt(this.childNodes.slice(0,2),"|")}}}}`}afterBuild(){super.afterBuild()}lint(n=this.getAbsoluteIndex(),i){{let{childNodes:[l,r,...c]}=this;l.setAttribute("aIndex",n+3);let a=l.lint(n+3,i);if(r){let g=n+4+l.toString().length;r.setAttribute("aIndex",g);let p=r.lint(g,i);p.length>0&&a.push(...p)}let o=["no-ignored","no-arg"],{lintConfig:h}=T,{computeEditInfo:u}=h,d=o.map(g=>h.getSeverity(g,"arg"));if(d[0]&&c.length>0){let g=new at(this,n);a.push(...c.map(p=>{let k=_(p,g,o[0],"invisible-triple-braces",d[0]);return k.startIndex--,k.startCol--,u&&(k.suggestions=[V(k),xe(k.startIndex,"{{!}}")]),k}))}if(d[1]&&!this.getAttribute("include")){let g=Z(this,{start:n},o[1],"unexpected-argument",d[1]);u&&r&&(g.suggestions=[Nt(g,"expand",r.text())]),a.push(g)}return a}}print(){return super.print({pre:"{{{",post:"}}}",sep:"|"})}json(n,i=this.getAbsoluteIndex()){let l=super.json(void 0,i)}},t=new WeakSet,e=function(){},s),Ci=tt(Yr),He=Q(Ci,0,"ArgToken",Qr,He),J(Ci,1,He)}}),Kr={};it(Kr,{parseBraces:()=>ks});var tl,Ti,ys,Ni,Fi,Ei,el,Wi,ks,ji=I({"parser/braces.ts"(){"use strict";Kt(),ft(),Dr(),Ea(),ja(),tl={"=":String.raw`\n(?!(?:[^\S\n]|\0\d+[cn]\x7F)*\n)`,"{":String.raw`\}{2,}|\|`,"-":String.raw`\}-`,"[":String.raw`\]\]`},Ti=String.raw`\[(?!\[)`,ys=String.raw`\n(?![=\0])`,Ni=String.raw`|\{{2,}`,Fi=new Map([["!","!"],["!!","+"],["(!","{"],["!)","}"],["!-","-"],["=","~"],["server","m"]]),Ei=me(t=>new RegExp(t,"gmu")),el=new RegExp(String.raw`\{\{((?:[^\n{}[]|${Ti}|${ys})*)\}\}(?!\})`+"|"+String.raw`\[\[(?:[^\n[\]{]|${ys})*\]\]`+"|"+String.raw`-\{(?:[^\n{}[]|${Ti}|${ys})*\}-`,"gu"),Wi=t=>{let e=ge(yt(t));return Fi.has(e)?Fi.get(e):/^(?:filepath|(?:full|canonical)urle?):./u.test(e)?"m":/^#vardefine:./u.test(e)?"n":"t"},ks=(t,e,s)=>{var n,i,l,r,c;let a=String.raw`${e.excludes.includes("heading")?"":String.raw`^((?:\0\d+[cno]\x7F)*)={1,6}|`}\[\[|-\{(?!\{)`,{parserFunction:[,,,o]}=e,h=[],u=[],d=(b,y,f,w)=>{y[y.length-1].push(At(b.slice(f,w),u))},g;do g!==void 0&&(t=g),g=t.replace(el,(b,y,f)=>{if(y!==void 0||typeof f=="string")try{let{length:w}=s,v=(y!=null?y:f).split("|");return new ke(At(v[0],u),v.slice(1).map(A=>{let C=A.indexOf("=");return(C===-1?[A]:[A.slice(0,C),A.slice(C+1)]).map(E=>At(E,u))}),e,s),`\0${w}${Wi(v[0])}`}catch(w){if(!(w instanceof SyntaxError)||w.message!=="Invalid template name")throw w}return u.push(At(b,u)),`\0${u.length-1}`});while(g!==t);t=g;let p=t.lastIndexOf("}}")-t.length,k=p+t.length!==-1,S=Ei(a+(k?Ni:"")),$=S.exec(t),x;for(;$||x!==void 0&&x<=t.length&&(i=(n=h[h.length-1])==null?void 0:n[0])!=null&&i.startsWith("=");){if($!=null&&$[1]){let[,{length:H}]=$;$[0]=$[0].slice(H),$.index+=H}let{0:b,index:y}=$!=null?$:{0:`
`,index:t.length},f=(l=h.pop())!=null?l:{},{0:w,index:v,parts:A,findEqual:C,pos:E}=f,W=b==="="&&C;if(b==="]]"||b==="}-")x=y+2;else if(b===`
`){x=y+1;let{pos:H,findEqual:B}=(r=h[h.length-1])!=null?r:{};if(H===void 0||B||yt(t.slice(H,v))!==""){let Y=/^(={1,6})(.+)\1((?:\s|\0\d+[cn]\x7F)*)$/u.exec(t.slice(v,y));Y&&(Y[2]=At(Y[2],u),Y[2].includes(`
`)||(t=`${t.slice(0,v)}\0${s.length}h${t.slice(y)}`,x=v+4+String(s.length).length,new ye(Y[1].length,Y.slice(2),e,s)))}}else if(b==="|"||W)x=y+1,d(t,A,E,y),b==="|"&&A.push([]),f.pos=x,f.findEqual=b==="|",h.push(f);else if(b.startsWith("}}")){let H=b.slice(0,Math.min(w.length,3)),B=w.length-H.length,{length:Y}=s;x=y+H.length,d(t,A,E,y);let kt=!1,st="t";if(H.length===3){let G=A.map(et=>et.join("=")),j=G.length>1&&yt(G[1]).trim();new He(G,e,s),j&&j.endsWith(":")&&o.includes(j.slice(0,-1).toLowerCase())&&(st="s")}else try{new ke(A[0][0],A.slice(1),e,s),st=Wi(A[0][0])}catch(G){if(G instanceof SyntaxError&&G.message==="Invalid template name")kt=!0;else throw G}kt||(t=`${t.slice(0,v+B)}\0${Y}${st}${t.slice(x)}`,x=v+B+3+String(Y).length,B>1?h.push({0:w.slice(0,B),index:v,pos:v+B,parts:[[]]}):B===1&&t[v-1]==="-"&&h.push({0:"-{",index:v-1,pos:v+1,parts:[[]]}))}else x=y+b.length,b.startsWith("{")&&($.pos=x,$.parts=[[]]),h.push(..."0"in f?[f]:[],$);let R=h[h.length-1];if(k&&p+t.length<x)for(k=!1;(c=R==null?void 0:R[0])!=null&&c.startsWith("{");)h.pop(),R=h[h.length-1];S=Ei(a+(k?Ni:"")+(R?`|${tl[R[0][0]]}${R.findEqual?"|=":""}`:"")),S.lastIndex=x,$=S.exec(t)}return At(t,u)}}}),sl={};it(sl,{InputboxToken:()=>il});var il,La=I({"src/paramTag/inputbox.ts"(){"use strict";As(),ji(),q(),qr(),il=class extends we{constructor(t,e,s=T.getConfig(),n=[]){let i=Symbol("InputboxToken"),l=s.excludes.includes("heading")?s:zt(wt({},s),{excludes:[...s.excludes,"heading"]}),{length:r}=n;n.push(i),e&&(e=Xe(e,l,n,t)),e&&(e=ks(e,l,n)),n.splice(r,1),super(t,e,l,n,{})}}}}),Ss={};it(Ss,{NestedToken:()=>ll});var nl,rl,ll,Li=I({"src/nested.ts"(){"use strict";var t,e,s;D(),ut(),As(),ji(),q(),z(),Ul(),Xt(),nl=new Set(["comment","include","arg","template","magic-word"]),rl=[!1,!0].map(n=>{let i=n?"includeonly":"noinclude";return new RegExp(String.raw`^(?:<${i}(?:\s[^>]*)?/?>|</${i}\s*>)$`,"iu")}),ll=(s=class extends O{constructor(n,i,l,r,c=[]){if(typeof i=="boolean"){let a=Symbol("NestedToken"),{length:o}=c;c.push(a),n&&(n=Xe(n,r,c,i)),n&&(n=ks(n,r,c)),c.splice(o,1)}else n&&(n=n.replace(i,(a,o,h,u,d)=>{let g=`\0${c.length+1}e`;return new Ie(o,h,u,d,r,!1,c),g}));n&&(n=n.replace(/(^|\0\d+.\x7F)([^\0]+)(?=$|\0\d+.\x7F)/gu,(a,o,h)=>(new mt(h,r,c),`${o}\0${c.length}n`))),super(n,r,c),N(this,t),N(this,e),F(this,t,[...l]),F(this,e,i)}get type(){return"ext-inner"}lint(n=this.getAbsoluteIndex(),i){{let l=super.lint(n,i),r="no-ignored",{lintConfig:c}=T,a=c.getSeverity(r,this.name);if(!a)return l;let o=new at(this,n),h=typeof m(this,e)=="boolean"?rl[m(this,e)?1:0]:/^<!--[\s\S]*-->$/u;return[...l,...this.childNodes.filter(u=>{let{type:d,name:g}=u;if(d==="ext")return!m(this,t).includes(g);if(nl.has(d))return!1;let p=u.toString().trim();return p&&!h.test(p)}).map(u=>{let d=_(u,o,r,T.msg("invalid-content",this.name),a);return c.computeEditInfo&&(d.suggestions=[V(d),Zs(d,u.toString())]),d})]}}},t=new WeakMap,e=new WeakMap,s)}});function ol(t,e,s,n,i){e=yt(e).trim();let l=e.replace(t==="link"?/\0\d+[tq]\x7F/gu:/\0\d+t\x7F/gu,"").trim();switch(t){case"width":return!l&&!!e||/^(?:\d+x?|\d*x\d+)(?:\s*px)?$/u.test(l);case"link":{if(l){if(al(s.protocol).test(l))return cl(s.protocol).test(l)&&e;l.startsWith("[[")&&l.endsWith("]]")&&(l=l.slice(2,-2))}else return e;let r=T.normalizeTitle(l,0,!1,s,{halfParsed:n,decode:!0,selfLink:!0});return r.valid&&r}case"lang":return(i==="svg"||i==="svgz")&&!/[^a-z\d-]/u.test(l);case"alt":case"class":case"manualthumb":return!0;case"page":return(i==="djvu"||i==="djv"||i==="pdf")&&Number(l)>0;default:return!!l&&!isNaN(l)}}var al,cl,ul,hl,dl,Oa=I({"src/imageParameter.ts"(){"use strict";var t,e,s,n;Kt(),ft(),D(),Dt(),q(),z(),al=me(i=>new RegExp(String.raw`^(?:${i}|//|\0\d+m\x7F)`,"iu")),cl=me(i=>new RegExp(String.raw`^(?:(?:${i}|//)${he}|\0\d+m\x7F)${de}$`,"iu")),ul=me(i=>new RegExp(String.raw`^(\s*(?!\s))${i.replace("$1","(.*)")}${i.endsWith("$1")?`(?=$|
)`:""}(\s*)$`,"u")),hl=new Set(["alt","link","lang","page","caption"]),dl=(n=class extends O{constructor(i,l,r,c){var a=(...d)=>(super(...d),N(this,e),N(this,t,""),this);let o,h=Object.entries(r.img).map(([d,g])=>[d,g,ul(d)]),u=h.find(([,d,g])=>(o=g.exec(i),o&&(o.length!==4||ol(d,o[2],r,!0,l)!==!1)));if(u&&o){o.length===3?(a(void 0,r,c),F(this,t,i)):(a(o[2],r,c,{}),F(this,t,o[1]+u[0]+o[3])),this.setAttribute("name",u[1]),u[1]==="alt"&&this.setAttribute("stage",St-1);return}a(i,r.excludes.includes("list")?r:zt(wt({},r),{excludes:[...r.excludes,"list"]}),c),this.setAttribute("name","caption"),this.setAttribute("stage",7)}get type(){return"image-parameter"}get link(){return this.name==="link"?ol("link",super.text(),this.getAttribute("config")):void 0}afterBuild(){var i;(i=this.parentNode)!=null&&i.is("gallery-image")&&!hl.has(this.name)&&this.setAttribute("name","invalid"),super.afterBuild()}toString(i){return m(this,t)?m(this,t).replace("$1",super.toString(i)):super.toString(i)}text(){return m(this,t)?m(this,t).replace("$1",super.text()).trim():super.text().trim()}isPlain(){return this.name==="caption"||this.name==="alt"}getAttribute(i){return i==="invalid"?this.name==="invalid":i==="padding"?Math.max(0,m(this,t).indexOf("$1")):super.getAttribute(i)}lint(i=this.getAbsoluteIndex(),l){{let r=super.lint(i,l),{lintConfig:c}=T,{computeEditInfo:a,fix:o}=c,{link:h,name:u}=this;if(u==="invalid"){let d="invalid-gallery",g=c.getSeverity(d,"parameter");if(g){let p=Z(this,{start:i},d,"invalid-image-parameter",g);(a||o)&&(p.fix=V(p,-1)),r.push(p)}}else if(typeof h=="object"&&h.encoded){let d="url-encoding",g=c.getSeverity(d,"file");if(g){let p=Z(this,{start:i},d,"unnecessary-encoding",g);(a||o)&&(p.fix=Gs(p,this)),r.push(p)}}return r}}getValue(){return this.name==="invalid"?this.text():M(this,e,s).call(this)||super.text()}print(){return m(this,t)?`<span class="wpb-image-parameter${this.name==="invalid"?" wpb-invalid":""}">${m(this,t).replace("$1",`<span class="wpb-image-caption">${fe(this.childNodes)}</span>`)}</span>`:super.print({class:"image-caption"})}},t=new WeakMap,e=new WeakSet,s=function(){return m(this,t)&&!m(this,t).includes("$1")},n)}}),Oi,gl,pl,Pi,Mi,Ri,fl,_i,zi,ml=I({"src/link/file.ts"(){"use strict";D(),ut(),q(),gs(),Oa(),Oi=new Map([["manualthumb","Thumb"],["frameless","Frameless"],["framed","Frame"],["thumbnail","Thumb"]]),gl=new Set(["arg"]),pl=new Set(["template","magic-word"]),Pi=new Set(["left","right","center","none"]),Mi=new Set(["baseline","sub","super","top","text-top","middle","bottom","text-bottom"]),Ri=new Set(["tiff","tif","png","gif","jpg","jpeg","webp","xcf","pdf","svg","djvu"]),fl=t=>{if(t===void 0)return[];let e=/-\{|\}-|\|/gu,s=[],n=e.exec(t),i=0,l=0;for(;n;){let{0:r,index:c}=n;r!=="|"?i+=r==="-{"?1:-1:i===0&&(s.push(t.slice(l,c)),{lastIndex:l}=e),n=e.exec(t)}return s.push(t.slice(l)),s},_i=(t,e)=>t.filter(({childNodes:s})=>{let n=s.filter(i=>i.text().trim());return n.length!==1||!e.has(n[0].type)}),zi=class extends Zt{get type(){return"file"}get extension(){}constructor(t,e,s,n=[],i="|"){super(t,void 0,s,n,i);let{extension:l}=this.getTitle(!0,!0);this.safeAppend(fl(e).map(r=>new dl(r,l,s,n)))}lint(t=this.getAbsoluteIndex(),e){var s;{let n=super.lint(t,e),i=_i(this.getAllArgs(),gl),l=[...new Set(i.map(({name:w})=>w))],r=l.filter(w=>Oi.has(w)),c=l.filter(w=>Pi.has(w)),a=l.filter(w=>Mi.has(w)),[o]=r,h=o==="framed"||o==="manualthumb",u=new at(this,t),{lintConfig:d}=T,{computeEditInfo:g,fix:p}=d,{ns:k,extension:S}=this.getAttribute("title"),{firstChild:$}=this,x="nested-link",b=d.getSeverity(x,"file");if(b&&Ri.has(S)&&this.closest("ext-link-text")&&((s=this.getValue("link"))==null?void 0:s.trim())!==""){let w=Z(this,u,x,"link-in-extlink",b);if(g||p){let v=this.getArg("link");if(v){let A=t+v.getRelativeIndex();w.fix={desc:T.msg("delink"),range:[A,A+v.toString().length],text:"link="}}else w.fix=as(w.endIndex-2,"delink","|link=")}n.push(w)}if(x="invalid-gallery",b=d.getSeverity(x,"extension"),b&&k===6&&!S&&!$.querySelector("arg,magic-word,template")&&n.push(Z(this,u,x,"missing-extension",b)),b=d.getSeverity(x,"parameter"),b&&h)for(let w of i.filter(({name:v})=>v==="width")){let v=_(w,u,x,"invalid-image-parameter",b);(g||p)&&(v.fix=V(v,-1)),n.push(v)}if(i.length===l.length&&r.length<2&&c.length<2&&a.length<2)return n;x="no-duplicate";let y=["unknownImageParameter","imageParameter"].map(w=>d.getSeverity(x,w)),f=(w,v,A,C=!0)=>w.map(E=>{if(b=y[Number(typeof C=="function"?C(E):C)],!b)return!1;let W=_(E,u,x,T.msg(`${v}-image-parameter`,A),b);return g&&(W.suggestions=[V(W,-1)]),W}).filter(E=>E!==!1);for(let w of l){if(w==="invalid"||w==="width"&&h)continue;let v=w==="caption",A=i.filter(({name:C})=>C===w);if(v&&(A=[...A.slice(0,-1).filter(C=>C.text()),...A.slice(-1)]),A.length>1){let C=!v||!S||Ri.has(S);if(v&&C){let E=_i(A,pl);C=E.length>1&&(W=>E.includes(W))}n.push(...f(A,"duplicate",w,C))}}return r.length>1&&n.push(...f(i.filter(({name:w})=>Oi.has(w)),"conflicting","frame")),c.length>1&&n.push(...f(i.filter(({name:w})=>Pi.has(w)),"conflicting","horizontal-alignment")),a.length>1&&n.push(...f(i.filter(({name:w})=>Mi.has(w)),"conflicting","vertical-alignment")),n}}getAllArgs(){return this.childNodes.slice(1)}getArgs(t){return this.getAllArgs().filter(({name:e})=>t===e)}getArg(t){let e=this.getArgs(t);return e[t==="manualthumb"?0:e.length-1]}getValue(t){var e;return(e=this.getArg(t))==null?void 0:e.getValue()}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e)}}}}),xl,qi,bl,Se,vl=I({"src/link/galleryImage.ts"(){"use strict";var t,e,s;D(),Dt(),Gt(),q(),z(),ml(),xl=[Mt("")],Se=(s=class extends(bl=zi){constructor(n,i,l,r,c=[]){let a;if(l!==void 0){let{length:o}=c;a=new O(l,r,c);for(let h=0;h<St-1;h++)a.parseOnce();c.splice(o,1)}super(i,a==null?void 0:a.toString(),r,c),N(this,t),qt(this,"privateType","imagemap-image"),this.setAttribute("bracket",!1),this.privateType=`${n}-image`,this.seal("privateType",!0)}get type(){return this.privateType}getTitle(n){let i=this.type==="imagemap-image";return this.normalizeTitle(this.firstChild.toString(),i?0:6,{halfParsed:!0,temporary:n,decode:!i})}lint(n=this.getAbsoluteIndex(),i){{let l=super.lint(n,i),r="invalid-gallery",{lintConfig:c}=T,a=c.getSeverity(r,"image");if(a&&M(this,t,e).call(this)){let o=Z(this,{start:n},r,"invalid-gallery",a);c.computeEditInfo&&(o.suggestions=[as(n,"prefix","File:")]),l.push(o)}return l}}getAttribute(n){return n==="invalid"?M(this,t,e).call(this):super.getAttribute(n)}},t=new WeakSet,e=function(){let{ns:n}=this.getAttribute("title");return n!==6},s),qi=tt(bl),Se=Q(qi,0,"GalleryImageToken",xl,Se),J(qi,1,Se)}}),wl={};it(wl,{GalleryToken:()=>Ge});var yl,Bi,kl,Ge,Pa=I({"src/gallery.ts"(){"use strict";var t,e,s,n;D(),ki(),q(),z(),vl(),Xt(),yl=[ws],Ge=(n=class extends(kl=O){constructor(i,l,r=[]){var c;super(void 0,l,r,{}),N(this,t);for(let a of(c=i==null?void 0:i.split(`
`))!=null?c:[]){let o=/^([^|]+)(?:\|(.*))?/u.exec(a);if(!o){super.insertAt(a.trim()?new mt(a,l,r):a);continue}let[,h,u]=o;M(this,t,e).call(this,h)?super.insertAt(new Se("gallery",h,u,l,r)):super.insertAt(new mt(a,l,r))}}get type(){return"ext-inner"}get widths(){}get heights(){}lint(i=this.getAbsoluteIndex(),l){{let{top:r,left:c}=this.getRootNode().posFromIndex(i),a=[],o="no-ignored",{lintConfig:h}=T,u=["Image","NoImage","Comment"].map(d=>h.getSeverity(o,`gallery${d}`));for(let d=0;d<this.length;d++){let g=this.childNodes[d],p=g.toString(),{length:k}=p,S=p.trim(),{type:$}=g,x=r+d,b=d?0:c;if(g.setAttribute("aIndex",i),$==="noinclude"&&S&&!/^<!--.*-->$/u.test(S)){let[y]=u;if(S.startsWith("|")?[,y]=u:(S.startsWith("<!--")||S.endsWith("-->"))&&([,,y]=u),y){let f=i+k,w={rule:o,message:T.msg("invalid-content","gallery"),severity:y,startIndex:i,endIndex:f,startLine:x,endLine:x,startCol:b,endCol:b+k};h.computeEditInfo&&(w.suggestions=[V(w),Zs(w,p)]),a.push(w)}}else if($!=="noinclude"&&$!=="text"){let y=g.lint(i,l);y.length>0&&a.push(...y)}i+=k+1}return a}}json(i,l=this.getAbsoluteIndex()){let r=super.json(void 0,l)}},t=new WeakSet,e=function(i){return this.normalizeTitle(i,6,{halfParsed:!0,temporary:!0,decode:!0}).valid},s=function(i){},n),Bi=tt(kl),Ge=Q(Bi,0,"GalleryToken",yl,Ge),J(Bi,1,Ge)}}),Ui,Sl=I({"src/link/index.ts"(){"use strict";Kt(),D(),q(),gs(),Ui=class extends Zt{get type(){return"link"}get innerText(){return this.length>1?this.lastChild.text():Fe(this.firstChild.text().replace(/^\s*:?/u,""))}lint(t=this.getAbsoluteIndex(),e){{let s=super.lint(t,e),n="nested-link",{lintConfig:i}=T,l=i.getSeverity(n);if(l&&this.closest("ext-link-text")){let r=Z(this,{start:t},n,"link-in-extlink",l);(i.computeEditInfo||i.fix)&&(r.fix=Nt(r,"delink",this.innerText)),s.push(r)}return s}}}}}),$l,Al,Ve,Di=I({"src/magicLink.ts"(){"use strict";var t,e,s,n;D(),ft(),ut(),q(),z(),$l=String.raw`(?:[${Ut}\t]|&nbsp;|&#0*160;|&#[xX]0*[aA]0;)`,Al=new RegExp(`${$l}+`,"gu"),Ve=(n=class extends O{constructor(i,l="free-ext-link",r=T.getConfig(),c){super(i,r,c,{}),N(this,e),N(this,t),F(this,t,l)}get type(){return m(this,t)}get innerText(){let i=new Map([["!","|"],["=","="]]),l=Yt(this.childNodes.map(r=>{let{type:c}=r,a=String(r.name);return c==="magic-word"&&i.has(a)?i.get(a):r}));return this.type==="magic-link"&&(l=l.replace(Al," ")),l}get link(){let{innerText:i}=this;return this.type==="magic-link"?i.startsWith("ISBN")?`ISBN ${i.slice(5).replace(/[- ]/gu,"").replace(/x$/u,"X")}`:i:_n(i).replace(/\n/gu,"%0A")}lint(i=this.getAbsoluteIndex(),l){{let r=super.lint(i,l),c=new at(this,i),{lintConfig:a}=T,{type:o,childNodes:h}=this;if(o==="magic-link"){let p="invalid-isbn",k=a.getSeverity(p);return k&&M(this,e,s).call(this)&&r.push(Z(this,c,p,"invalid-isbn",k)),r}let u=o==="ext-link-url",d="unterminated-url",g=a.getSeverity(d,u?"pipe":"punctuation");if(g){let p=u?/\|/u:/[，；。：！？（）]+/u,k=h.find(S=>S.type==="text"&&p.test(S.data));if(k){let{data:S}=k,$=_(k,c,d,T.msg("in-url",u?'"|"':"full-width-punctuation"),g);if(a.computeEditInfo){let{index:x,0:b}=p.exec(S),y=$.startIndex+x;$.suggestions=u?[We(y,1)]:[We(y),{desc:T.msg("encode"),range:[y,y+b.length],text:encodeURI(b)}]}r.push($)}}return r}}getUrl(i){this.lspError("MagicLinkToken.getUrl")}getAttribute(i){return i==="invalid"?M(this,e,s).call(this):super.getAttribute(i)}},t=new WeakMap,e=new WeakSet,s=function(){if(this.type==="magic-link"){let{link:i}=this;if(i.startsWith("ISBN")){let l=[...i.slice(5)].map(r=>r==="X"?10:Number(r));return l.length===10?l.reduce((r,c,a)=>r+c*(10-a),0)%11!==0:l.length===13&&(l[12]===10||l.reduce((r,c,a)=>r+c*(a%2?3:1),0)%10!==0)}}return!1},n)}}),Il,Hi,Cl,$e,Tl=I({"src/extLink.ts"(){"use strict";var t,e;Dt(),D(),Gt(),q(),z(),Di(),Il=[Mt("[")],$e=(e=class extends(Cl=O){constructor(s,n="",i="",l,r=[]){super(void 0,l,r,{}),N(this,t);let c=s&&/^\0\d+f\x7F$/u.test(s)?r[Number(s.slice(1,-2))]:new Ve(s,"ext-link-url",l,r);if(this.insertAt(c),F(this,t,n),i){let a=new O(i,l,r,{});a.type="ext-link-text",a.setAttribute("stage",St-1),this.insertAt(a)}}get type(){return"ext-link"}toString(s){return this.length===1?`[${super.toString(s)}${m(this,t)}]`:`[${super.toString(s,m(this,t))}]`}text(){return`[${super.text(" ")}]`}getGaps(){return m(this,t).length}lint(s=this.getAbsoluteIndex(),n){{let i=super.lint(s,n),l="var-anchor",r=T.lintConfig.getSeverity(l,"extLink");return r&&this.length===1&&this.closest("heading-title")&&i.push(Z(this,{start:s},l,"variable-anchor",r)),i}}print(){return super.print(this.length===1?{pre:"[",post:`${m(this,t)}]`}:{pre:"[",sep:m(this,t),post:"]"})}},t=new WeakMap,e),Hi=tt(Cl),$e=Q(Hi,0,"ExtLinkToken",Il,$e),J(Hi,1,$e)}}),Gi,Ma=I({"src/imagemapLink.ts"(){"use strict";z(),Xt(),Sl(),Tl(),Gi=class extends O{get type(){return"imagemap-link"}constructor(t,e,s,n,i=[]){super(void 0,n,i),this.append(t,e.length===2?new Ui(...e,n,i):new $e(...e,n,i),new mt(s,n,i))}}}}),Nl={};it(Nl,{ImagemapToken:()=>Ze});var Fl,Vi,El,Ze,Ra=I({"src/imagemap.ts"(){"use strict";D(),Lt(),ut(),ki(),q(),z(),Xt(),vl(),Ma(),Fl=[ws],Ze=class extends(El=O){get type(){return"ext-inner"}get image(){return this.childNodes.find(js("imagemap-image"))}constructor(t,e=T.getConfig(),s=[]){if(super(void 0,e,s,{}),!t)return;let n=t.split(`
`),i=new Set(e.protocol.split("|")),l=mt,r=!0,c=!1;for(let a of n){let o=a.trim();if(!(c||!o||o.startsWith("#"))){if(r){let h=a.indexOf("|"),u=h===-1?a:a.slice(0,h),{valid:d,ns:g}=this.normalizeTitle(u,0,{halfParsed:!0,temporary:!0});if(d&&g===6){let p=new Se("imagemap",u,h===-1?void 0:a.slice(h+1),e,s);super.insertAt(p),r=!1;continue}else c=!0}else if(a.trim().split(/[\t ]/u,1)[0]==="desc"){super.insertAt(a);continue}else if(a.includes("[")){let h=a.indexOf("["),u=a.slice(h),d=/^\[\[([^|]+)(?:\|([^\]]*))?\]\][\w\s]*$/u.exec(u);if(d){if(this.normalizeTitle(d[1],0,{halfParsed:!0,temporary:!0,selfLink:!0}).valid){super.insertAt(new Gi(a.slice(0,h),d.slice(1),u.slice(u.indexOf("]]")+2),e,s));continue}}else if(u.startsWith("[//")||i.has(u.slice(1,u.indexOf(":")+1))||i.has(u.slice(1,u.indexOf("//")+2))){let g=/^\[([^\]\s]+)(?:(\s+(?!\s))([^\]]*))?\][\w\s]*$/u.exec(u);if(g){super.insertAt(new Gi(a.slice(0,h),g.slice(1),u.slice(u.indexOf("]")+1),e,s));continue}}}}super.insertAt(new l(a,e,s))}}lint(t=this.getAbsoluteIndex(),e){{let s=super.lint(t,e),n=new at(this,t),{childNodes:i,image:l}=this,r="invalid-imagemap",{lintConfig:c}=T,a=c.getSeverity(r,l?"link":"image");return a&&(l?s.push(...i.filter(o=>{let h=o.toString().trim();return o.is("noinclude")&&h&&!h.startsWith("#")}).map(o=>{let h=_(o,n,r,"invalid-imagemap-link",a);return c.computeEditInfo&&(h.suggestions=[V(h,-1),Nt(h,"comment","# ")]),h})):s.push(Z(this,n,r,"imagemap-without-image",a))),s}}getAttribute(t){return t==="invalid"?!this.image:super.getAttribute(t)}},Vi=tt(El),Ze=Q(Vi,0,"ImagemapToken",Fl,Ze),J(Vi,1,Ze)}}),Wl,Zi,jl,Ae,Ll=I({"src/nowiki/comment.ts"(){"use strict";D(),be(),Gt(),q(),ne(),Wl=[se(!1),Mt("<!--")],Ae=class extends(jl=Ft){constructor(t,e,s,n){super(t,s,n),qt(this,"closed"),this.closed=e}get type(){return"comment"}lint(t=this.getAbsoluteIndex()){{if(this.closed)return[];let e="unclosed-comment",{lintConfig:s}=T,n=s.getSeverity(e);if(!n)return[];let i=Z(this,{start:t},e,"unclosed-comment",n);return s.computeEditInfo&&(i.suggestions=[Ht(i.endIndex,"-->")]),[i]}}toString(t){return t?"":`<!--${this.innerText}${this.closed?"-->":""}`}print(){return super.print({pre:"&lt;!--",post:this.closed?"--&gt;":""})}},Zi=tt(jl),Ae=Q(Zi,0,"CommentToken",Wl,Ae),J(Zi,1,Ae)}}),Ol={};it(Ol,{CommentedToken:()=>Pl});var Pl,_a=I({"src/commented.ts"(){"use strict";z(),Ll(),Pl=class extends O{get type(){return"ext-inner"}constructor(t,e,s=[]){if(super(void 0,e,s,{AstText:":",CommentToken:":"}),t){let n=t.indexOf("<!--"),i=n!==-1&&t.indexOf("-->",n+4),l=0;for(;i!==!1&&i!==-1;)n>l&&this.insertAt(t.slice(l,n)),this.insertAt(new Ae(t.slice(n+4,i),!0,e,s)),l=i+3,n=t.indexOf("<!--",l),i=n!==-1&&t.indexOf("-->",n+4);l<t.length&&this.insertAt(t.slice(l))}}lint(t=this.getAbsoluteIndex()){return super.lint(t,new RegExp(String.raw`<\s*(?:\/\s*)?(${this.name})\b`,"giu"))}}}}),Ml={};it(Ml,{NowikiToken:()=>zl});var Rl,_l,zl,za=I({"src/nowiki/index.ts"(){"use strict";var t,e,s;Kt(),D(),q(),ne(),Rl=me(n=>new RegExp(String.raw`<\s*(?:/\s*)${n==="nowiki"?"":"?"}(${n})\b`,"giu")),_l=new Set(["languages","section","templatestyles"]),zl=(s=class extends Ft{constructor(){super(...arguments),N(this,t)}get type(){return"ext-inner"}lint(n=this.getAbsoluteIndex()){{let{name:i}=this,l="void-ext",{lintConfig:r}=T,c=r.getSeverity(l,i);if(c&&M(this,t,e).call(this)){let a=Z(this,{start:n},l,T.msg("nothing-in",i),c);return r.computeEditInfo&&(a.suggestions=[V(a)]),[a]}return super.lint(n,Rl(i))}}getAttribute(n){return n==="invalid"?M(this,t,e).call(this):super.getAttribute(n)}},t=new WeakSet,e=function(){let{name:n,firstChild:{data:i}}=this;return _l.has(n)&&!!i},s)}}),ql,Xi,Bl,Ie,Ul=I({"src/tagPair/ext.ts"(){"use strict";D(),ut(),q(),di(),z(),ui(),yi(),ql=[fs()],Ie=class extends(Bl=re){get type(){return"ext"}constructor(t,e,s,n,i=T.getConfig(),l=!1,r=[]){let c=t.toLowerCase(),a=new vs(!e||/^\s/u.test(e)?e:` ${e}`,"ext-attrs",c,i,r),o=zt(wt({},i),{ext:i.ext.filter(u=>u!==c),excludes:[...i.excludes],inExt:!0}),h;switch(c){case"tab":o.ext=o.ext.filter(u=>u!=="tabs");case"indicator":case"poem":case"ref":case"option":case"combooption":case"tabs":case"poll":case"seo":case"langconvert":case"phonos":c==="poem"&&o.excludes.push("heading"),h=new O(s,o,r);break;case"pre":{let{PreToken:u}=(Na(),X(Pr));h=new u(s,o,r);break}case"dynamicpagelist":{let{ParamTagToken:u}=(qr(),X(Rr));h=new u(l,s,o,r);break}case"inputbox":{let{InputboxToken:u}=(La(),X(sl));h=new u(l,s,o,r);break}case"references":{let{NestedToken:u}=(Li(),X(Ss));o.excludes.push("heading"),h=new u(s,l,["ref"],o,r);break}case"choose":{let{NestedToken:u}=(Li(),X(Ss));h=new u(s,/<(option|choicetemplate)(\s[^>]*?)?(?:\/>|>([\s\S]*?)<\/(\1)>)/gu,["option","choicetemplate"],o,r);break}case"combobox":{let{NestedToken:u}=(Li(),X(Ss));h=new u(s,/<(combooption)(\s[^>]*?)?(?:\/>|>([\s\S]*?)<\/(combooption\s*)>)/giu,["combooption"],o,r);break}case"gallery":{let{GalleryToken:u}=(Pa(),X(wl));h=new u(s,o,r);break}case"imagemap":{let{ImagemapToken:u}=(Ra(),X(Nl));h=new u(s,o,r);break}case"hiero":{let{CommentedToken:u}=(_a(),X(Ol));h=new u(s,o,r);break}default:{let{NowikiToken:u}=(za(),X(Ml));h=new u(s,o,r)}}h.setAttribute("name",c),h.type==="plain"&&(h.type="ext-inner"),super(t,a,h,n,i,r),this.seal("closed",!0)}lint(t=this.getAbsoluteIndex(),e){{let s=super.lint(t,e),{lintConfig:n}=T,i=new at(this,t);if(this.name!=="nowiki"){let c=this.inHtmlAttrs(),a="parsing-order",o=c&&n.getSeverity(a,c===2?"ext":"templateInTable");o&&s.push(Z(this,i,a,"ext-in-html",o))}let l="var-anchor",r=n.getSeverity(l,"ref");return r&&this.name==="ref"&&this.closest("heading-title")&&s.push(Z(this,i,l,"variable-anchor",r)),s}}},Xi=tt(Bl),Ie=Q(Xi,0,"ExtToken",ql,Ie),J(Xi,1,Ie)}}),Dl={};it(Dl,{parseCommentAndExt:()=>Xe});var Ji,Hl,$s,Gl,Qi,Xe,As=I({"parser/commentAndExt.ts"(){"use strict";Kt(),ft(),$a(),Xt(),Aa(),Ia(),Ul(),Ll(),Ji="<onlyinclude>",Hl="</onlyinclude>",{length:$s}=Ji,Gl=[!1,!0].map(t=>{let e=t?"includeonly":"(?:no|only)include",s=t?"noinclude":"includeonly";return Un(n=>new RegExp(String.raw`<!--[\s\S]*?(?:-->|$)|<${e}(?:\s[^>]*)?/?>|</${e}\s*>|<(${n.join("|")})(\s[^>]*?)?(?:/>|>([\s\S]*?)</(${"\\1"}\s*)>)|<(${s})(\s[^>]*?)?(?:/>|>([\s\S]*?)(?:</(${s}\s*)>|$))`,"giu"))}),Qi=t=>{let e=t.indexOf(Ji);return{i:e,j:t.indexOf(Hl,e+$s)}},Xe=(t,e,s,n)=>{if(n){let{i:a,j:o}=Qi(t);if(a!==-1&&o!==-1){let h="",u=d=>{new mt(d,e,s),h+=`\0${s.length-1}n`};for(;a!==-1&&o!==-1;){let d=`\0${s.length}e`;new ze(t.slice(a+$s,o),e,s),a>0&&u(t.slice(0,a)),h+=d,t=t.slice(o+$s+1),{i:a,j:o}=Qi(t)}return t&&u(t),h}}let{ext:i}=e,l=i.filter(a=>a!=="translate"&&a!=="tvar"),r=zt(wt({},e),{ext:l});if(i.includes("translate")){let a=[];t=t.replace(/<nowiki>[\s\S]*?<\/nowiki>/giu,o=>(a.push(o),`\0${a.length-1}`)).replace(/<translate( nowrap)?>([\s\S]+?)?<\/translate>/gu,(o,h,u)=>{let d=s.length;return new Sr(h,u&&At(u,a),r,s),`\0${d}g`}),t=At(t,a)}let c=Gl[n?1:0](l);return c.lastIndex=0,c.test(t)?t.replace(c,(a,o,h,u,d,g,p,k,S)=>{let $=s.length,x="n";if(o)x="e",new Ie(o,h,u,d,r,g,s);else if(a.startsWith("<!--")){x="c";let b=a.endsWith("-->");new Ae(At(a,s,1).slice(4,b?-3:void 0),b,e,s)}else g?new Be(g,p&&At(p,s,1),k&&At(k,s,1),S,e,s):new mt(a,e,s);return`\0${$}${x}`}):t}}}),Vl,Zl,Xl,Jl,Yi,Ql,Je,qa=I({"src/html.ts"(){"use strict";var t,e,s,n,i;D(),Lt(),ut(),di(),q(),z(),Vl=new Set(["if","ifeq","ifexpr","ifexist","iferror","switch"]),Zl=new Set(["b","big","center","cite","code","del","dfn","em","font","i","ins","kbd","mark","pre","q","s","samp","small","strike","strong","sub","sup","tt","u","var"]),Xl=new Set(["strike","big","center","font","tt"]),Jl=[fs()],Je=(i=class extends(Ql=O){constructor(l,r,c,a,o,h){super(void 0,o,h),N(this,t),N(this,e),N(this,s),N(this,n),this.insertAt(r),this.setAttribute("name",l.toLowerCase()),F(this,t,c),F(this,e,a),F(this,s,l)}get type(){return"html"}get selfClosing(){return m(this,e)}get closing(){return m(this,t)}toString(l){return`<${this.closing?"/":""}${m(this,s)}${super.toString(l)}${m(this,e)?"/":""}>`}text(){let{closing:l}=this,r=m(this,s)+(l?"":super.text());return`<${l?"/":""}${r}${m(this,e)?"/":""}>`}getAttribute(l){return l==="invalid"?this.inTableAttrs()===2:l==="padding"?m(this,s).length+(this.closing?2:1):super.getAttribute(l)}lint(l=this.getAbsoluteIndex(),r){var c;{let a=super.lint(l,r),{name:o,parentNode:h,closing:u,selfClosing:d}=this,g=new at(this,l),{lintConfig:p}=T,{computeEditInfo:k,fix:S}=p,$=this.inTableAttrs(),x="h1",b=p.getSeverity(x,"html");if(b&&o==="h1"&&!u){let C=Z(this,g,x,"<h1>",b);k&&(C.suggestions=[{desc:"h2",range:[l+2,l+3],text:"2"}]),a.push(C)}if(x="parsing-order",b=$&&p.getSeverity(x,$===2?"html":"templateInTable"),b){let C=Z(this,g,x,"html-in-table",b);k&&$===2&&(C.suggestions=[V(C)]),a.push(C)}if(x="obsolete-tag",b=p.getSeverity(x,o),b&&Xl.has(o)&&a.push(Z(this,g,x,"obsolete-tag",b)),x="bold-header",b=p.getSeverity(x,o),b&&(o==="b"||o==="strong")&&((c=this.closest("heading-title,ext"))==null?void 0:c.type)==="heading-title"){let C=Z(this,g,x,"bold-in-header",b);k&&(C.suggestions=[V(C)]),a.push(C)}let{html:[,y,f]}=this.getAttribute("config"),w=f.includes(o),v=y.includes(o),A=!w&&!v;if(x="unmatched-tag",u&&(d||w)||d&&A){if(b=p.getSeverity(x,u?"both":"selfClosing"),b){let C=Z(this,g,x,u?"closing-and-self-closing":"invalid-self-closing",b);if(k||S){let E=Vs(l),W={desc:T.msg("no-self-closing"),range:[C.endIndex-2,C.endIndex-1],text:""};v?k&&(C.suggestions=[E,W]):u?C.fix=w?E:W:k&&(C.suggestions=[W,Ht(C.endIndex,`></${o}>`,-2)])}a.push(C)}}else if(!this.findMatchingTag()){let C=Z(this,g,x,u?"unmatched-closing":"unclosed-tag"),E=this.closest("magic-word");if(E&&Vl.has(E.name))b=p.getSeverity(x,"conditional");else if(u)b=p.getSeverity(x,"closing"),C.suggestions=[V(C)];else{b=p.getSeverity(x,"opening");let W=h==null?void 0:h.childNodes;Zl.has(o)&&(W!=null&&W.slice(0,W.indexOf(this)).some(R=>R.type==="html"&&R.name===o&&!R.findMatchingTag())&&(C.suggestions=[Ht(l+1,"/")]),this.closest("heading-title")&&(C.rule="format-leakage",b=p.getSeverity("format-leakage",o)))}b&&(C.severity=b,a.push(C))}return a}}findMatchingTag(){return te(m(this,n),()=>{let{name:l,parentNode:r,closing:c,selfClosing:a}=this,{html:[,o,h]}=this.getAttribute("config"),u=h.includes(l),d=o.includes(l);if(u||d&&a)return this;if(!r)return;let{childNodes:g}=r,p=g.indexOf(this),k=c?g.slice(0,p).reverse():g.slice(p+1),S=[this],{rev:$}=It;for(let x of k)if(!(!x.is("html")||x.name!==l||d&&m(x,e)))if(m(x,t)===c)S.push(x);else{let b=S.pop();if(b===this)return x;T.viewOnly&&(F(b,n,[$,x]),F(x,n,[$,b]))}if(T.viewOnly)for(let x of S)F(x,n,[$,void 0])},l=>{F(this,n,l),l[1]&&l[1]!==this&&F(l[1],n,[It.rev,this])})}print(){return super.print({pre:`&lt;${this.closing?"/":""}${m(this,s)}`,post:`${m(this,e)?"/":""}&gt;`})}json(l,r=this.getAbsoluteIndex()){let c=super.json(void 0,r)}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i),Yi=tt(Ql),Je=Q(Yi,0,"HtmlToken",Jl,Je),J(Yi,1,Je)}}),Yl={};it(Yl,{parseHtml:()=>to});var Kl,to,Ba=I({"parser/html.ts"(){"use strict";yi(),qa(),Kl=/^(\/?)([a-z][^\s/>]*)((?:\s|\/(?!>))[^>]*?)?(\/?>)([^<]*)$/iu,to=(t,e,s)=>{var n;let{html:i}=e;(n=e.htmlElements)!=null||(e.htmlElements=new Set([...i[0],...i[1],...i[2]]));let l=t.split("<"),r=l.shift();for(let c of l){let a=Kl.exec(c),o=a==null?void 0:a[2],h=o==null?void 0:o.toLowerCase();if(!a||!e.htmlElements.has(h)){r+=`<${c}`;continue}let[,u,,d="",g,p]=a,{length:k}=s,S=new vs(d,"html-attrs",h,e,s),$=S.hasAttr("itemprop");if(h==="meta"&&!($&&S.hasAttr("content"))||h==="link"&&!($&&S.hasAttr("href"))){r+=`<${c}`,s.length=k;continue}r+=`\0${s.length}x${p}`,new Je(o,S,u==="/",g==="/>",e,s)}return r}}}),Ki,eo=I({"src/table/base.ts"(){"use strict";di(),z(),ve(),yi(),Ki=class extends fs(1)(O){constructor(t,e,s,n,i,l=[],r){super(void 0,i,l,r),this.append(new ie(e,"table-syntax",i,l),new vs(n,"table-attrs",s,i,l))}escape(){}}}}),so,tn,Wt,Is,Qe,Ye,Cs,io=I({"src/table/td.ts"(){"use strict";D(),ut(),Ys(),q(),z(),eo(),Cs=class extends(tn=Ki,so=[cs(!1)],tn){constructor(t,e,s,n=[]){var i;let l=/\||\0\d+!\x7F/u.exec(e!=null?e:""),r=l?e.slice(0,l.index):"";/\[\[|-\{/u.test(r)&&(l=null,r=""),super(/^(?:\n[^\S\n]*(?:[|!]|\|\+|\{\{\s*!\s*\}\}\+?)|(?:\||\{\{\s*!\s*\}\}){2}|!!|\{\{\s*!!\s*\}\})$/u,t,"td",r,s,n),J(Is,5,this),Bt(this,Qe),Bt(this,Wt,""),l&&([pa(this,Wt)._]=l);let c=new O(e==null?void 0:e.slice(((i=l==null?void 0:l.index)!=null?i:NaN)+pt(this,Wt).length),s,n);c.type="td-inner",c.setAttribute("stage",4),this.insertAt(c)}get type(){return"td"}get rowspan(){return this.getAttr("rowspan")}get colspan(){return this.getAttr("colspan")}get subtype(){return qs(this,Qe,Ye).call(this).subtype}afterBuild(){pt(this,Wt).includes("\0")&&$t(this,Wt,this.buildFromStr(pt(this,Wt),0)),super.afterBuild()}toString(t){let{childNodes:[e,s,n]}=this;return e.toString(t)+s.toString(t)+pt(this,Wt)+n.toString(t)}text(){let{childNodes:[t,e,s]}=this;return t.text()+e.text()+pt(this,Wt)+s.text()}getGaps(t){return t===1?pt(this,Wt).length:0}lint(t=this.getAbsoluteIndex(),e){{let s=super.lint(t,e),n=new at(this,t+this.getRelativeIndex(this.length-1)),i="pipe-like",{lintConfig:l}=T,{computeEditInfo:r,fix:c}=l,a=["td","double"].map(o=>l.getSeverity(i,o));for(let o of this.lastChild.childNodes)if(o.type==="text"){let{data:h}=o;if(h.includes("|")){let u=h.includes("||"),d=a[u?1:0];if(d){let g=_(o,n,i,"pipe-in-table",d);if(r||c)if(u){let p={caption:"|+",td:"|",th:"!"}[this.subtype];g.fix=Nt(g,"newline",h.replace(/\|\|/gu,`
${p}`))}else r&&(g.suggestions=[Js(g.startIndex,h)]);s.push(g)}}}return s}}isIndependent(){return this.firstChild.text().startsWith(`
`)}getAttr(t){let e=super.getAttr(t);return t==="rowspan"||t==="colspan"?parseInt(e)||1:e}escape(){}print(){let{childNodes:[t,e,s]}=this;return`<span class="wpb-td">${t.print()}${e.print()}${pt(this,Wt)}${s.print()}</span>`}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e)}},Is=tt(tn),Wt=new WeakMap,Qe=new WeakSet,Ye=function(){var t;let e=this.firstChild.text(),s=e.slice(-1),n="td";if(s==="!"?n="th":s==="+"&&(n="caption"),this.isIndependent())return{subtype:n};let{previousSibling:i}=this;return wt({},qs(t=i,Qe,Ye).call(t))},Ye=Q(Is,17,"#getSyntax",so,Qe,Ye),_s(Is,Cs)}}),en,no=I({"src/table/trBase.ts"(){"use strict";D(),q(),eo(),io(),en=class extends Ki{lint(t=this.getAbsoluteIndex(),e){{let s=super.lint(t,e),n=this.childNodes.find(({type:c})=>c==="table-inter");if(!n)return s;let i=Ee(n),l="fostered-content",r=i&&T.lintConfig.getSeverity(l,i===2?void 0:"transclusion");if(r){let c=_(n,{start:t},l,"content-outside-table",r);c.startIndex++,c.startLine++,c.startCol=0,s.push(c)}return s}}getRowCount(){return Number(this.childNodes.some(t=>t instanceof Cs&&t.isIndependent()&&!t.firstChild.text().endsWith("+")))}}}}),ro,lo,oo,ao,sn,Ts,Ns,Ua=I({"src/table/index.ts"(){"use strict";D(),Lt(),ut(),Ys(),q(),no(),ve(),ro=(t,e)=>new Array(t).fill(void 0).map((s,n)=>e(n)),lo=({type:t})=>t==="tr"||t==="table-syntax",oo=class extends Array{},Ns=class extends(sn=en,ao=[cs(!1)],sn){constructor(t,e,s,n){super(/^(?:\{\||\{\{\{\s*!\s*\}\}|\{\{\s*\(!\s*\}\})$/u,t,"table",e,s,n,{}),J(Ts,5,this)}get type(){return"table"}get closed(){return this.lastChild.is("table-syntax")}lint(t=this.getAbsoluteIndex(),e){{let s=super.lint(t,e),n=new at(this,t),i=["unclosed-table","table-layout"],l=i.map(r=>T.lintConfig.getSeverity(r));if(l[0]&&!this.closed&&s.push(_(this.firstChild,n,i[0],"unclosed-table",l[0])),l[1]){let r=this.getLayout(),{length:c}=r;if(c>1){let a=1,o=1/0,h=0;for(;h<c;h++){let u=r[h],d=u.length;if(d<a)break;d<o&&(o=d);let g=u.indexOf(u[d-1])+1;if(g>o)break;g>a&&(a=g)}if(h<c){let u=this.getNthRow(h),d=_(u,n,i[1],"inconsistent-table",l[1]);d.startIndex++,d.startLine++,d.startCol=0,s.push(d)}}}return s}}close(t=`
|}`,e){let s=this.getAttribute("config"),n=this.getAttribute("accum");It.run(()=>{let i=new ie(e?t:void 0,"table-syntax",s,n);super.insertAt(i)})}getLayout(t){let e=this.getAllRows(),{length:s}=e,n=oo.from(ro(s,()=>[]));for(let i=0;i<n.length;i++){let l=n[i],r=0,c=0,a;for(let o of e[i].childNodes.slice(2))if(o.is("td")){if(o.isIndependent()&&(a=o.subtype!=="caption"),a){let h={row:i,column:r},{rowspan:u,colspan:d}=o;for(r++;l[c];)c++;for(let g=i;g<Math.min(i+u,s);g++)for(let p=c;p<c+d;p++)n[g][p]=h;c+=d}}else if(lo(o))break}return n}getAllRows(){return[...super.getRowCount()?[this]:[],...this.childNodes.slice(1).filter(t=>t.is("tr")&&t.getRowCount()>0)]}getNthRow(t,e,s){let n=super.getRowCount();if(t===0&&n)return this;n&&t--;for(let i of this.childNodes.slice(2)){let{type:l}=i;if(l==="tr"&&i.getRowCount()&&(t--,t<0))return i}}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e)}},Ts=tt(sn),Q(Ts,1,"getLayout",ao,Ns),_s(Ts,Ns)}}),co,Da=I({"src/table/tr.ts"(){"use strict";no(),co=class extends en{get type(){return"tr"}constructor(t,e,s,n){super(/^\n[^\S\n]*(?:\|-+|\{\{\s*!\s*\}\}-+|\{\{\s*!-\s*\}\}-*)$/u,t,"tr",e,s,n)}}}}),nn,uo=I({"src/nowiki/listBase.ts"(){"use strict";ne(),nn=class extends Ft{get indent(){}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e)}}}}),rn,ho=I({"src/nowiki/dd.ts"(){"use strict";uo(),rn=class extends nn{get type(){return"dd"}}}}),go={};it(go,{parseTable:()=>fo});var po,ln,fo,Ha=I({"parser/table.ts"(){"use strict";z(),Ua(),Da(),io(),ho(),po=t=>t.lastChild.constructor!==O,ln=(t,e)=>t.is("td")?e.pop():t,fo=({firstChild:{data:t},type:e,name:s},n,i)=>{let l=[],r=t.split(`
`),c=e==="root"||e==="parameter-value"||e==="ext-inner"&&s==="poem"?"":`
${r.shift()}`,a,o=(h,u)=>{if(!u){c+=h;return}let{lastChild:d}=u;if(po(u)){let g=new O(h,n,i);g.type="table-inter",g.setAttribute("stage",3),u.insertAt(g)}else d.setText(d.toString()+h)};for(let h of r){a=l.pop();let[u]=/^(?:\s|\0\d+[cno]\x7F)*/u.exec(h),d=h.slice(u.length),g=/^(:*)((?:\s|\0\d+[cn]\x7F)*)(\{\||\{(?:\0\d+[cn]\x7F)*\0\d+!\x7F|\0\d+\{\x7F)(.*)$/u.exec(d);if(g){for(;a&&!a.is("td");)a=l.pop();let[,b,y,f,w]=g;b&&new rn(b,n,i),o(`
${u}${b&&`\0${i.length-1}d`}${y}\0${i.length}b`,a),l.push(...a?[a]:[],new Ns(f,w,n,i));continue}else if(!a){c+=`
${h}`;continue}let p=/^(?:(\|\}|\0\d+!\x7F\}|\0\d+\}\x7F)|(\|-+|\0\d+!\x7F-+|\0\d+-\x7F-*)(?!-)|(!|(?:\||\0\d+!\x7F)\+?))(.*)$/u.exec(d);if(!p){o(`
${h}`,a),l.push(a);continue}let[,k,S,$,x]=p;if(k){for(;!a.is("table");)a=l.pop();a.close(`
${u}${k}`,!0),o(x,l[l.length-1])}else if(S){a=ln(a,l),a.is("tr")&&(a=l.pop());let b=new co(`
${u}${S}`,x,n,i);l.push(a,b),a.insertAt(b)}else{a=ln(a,l);let b=$==="!"?/!!|(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu:/(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu,y=b.exec(x),f=0,w=`
${u}${$}`,v=A=>{let C=new Cs(w,x.slice(f,y==null?void 0:y.index),n,i);return A.insertAt(C),C};for(;y;)v(a),{lastIndex:f}=b,[w]=y,y=b.exec(x);l.push(a,v(a))}}return c.slice(1)}}}),mo,Ga=I({"src/nowiki/hr.ts"(){"use strict";ne(),mo=class extends Ft{get type(){return"hr"}}}}),xo,on,bo,Ke,Va=I({"src/nowiki/doubleUnderscore.ts"(){"use strict";be(),Gt(),ne(),xo=[se(),Mt("__")],Ke=class extends(bo=Ft){get type(){return"double-underscore"}constructor(t,e,s,n){var i,l;super(t,s,n);let r=t.toLowerCase(),{doubleUnderscore:[,,c,a]}=s;this.setAttribute("name",(l=e?(i=a==null?void 0:a[t])==null?void 0:i.toLowerCase():c==null?void 0:c[r])!=null?l:r)}toString(){return`__${this.innerText}__`}print(){return super.print({pre:"__",post:"__"})}},on=tt(bo),Ke=Q(on,0,"DoubleUnderscoreToken",xo,Ke),J(on,1,Ke)}}),vo={};it(vo,{parseHrAndDoubleUnderscore:()=>wo});var wo,Za=I({"parser/hrAndDoubleUnderscore.ts"(){"use strict";Ga(),Va(),Dr(),wo=({firstChild:{data:t},type:e,name:s},n,i)=>{var l,r,c;let{doubleUnderscore:[a,o,h]}=n;return(l=n.insensitiveDoubleUnderscore)!=null||(n.insensitiveDoubleUnderscore=new Set(a)),(r=n.sensitiveDoubleUnderscore)!=null||(n.sensitiveDoubleUnderscore=new Set(o)),(c=n.regexHrAndDoubleUnderscore)!=null||(n.regexHrAndDoubleUnderscore=new RegExp(`__(${[...a,...o].join("|")})__`,"giu")),e!=="root"&&(e!=="ext-inner"||s!=="poem")&&(t=`\0${t}`),t=t.replace(/^((?:\0\d+[cno]\x7F)*)(-{4,})/gmu,(u,d,g)=>(new mo(g,n,i),`${d}\0${i.length-1}r`)).replace(n.regexHrAndDoubleUnderscore,(u,d)=>{var g;let p=n.sensitiveDoubleUnderscore.has(d),k=d.toLowerCase(),S=n.insensitiveDoubleUnderscore.has(k);return p||S?(new Ke(d,p,n,i),`\0${i.length-1}${S&&((g=h==null?void 0:h[k])!=null?g:k)==="toc"?"u":"n"}`):u}),n.excludes.includes("heading")||(t=t.replace(/^((?:\0\d+[cn]\x7F)*)(={1,6})(.+)\2((?:\s|\0\d+[cn]\x7F)*)$/gmu,(u,d,g,p,k)=>{let S=`${d}\0${i.length}h`;return new ye(g.length,[p,k],n,i),S})),e==="root"||e==="ext-inner"&&s==="poem"?t:t.slice(1)}}}),yo,Xa=I({"src/nowiki/quote.ts"(){"use strict";var t,e;D(),ut(),q(),ne(),yo=(e=class extends Ft{constructor(s,n,i,l){super(s,i,l),N(this,t),F(this,t,n)}get type(){return"quote"}get bold(){return this.innerText.length!==2}get italic(){return this.innerText.length!==3}get closing(){return wt(wt({},this.bold?{bold:m(this,t).bold}:void 0),this.italic?{italic:m(this,t).italic}:void 0)}text(){let{parentNode:s,innerText:n}=this;return s!=null&&s.is("image-parameter")&&s.name!=="caption"?"":n}lint(s=this.getAbsoluteIndex()){var n;{let{previousSibling:i,bold:l,closing:r}=this,c=(i==null?void 0:i.type)==="text"?i.data:void 0,a=[],o=new at(this,s),h=["lonely-apos","bold-header"],{lintConfig:u}=T,{computeEditInfo:d}=u,g=[void 0,"word"].map(k=>u.getSeverity(h[0],k)),p=u.getSeverity(h[1]);if(c!=null&&c.endsWith("'")){let k=g[(r.bold||r.italic)&&/[a-z\d]'$/iu.test(c)?1:0];if(k){let S=Z(this,o,h[0],T.msg("lonely","'"),k),{startLine:$,startCol:x}=S,[,{length:b}]=/(?:^|[^'])('+)$/u.exec(c),y=s-b,f=zt(wt({},S),{startIndex:y,endIndex:s,endLine:$,startCol:x-b,endCol:x});d&&(f.suggestions=[xe(y,"&apos;",b),V(f)]),a.push(f)}}if(p&&l&&((n=this.closest("heading-title,ext"))==null?void 0:n.type)==="heading-title"){let k=Z(this,o,h[1],"bold-in-header",p);d&&(k.suggestions=[V(k)]),a.push(k)}return a}}json(s,n=this.getAbsoluteIndex()){let i=super.json(void 0,n)}},t=new WeakMap,e)}}),ko={};it(ko,{parseQuotes:()=>an});var an,So=I({"parser/quotes.ts"(){"use strict";Xa(),an=(t,e,s,n)=>{var i;let l=t.split(/('{2,})/u),{length:r}=l;if(r===1)return t;let c=0,a=0,o,h,u;for(let p=1;p<r;p+=2){let k=l[p].length;switch(k){case 2:a++;break;case 4:l[p-1]+="'",l[p]="'''";case 3:if(c++,o!==void 0)break;l[p-1].endsWith(" ")?h===void 0&&u===void 0&&(u=p):l[p-1].slice(-2,-1)===" "?o=p:h!=null||(h=p);break;default:l[p-1]+="'".repeat(k-5),l[p]="'''''",a++,c++}}if(a%2===1&&c%2===1){let p=(i=o!=null?o:h)!=null?i:u;p!==void 0&&(l[p]="''",l[p-1]+="'")}let d=!0,g=!0;for(let p=1;p<r;p+=2){let k=l[p].length,S=k!==2,$=k!==3;S&&(d=!d),$&&(g=!g),new yo(l[p],{bold:S&&d,italic:$&&g},e,s),l[p]=`\0${s.length-1}q`}return l.join("")}}}),$o={};it($o,{parseExternalLinks:()=>cn});var cn,Ao=I({"parser/externalLinks.ts"(){"use strict";ft(),Tl(),Di(),cn=(t,e,s,n)=>{var i;return(i=e.regexExternalLinks)!=null||(e.regexExternalLinks=new RegExp(String.raw`\[((?:\0\d+[cn]\x7F)*(?:\0\d+f\x7F|(?:(?:${e.protocol}|//)${he}|\0\d+m\x7F)${de}(?=[[\]<>"\t${Ut}]|\0\d)))([${Ut}]*(?![${Ut}]))([^\]\x01-\x08\x0A-\x1F\uFFFD]*)\]`,"giu")),t.replace(e.regexExternalLinks,(l,r,c,a)=>{let{length:o}=s,h=/&[lg]t;/u.exec(r);return h&&(c="",a=r.slice(h.index)+c+a,r=r.slice(0,h.index)),n?(new Ve(r,"ext-link-url",e,s),`[\0${o}f${c}${a}]`):(new $e(r,c,a,e,s),`\0${o}w`)})}}}),Io,Ja=I({"src/link/category.ts"(){"use strict";gs(),Io=class extends Zt{get type(){return"category"}get sortkey(){}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e)}}}}),Co={};it(Co,{parseLinks:()=>un});var To,un,Qa=I({"parser/links.ts"(){"use strict";ft(),q(),So(),Ao(),Sl(),ml(),Ja(),To=/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(\||\0\d+!\x7F)([\s\S]*)$/u,un=(t,e,s,n)=>{var i;(i=e.regexLinks)!=null||(e.regexLinks=new RegExp(String.raw`^\s*(?:${e.protocol}|//)`,"iu"));let l=e.inExt?/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)([\s\S]*?[^\]]))?\]\]([\s\S]*)$/u:/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])*)(?:(\||\0\d+!\x7F)([\s\S]*?[^\]])?)?\]\]([\s\S]*)$/u,r=t.split("[["),c=r.shift();for(let a=0;a<r.length;a++){let o=!1,h,u,d,g,p=r[a],k=l.exec(p);if(k)[,h,u,d,g]=k,g.startsWith("]")&&d!=null&&d.includes("[")&&(d+="]",g=g.slice(1));else{let f=To.exec(p);f&&(o=!0,[,h,u,d]=f)}if(h===void 0||e.regexLinks.test(h)||/\0\d+[exhbru]\x7F/u.test(h)){c+=`[[${p}`;continue}let S=yt(h).trim(),$=S.startsWith(":");if($&&o){c+=`[[${p}`;continue}else!S&&d&&!d.includes(`
`)&&(S=yt(d).trim());let{ns:x,valid:b}=T.normalizeTitle(S,0,!1,e,{halfParsed:!0,temporary:!0,decode:!0,selfLink:!0});if(b){if(o){if(x!==6){c+=`[[${p}`;continue}let f=!1;for(a++;a<r.length;a++){let w=r[a],v=w.split("]]");if(v.length>2){f=!0,d+=`[[${v[0]}]]${v[1]}`,g=v.slice(2).join("]]");break}else if(v.length===2)d+=`[[${v[0]}]]${v[1]}`;else{d+=`[[${w}`;break}}if(d=un(d,e,s,n),!f){c+=`[[${h}${u}${d}`;continue}}}else{c+=`[[${p}`;continue}d&&(d=an(d,e,s,n));let y=Ui;$||(x===6?(d&&(d=cn(d,e,s,!0)),y=zi):x===14&&(y=Io)),d===void 0&&u&&(d=""),c+=`\0${s.length}l${g}`,new y(h,d,e,s,u)}return c}}}),No={};it(No,{parseMagicLinks:()=>Fo});var hn,dn,gn,pn,Fo,Ya=I({"parser/magicLinks.ts"(){"use strict";ft(),Di(),hn=String.raw`[${Ut}\t]|&nbsp;|&#0*160;|&#x0*a0;`,dn=`(?:${hn})+`,gn=`(?:${hn}|-)`,pn=String.raw`(?:RFC|PMID)${dn}\d+\b|ISBN${dn}(?:97[89]${gn}?)?(?:\d${gn}?){9}[\dx]\b`,Fo=(t,e,s)=>{if(!e.regexMagicLinks)try{e.regexMagicLinks=new RegExp(String.raw`(^|[^\p{L}\p{N}_])(?:(?:${e.protocol})(${he}${de})|${pn})`,"giu")}catch(n){e.regexMagicLinks=new RegExp(String.raw`(^|\W)(?:(?:${e.protocol})(${he}${de})|${pn})`,"giu")}return t.replace(e.regexMagicLinks,(n,i,l)=>{let r=i?n.slice(i.length):n;if(l){let c="",a=/&(?:lt|gt|nbsp|#x0*(?:3[ce]|a0)|#0*(?:6[02]|160));/iu.exec(r);a&&(c=r.slice(a.index),r=r.slice(0,a.index));let o=r.includes("(")?/[^,;\\.:!?][,;\\.:!?]+$/u:/[^,;\\.:!?)][,;\\.:!?)]+$/u,h=o.exec(r);if(h){let u=1;h[0][1]===";"&&/&(?:[a-z]+|#x[\da-f]+|#\d+)$/iu.test(r.slice(0,h.index))&&(u=2),c=r.slice(h.index+u)+c,r=r.slice(0,h.index+u)}return c.length>=l.length?n:(new Ve(r,void 0,e,s),`${i}\0${s.length-1}w${c}`)}else if(!/^(?:RFC|PMID|ISBN)/u.test(r))return n;return new Ve(r,"magic-link",e,s),`${i}\0${s.length-1}i`})}}}),Eo,Ka=I({"util/html.ts"(){"use strict";Eo=(t,e)=>t.startsWith(e)?e.length:[...e].findIndex((s,n)=>s!==t[n])}}),Wo,tc=I({"src/nowiki/list.ts"(){"use strict";uo(),Wo=class extends nn{get type(){return"list"}}}}),jo={};it(jo,{parseList:()=>Lo});var Lo,ec=I({"parser/list.ts"(){"use strict";Ka(),tc(),ho(),Lo=(t,e,s,n)=>{let i=/^((?:\0\d+[cno]\x7F)*)([;:*#]+)(\s*)/u.exec(t);if(!i)return e.lastPrefix="",t;let[l,r,c,a]=i,o=c.replace(/;/gu,":"),h=Eo(o,e.lastPrefix),u=((h>1?c.slice(h-1):c)+a).split(/(?=;)/u),d=u[0].startsWith(";"),g=u.length-(d?0:1);if(h>1){let E=c.slice(0,h-1);if(d){let W=E.split(/(?=;)/u);u.unshift(...W),g+=E.includes(";")?W.length:0}else u[0]=E+u[0]}e.lastPrefix=o;let p=r+u.map((E,W)=>`\0${n.length+W}d`).join("")+t.slice(l.length);for(let E of u)new Wo(E,s,n);if(!g)return p;let{html:[k,,S]}=s,$=/:+|-\{|\0\d+[xq]\x7F/gu,x=$,b=x.exec(p),y=0,f=!1,w=!1,v=0,A=(E,W)=>(new rn(E,s,n),`${p.slice(0,W)}\0${n.length-1}d${p.slice(W+E.length)}`),C=E=>{E?y&&y--:y++};for(;b&&g;){let{0:E,index:W}=b;if(E==="-{"){if(!v){let{lastIndex:R}=x;x=/-\{|\}-/gu,x.lastIndex=R}v++}else if(E==="}-"){if(v--,!v){let{lastIndex:R}=x;x=$,x.lastIndex=R}}else if(E.endsWith("x")){let{name:R,closing:H,selfClosing:B}=n[Number(E.slice(1,-2))];(k.includes(R)||!B&&!S.includes(R))&&C(H)}else if(E.endsWith("q")){let{bold:R,italic:H}=n[Number(E.slice(1,-2))];R&&(C(f),f=!f),H&&(C(w),w=!w)}else if(y===0){if(E.length>=g)return A(E.slice(0,g),W);g-=E.length,x.lastIndex=W+4+String(n.length).length,p=A(E,W)}b=x.exec(p)}return p}}}),Fs,Oo,fn,Po,ts,sc=I({"src/converterFlags.ts"(){"use strict";var t,e;D(),ut(),ps(),q(),z(),Vt(),Fs=new Set(["A","T","R","D","-","H","N"]),Oo=[qe()],ts=(e=class extends(Po=O){constructor(s,n,i=[]){super(void 0,n,i,{}),N(this,t),this.safeAppend(s.map(l=>new bt(l,"converter-flag",n,i)))}get type(){return"converter-flags"}afterBuild(){F(this,t,this.childNodes.map(s=>s.text().trim())),super.afterBuild()}toString(s){return super.toString(s,";")}text(){return super.text(";")}getUnknownFlags(){return new Set(m(this,t).filter(s=>/\{{3}[^{}]+\}{3}/u.test(s)))}getVariantFlags(){let s=new Set(this.getAttribute("config").variants);return new Set(m(this,t).filter(n=>s.has(n)))}isInvalidFlag(s,n,i,l){return typeof s=="object"&&(s=s.text().trim(),n=this.getVariantFlags(),i=this.getUnknownFlags(),l=new Set(m(this,t).filter(r=>Fs.has(r)))),!!s&&!n.has(s)&&!i.has(s)&&(n.size>0||!l.has(s))}lint(s=this.getAbsoluteIndex(),n){{let i=this.getVariantFlags(),l=this.getUnknownFlags(),r=new Set(m(this,t).filter(k=>Fs.has(k))),c=m(this,t).filter(k=>!k).length,a=m(this,t).length-l.size-c,{lintConfig:o}=T,{computeEditInfo:h,fix:u}=o,d=super.lint(s,n);if(i.size===a||r.size===a)return d;let g="no-ignored",p=o.getSeverity(g,"conversionFlag");if(p){let k=new at(this,s);for(let S=0;S<this.length;S++){let $=this.childNodes[S],x=$.text().trim();if(this.isInvalidFlag(x,i,l,r)){let b=_($,k,g,"invalid-conversion-flag",p);(h||u)&&(i.size===0&&Fs.has(x.toUpperCase())?b.fix=Xs(b,x):h&&(b.suggestions=[V(b,S&&-1)])),d.push(b)}}}return d}}print(){return super.print({sep:";"})}},t=new WeakMap,e),fn=tt(Po),ts=Q(fn,0,"ConverterFlagsToken",Oo,ts),J(fn,1,ts)}}),Es,ic=I({"src/converterRule.ts"(){"use strict";q(),z(),Vt(),Es=class extends O{get type(){return"converter-rule"}get variant(){}constructor(t,e=!0,s=T.getConfig(),n=[]){super(void 0,s,n);let i=t.indexOf(":"),l=t.slice(0,i).indexOf("=>"),r=l===-1?t.slice(0,i):t.slice(l+2,i);e&&s.variants.includes(r.trim().toLowerCase())?(super.insertAt(new bt(r,"converter-rule-variant",s,n)),super.insertAt(new bt(t.slice(i+1),"converter-rule-to",s,n)),l!==-1&&super.insertAt(new bt(t.slice(0,l),"converter-rule-from",s,n),0)):super.insertAt(new bt(t,"converter-rule-to",s,n))}toString(t){let{childNodes:e,firstChild:s,lastChild:n}=this;return e.length===3?`${s.toString(t)}=>${e[1].toString(t)}:${n.toString(t)}`:super.toString(t,":")}text(){let{childNodes:t,firstChild:e,lastChild:s}=this;return t.length===3?`${e.text()}=>${t[1].text()}:${s.text()}`:super.text(":")}getGaps(t){return t===0&&this.length===3?2:1}print(){let{childNodes:t}=this;if(t.length===3){let[e,s,n]=t;return`<span class="wpb-converter-rule">${e.print()}=>${s.print()}:${n.print()}</span>`}return super.print({sep:":"})}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e)}}}}),Mo,mn,Ro,es,nc=I({"src/converter.ts"(){"use strict";ft(),Gt(),Pt(),z(),sc(),ic(),Mo=[jt,Mt("-{")],es=class extends(Ro=O){get type(){return"converter"}constructor(t,e,s,n=[]){super(void 0,s,n),this.insertAt(new ts(t,s,n));let[i]=e,l=i.includes(":"),r=new Es(i,l,s,n);l&&r.length===1||!l&&e.length===2&&!yt(e[1]).trim()?this.insertAt(new Es(e.join(";"),!1,s,n)):this.append(r,...e.slice(1).map(c=>new Es(c,!0,s,n)))}toString(t){let{childNodes:[e,...s]}=this;return`-{${e.toString(t)}${e.length>0?"|":""}${s.map(n=>n.toString(t)).join(";")}}-`}text(){let{childNodes:[t,...e]}=this;return`-{${t.text()}|${Yt(e,";")}}-`}getGaps(t){return t||this.firstChild.length>0?1:0}print(){let{childNodes:[t,...e]}=this;return`<span class="wpb-converter">-{${t.print()}${t.length>0?"|":""}${fe(e,{sep:";"})}}-</span>`}},mn=tt(Ro),es=Q(mn,0,"ConverterToken",Mo,es),J(mn,1,es)}}),_o={};it(_o,{parseConverter:()=>zo});var zo,rc=I({"parser/converter.ts"(){"use strict";nc(),zo=(t,e,s)=>{var n;(n=e.regexConverter)!=null||(e.regexConverter=new RegExp(String.raw`;(?=(?:[^;]*?=>)?\s*(?:${e.variants.join("|")})\s*:|(?:\s|\0\d+[cn]\x7F)*$)`,"iu"));let i=/-\{/gu,l=/-\{|\}-/gu,r=[],c=i,a=c.exec(t);for(;a;){let{0:o,index:h}=a;if(o==="}-"){let u=r.pop(),{length:d}=s,g=t.slice(u.index+2,h),p=g.indexOf("|"),[k,S]=p===-1?[[],g]:[g.slice(0,p).split(";"),g.slice(p+1)],$=S.replace(/(&[#a-z\d]+);/giu,"$1"),x=$.split(e.regexConverter).map(b=>b.replace(/\x01/gu,";"));new es(k,x,e,s),t=`${t.slice(0,u.index)}\0${d}v${t.slice(h+2)}`,r.length===0&&(c=i),c.lastIndex=u.index+3+String(d).length}else r.push(a),c=l,c.lastIndex=h+2;a=c.exec(t)}return t}}}),Ws={};it(Ws,{Token:()=>O});var qo,O,z=I({"src/index.ts"(){"use strict";var t,e,s,n,i,l,r,c,a,o,h,u,d,g,p,k,S,$,x,b,y;ft(),Dt(),D(),Lt(),q(),va(),wa(),qo=["category","html-attr#id,ext-attr#id,table-attr#id"],O=(y=class extends Re{constructor(f,w=T.getConfig(),v=[],A){super(),N(this,c),N(this,t,"plain"),N(this,e,0),N(this,s),N(this,n),N(this,i),N(this,l,!1),N(this,r),typeof f=="string"&&this.insertAt(f),F(this,s,w),F(this,n,v),v.push(this)}get type(){return m(this,t)}set type(f){F(this,t,f)}parseOnce(f=m(this,e),w=!1,v){if(f<m(this,e)||this.length===0||!this.isPlain())return this;if(m(this,e)>=St)return this;switch(f){case 0:if(this.type==="root"){m(this,n).pop();let A=M(this,c,a).call(this);w&&(w=!A)}F(this,i,w),M(this,c,o).call(this,w);break;case 1:M(this,c,h).call(this);break;case 2:M(this,c,u).call(this);break;case 3:M(this,c,d).call(this);break;case 4:M(this,c,g).call(this);break;case 5:M(this,c,p).call(this,v);break;case 6:M(this,c,k).call(this,v);break;case 7:M(this,c,S).call(this);break;case 8:M(this,c,$).call(this);break;case 9:M(this,c,x).call(this);break;case 10:M(this,c,b).call(this)}if(this.type==="root")for(let A of m(this,n))A==null||A.parseOnce(f,w,v);return oa(this,e)._++,this}buildFromStr(f,w){let v=f.split(/[\0\x7F]/u).map((A,C)=>{if(C%2===0)return new ii(A);if(isNaN(A.slice(-1)))return m(this,n)[Number(A.slice(0,-1))];throw new Error(`Failed to build! Unrecognized token: ${A}`)});return w===0?v.map(String).join(""):w===1?Yt(v):v}build(){F(this,e,St);let{length:f,firstChild:w}=this,v=w==null?void 0:w.toString();if(f===1&&w.type==="text"&&v.includes("\0")&&(xn(this,0,1,this.buildFromStr(v)),this.normalize(),this.type==="root"))for(let A of m(this,n))A==null||A.build()}afterBuild(){if(this.type==="root")for(let f of m(this,n))f==null||f.afterBuild();F(this,l,!0)}parse(f=St,w,v){for(f=Math.min(f,St);m(this,e)<f;)this.parseOnce(m(this,e),w,v);return f&&(this.build(),this.afterBuild()),this}isPlain(){return this.constructor===y}getAttribute(f){var w;switch(f){case"config":return m(this,s);case"include":return(w=m(this,i))!=null?w:!!m(this.getRootNode(),i);case"accum":return m(this,n);case"built":return m(this,l);case"stage":return m(this,e);case"invalid":return this.type==="table-inter"&&Ee(this)===2;default:return super.getAttribute(f)}}setAttribute(f,w){switch(f){case"stage":m(this,e)===0&&this.type==="root"&&m(this,n).shift(),F(this,e,w);break;default:super.setAttribute(f,w)}}insertAt(f,w=this.length){let v=typeof f=="string"?new ii(f):f;super.insertAt(v,w);let{type:A}=v;return A==="root"&&(v.type="plain"),v}normalizeTitle(f,w=0,v){return T.normalizeTitle(f,w,m(this,i),m(this,s),v)}inTableAttrs(){var f,w;return((f=this.closest("table-attrs,ext"))==null?void 0:f.type)==="table-attrs"&&((w=this.closest("table-attrs,arg,magic-word,template"))!=null&&w.is("table-attrs")?2:1)}inHtmlAttrs(){var f;return(f=this.closest("html-attrs,ext"))!=null&&f.is("html-attrs")?2:this.inTableAttrs()}lint(f=this.getAbsoluteIndex(),w){var v;{let{lintConfig:A}=T,{computeEditInfo:C,fix:E,ignoreDisables:W,configurationComment:R}=A,H=super.lint(f,w);if(this.type==="root"){let B=new Map,Y="no-duplicate",kt=["category","id"].map(j=>A.getSeverity(Y,j)),st=this.toString(),G=qo.filter((j,et)=>kt[et]).join();if(G){for(let j of this.querySelectorAll(G)){let et;if(j.is("category"))et=j.name;else{let K=j.getValue();K&&K!==!0&&(et=`#${K}`)}if(et){let K=B.get(et);K?K.add(j):B.set(et,new Set([j]))}}for(let[j,et]of B)if(et.size>1&&!j.startsWith("#mw-customcollapsible-")){let K=!j.startsWith("#"),nt=`duplicate-${K?"category":"id"}`,ct=kt[K?0:1];H.push(...[...et].map(ht=>{let rt=Z(ht,{start:ht.getAbsoluteIndex()},Y,nt,ct);return C&&K&&(rt.suggestions=[V(rt)]),rt}))}}if(!W){let j=new RegExp(String.raw`<!--\s*${R}-(disable(?:(?:-next)?-line)?|enable)(\s[\sa-z,-]*)?-->`,"gu"),et=[],K=j.exec(st);for(;K;){let{1:nt,index:ct}=K,ht=(v=K[2])==null?void 0:v.trim();et.push({line:this.posFromIndex(ct).top+(nt==="disable-line"?0:1),from:nt==="disable"?j.lastIndex:void 0,to:nt==="enable"?j.lastIndex:void 0,rules:ht?new Set(ht.split(",").map(rt=>rt.trim())):void 0}),K=j.exec(st)}H=H.filter(({rule:nt,startLine:ct,startIndex:ht})=>{let rt={pos:0};for(let{line:Rt,from:_t,to:dt,rules:Ct}of et){if(Rt>ct+1)break;if(!(Ct&&!Ct.has(nt))){if(Rt===ct&&_t===void 0&&dt===void 0)return!1;_t<=ht&&_t>rt.pos?(rt.pos=_t,rt.type="from"):dt<=ht&&dt>rt.pos&&(rt.pos=dt,rt.type="to")}}return rt.type!=="from"})}if(E&&H.some(({fix:j})=>j)){let j=H.map(({fix:nt})=>nt).filter(Boolean).sort(({range:[nt,ct]},{range:[ht,rt]})=>ct===rt?ht-nt:rt-ct),et=1/0,K=st;for(let{range:[nt,ct],text:ht}of j)ct<=et&&(K=K.slice(0,nt)+ht+K.slice(ct),et=nt);Object.assign(H,{output:K})}if(!C)for(let j of H)delete j.fix,delete j.suggestions}return H}}toString(f,w){return f?super.toString(!0,w):te(m(this,r),()=>super.toString(!1,w),v=>{let A=this.getRootNode();A.type==="root"&&m(A,l)&&F(this,r,v)})}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakMap,l=new WeakMap,r=new WeakMap,c=new WeakSet,a=function(){let{parseRedirect:f}=(Sa(),X(xr)),w=this.firstChild.toString(),v=f(w,m(this,s),m(this,n));return v&&this.setText(v),!!v},o=function(f){let{parseCommentAndExt:w}=(As(),X(Dl));this.setText(w(this.firstChild.toString(),m(this,s),m(this,n),f))},h=function(){let{parseBraces:f}=(ji(),X(Kr)),w=this.type==="root"?this.firstChild.toString():`\0${this.firstChild.toString()}`,v=f(w,m(this,s),m(this,n));this.setText(this.type==="root"?v:v.slice(1))},u=function(){if(m(this,s).excludes.includes("html"))return;let{parseHtml:f}=(Ba(),X(Yl));this.setText(f(this.firstChild.toString(),m(this,s),m(this,n)))},d=function(){if(m(this,s).excludes.includes("table"))return;let{parseTable:f}=(Ha(),X(go));this.setText(f(this,m(this,s),m(this,n)))},g=function(){if(m(this,s).excludes.includes("hr"))return;let{parseHrAndDoubleUnderscore:f}=(Za(),X(vo));this.setText(f(this,m(this,s),m(this,n)))},p=function(f){let{parseLinks:w}=(Qa(),X(Co));this.setText(w(this.firstChild.toString(),m(this,s),m(this,n),f))},k=function(f){if(m(this,s).excludes.includes("quote"))return;let{parseQuotes:w}=(So(),X(ko)),v=this.firstChild.toString().split(`
`);for(let A=0;A<v.length;A++)v[A]=w(v[A],m(this,s),m(this,n),f);this.setText(v.join(`
`))},S=function(){if(m(this,s).excludes.includes("extLink"))return;let{parseExternalLinks:f}=(Ao(),X($o));this.setText(f(this.firstChild.toString(),m(this,s),m(this,n)))},$=function(){if(m(this,s).excludes.includes("magicLink"))return;let{parseMagicLinks:f}=(Ya(),X(No));this.setText(f(this.firstChild.toString(),m(this,s),m(this,n)))},x=function(){if(m(this,s).excludes.includes("list"))return;let{parseList:f}=(ec(),X(jo)),{firstChild:w,type:v,name:A}=this,C=w.toString().split(`
`),E={lastPrefix:""},W=v==="root"||v==="ext-inner"&&A==="poem"?0:1;for(;W<C.length;W++)C[W]=f(C[W],E,m(this,s),m(this,n));this.setText(C.join(`
`))},b=function(){if(m(this,s).variants.length>0){let{parseConverter:f}=(rc(),X(_o));this.setText(f(this.firstChild.toString(),m(this,s),m(this,n)))}},y)}}),It,js,xn,Lt=I({"util/debug.ts"(){"use strict";It={running:!1,run(t){let{running:e}=this;this.running=!0;try{let{Token:s}=(z(),X(Ws)),n=t();return n instanceof s&&!n.getAttribute("built")&&n.afterBuild(),this.running=e,n}catch(s){throw this.running=e,s}},rev:0},js=t=>e=>e.type===t,xn=(t,e,s,n=[])=>{var i,l;let r=t.getChildNodes(),c;r.length===s?(c=r,r=n):c=r.splice(e,s,...n);for(let a=0;a<n.length;a++){let o=n[a];o.setAttribute("parentNode",t),o.setAttribute("nextSibling",r[e+a+1]),o.setAttribute("previousSibling",r[e+a-1])}return(i=r[e-1])==null||i.setAttribute("nextSibling",r[e]),(l=r[e+n.length])==null||l.setAttribute("previousSibling",r[e+n.length-1]),r===n&&t.setAttribute("childNodes",r),c}}}),ss,bn,Ls,vn,Bo,wn,Uo,yn,lc=I({"lib/lintConfig.ts"(){"use strict";var t,e;On(),ss=new Map([[0,!1],[1,"warning"],[2,"error"],[!1,!1],["off",!1],["warning","warning"],["error","error"]]),bn={"bold-header":[1,{}],"format-leakage":[1,{}],"fostered-content":[1,{}],h1:[1,{}],"illegal-attr":[2,{}],"insecure-style":2,"invalid-gallery":[2,{parameter:1}],"invalid-imagemap":[2,{}],"invalid-invoke":[2,{}],"invalid-isbn":2,"lonely-apos":[1,{}],"lonely-bracket":[1,{extLink:2}],"lonely-http":[1,{}],"nested-link":[2,{}],"no-arg":1,"no-duplicate":[2,{category:1,id:1,unknownImageParameter:1}],"no-ignored":[2,{fragment:1,galleryComment:1,galleryNoImage:1,include:1,nonWordAttributes:1,redirect:1}],"obsolete-attr":1,"obsolete-tag":1,"parsing-order":[2,{templateInTable:1}],"pipe-like":[1,{double:2}],"table-layout":1,"tag-like":[2,{disallowed:1,invalid:1}],"unbalanced-header":2,"unclosed-comment":[1,{}],"unclosed-quote":1,"unclosed-table":2,unescaped:2,"unknown-page":1,"unmatched-tag":[1,{}],"unterminated-url":[1,{}],"url-encoding":[1,{}],"var-anchor":[1,{}],"void-ext":[2,{}]},Object.freeze(bn),Ls={configurationComment:"lint",ignoreDisables:!1,fix:!0,computeEditInfo:!0},Object.freeze(Ls),vn=s=>ss.has(s),Bo=s=>vn(s)||Array.isArray(s)&&vn(s[0])&&(s.length===1||typeof s[1]=="object"),wn=(s,n,i)=>{if(ls.includes(n)){if(i===void 0)return!1;if(Bo(i))return s[n]=i,!0}else throw new RangeError(`Unknown lint rule: ${n}`);throw new RangeError(`Invalid lint config for ${n}: ${JSON.stringify(i)}`)},Uo=class{constructor(s){if(Object.assign(this,JSON.parse(JSON.stringify(bn))),!!s)for(let[n,i]of Object.entries(s))wn(this,n,i)}getSeverity(s,n){var i,l;let r=this[s];return typeof r!="object"?ss.get(r):n&&(l=ss.get((i=r[1])==null?void 0:i[n]))!=null?l:ss.get(r[0])}},yn=(e=class{constructor(s){if(N(this,t),Object.assign(this,Ls),s&&!("rules"in s)&&Object.keys(s).some(n=>ls.includes(n)))this.rules=s;else{let n=s!=null?s:{},{rules:i}=n,l=ra(n,["rules"]);this.rules=i;for(let[r,c]of Object.entries(l))c!==void 0&&Object.prototype.hasOwnProperty.call(Ls,r)&&(this[r]=c)}}get rules(){return m(this,t)}set rules(s){F(this,t,new Proxy(new Uo(s),{set:wn,deleteProperty(){return!1}}))}getSeverity(s,n){return m(this,t).getSeverity(s,n)}},t=new WeakMap,e)}}),Do={};it(Do,{Title:()=>Ho});var Ho,oc=I({"lib/title.ts"(){"use strict";var t,e,s,n,i,l;Kt(),ft(),Ho=(l=class{constructor(r,c,a,{temporary:o,decode:h,selfLink:u}={}){N(this,t),N(this,e),N(this,s),N(this,n),N(this,i),qt(this,"valid"),qt(this,"encoded",!1);let d=r.trim().startsWith("../");if(h&&r.includes("%"))try{let p=/%(?!21|3[ce]|5[bd]|7[b-d])[\da-f]{2}/iu.test(r);r=Fe(r),this.encoded=p}catch(p){}if(r=os(r).replace(/[_ ]+/gu," ").trim(),d)F(this,n,0);else{let p=c;r.startsWith(":")&&(p=0,r=r.slice(1).trim());let k=r.split(":");if(k.length>1){let S=ge(k[0]),$=Object.prototype.hasOwnProperty.call(a.nsid,S)&&a.nsid[S];$&&(p=$,r=k.slice(1).join(":").trim())}F(this,n,p)}let g=r.indexOf("#");if(g!==-1){let p=r.slice(g).trim().slice(1);if(p.includes("%"))try{p=Fe(p)}catch(k){}F(this,i,p.replace(/ /gu,"_")),r=r.slice(0,g).trim()}this.valid=!!(r||u&&this.ns===0&&m(this,i)!==void 0)&&os(r)===r&&!/^:|\0\d+[eh!+-]\x7F|[<>[\]{}|\n]|%[\da-f]{2}|(?:^|\/)\.{1,2}(?:$|\/)/iu.test(d?/^(?:\.\.\/)+(.*)/u.exec(r)[1]:r),this.main=r,F(this,e,a.namespaces),F(this,s,a.articlePath||"/wiki/$1"),m(this,s).includes("$1")||F(this,s,m(this,s)+`${m(this,s).endsWith("/")?"":"/"}$1`),o||Object.defineProperties(this,{encoded:{enumerable:!1,writable:!1}})}get ns(){return m(this,n)}get fragment(){return m(this,i)}get main(){return m(this,t)}set main(r){r=r.replace(/_/gu," ").trim(),F(this,t,r&&r[0].toUpperCase()+r.slice(1))}get prefix(){let r=m(this,e)[this.ns];return r+(r&&":")}get title(){return this.getRedirection()[1]}get extension(){let{main:r}=this,c=r.lastIndexOf(".");return c===-1?void 0:r.slice(c+1).toLowerCase()}getRedirection(){return[!1,(this.prefix+this.main).replace(/ /gu,"_")]}setFragment(r){F(this,i,r)}getUrl(r){throw new Error("Title.getUrl method is only available in the LSP version!")}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakMap,l)}}),Go={};it(Go,{default:()=>T}),L.exports=X(Go);var Os,kn,Vo,Jt,Sn,Zo,T,q=I({"index.ts"(){On(),Lt(),Dt(),ft(),lc(),Os=!0,kn=new yn,Jt={config:Us,get rules(){return ls},get i18n(){return wt(wt({},Bn),Vo)},set i18n(t){Vo=t},get lintConfig(){return kn},set lintConfig(t){kn=new yn(t)},get viewOnly(){return Os},set viewOnly(t){Os&&!t&&It.rev++,Os=t},getConfig(t){let e=t!=null?t:this.config,{doubleUnderscore:s,ext:n,parserFunction:i,variable:l}=e;for(let r=0;r<2;r++)s.length>r+2&&s[r].length===0&&(s[r]=Object.keys(s[r+2]));return n.includes("translate")&&!l.includes("translationlanguage")&&(l.push("translationlanguage"),Array.isArray(i[1])?i[1].push("TRANSLATIONLANGUAGE"):i[1].TRANSLATIONLANGUAGE="translationlanguage"),zt(wt(wt({},Us),e),{excludes:[]})},msg(t,e=""){var s;return t&&((s=this.i18n[t])!=null?s:t).replace("$1",this.msg(e))},normalizeTitle(t,e=0,s,n=Jt.getConfig(),i){let{Title:l}=(oc(),X(Do)),r;if(i!=null&&i.halfParsed)r=new l(t,e,n,i);else{let{Token:c}=(z(),X(Ws));r=It.run(()=>{let a=new c(t,n);a.type="root",a.parseOnce(0,s).parseOnce();let o=new l(a.toString(),e,n,i);a.build();for(let h of["main","fragment"]){let u=o[h];if(u!=null&&u.includes("\0")){let d=a.buildFromStr(u,1);h==="main"?o.main=d:o.setFragment(d)}}return o})}return r},parse(t,e,s=St,n=Jt.getConfig()){t=Pn(t);let i;typeof s!="number"&&(i=Array.isArray(s)?s:[s],s=Math.max(...i.map(r=>Ln[r]||St)));let{Token:l}=(z(),X(Ws));return It.run(()=>{let r=new l(t,n);return r.type="root",r.parse(s,e)})},async partialParse(t,e,s,n=Jt.getConfig()){},createLanguageService(t={}){throw new Error("Parser.createLanguageService method is only available in the LSP version!")}},Sn={},Zo=new Set(["lintConfig","normalizeTitle","parse","createLanguageService"]);for(let t in Jt)Zo.has(t)||(Sn[t]={enumerable:!1});Object.defineProperties(Jt,Sn),Object.assign(typeof globalThis=="object"?globalThis:self,{Parser:Jt}),T=Jt}});q()});aa()})()});var ac=sa();ia();var na=["bold-header","format-leakage","table-layout","unknown-page","unclosed-table","unterminated-url","var-anchor"];Parser.lintConfig={fix:!1,rules:{"fostered-content":[1,{transclusion:0}],h1:1,"illegal-attr":[2,{tabindex:1,unknown:2,value:2}],"insecure-style":0,"lonely-apos":[1,{word:0}],"lonely-bracket":[1,{extLink:2,single:0}],"lonely-http":0,"no-arg":0,"no-duplicate":[2,{category:1,id:1,unknownImageParameter:0}],"unmatched-tag":0}};for(let gt of na)Parser.lintConfig.rules[gt]=1;var Ps={},cc=gt=>{Parser.config=gt},uc=()=>Parser.getConfig(),hc=gt=>{let vt={};for(let Tt in gt)Tt.startsWith("codemirror-wikilint-")&&(vt[Tt.slice(20)]=gt[Tt]);Parser.i18n=vt},dc=()=>Parser.i18n,gc=gt=>{Parser.lintConfig=gt},pc=gt=>{if(Ps.wikitext===gt)return Ps.diagnostics;let vt=Parser.parse(gt).lint().map(Tt=>(na.includes(Tt.rule)&&(Tt.severity="info"),Tt));return Ps.wikitext=gt,Ps.diagnostics=vt,vt};ac(cc,uc,pc,hc,dc,gc);})();
