(()=>{var Yo=(ct,xt)=>()=>(xt||ct((xt={exports:{}}).exports,xt),xt.exports);var ea=Yo((pc,ta)=>{ta.exports=(ct,xt,At,ts,js,Ls)=>{self.onmessage=async({data:[Vt,Lt]})=>{switch(Vt){case"setConfig":ct(Lt);break;case"getConfig":postMessage([Vt,xt()]);break;case"setI18N":ts(Lt);break;case"getI18N":postMessage([Vt,js()]);break;case"setLintConfig":Ls(Lt);break;case"lint":postMessage([Vt,await At(Lt),Lt])}}}});var sa=Yo(()=>{"use strict";(()=>{var ct=Object.defineProperty,xt=Object.defineProperties,At=Object.getOwnPropertyDescriptors,ts=Object.getOwnPropertySymbols,js=Object.prototype.hasOwnProperty,Ls=Object.prototype.propertyIsEnumerable,Vt=z=>{throw TypeError(z)},Lt=(z,L,X)=>L in z?ct(z,L,{enumerable:!0,configurable:!0,writable:!0,value:X}):z[L]=X,ft=(z,L)=>{for(var X in L||(L={}))js.call(L,X)&&Lt(z,X,L[X]);if(ts)for(var X of ts(L))Ls.call(L,X)&&Lt(z,X,L[X]);return z},Mt=(z,L)=>xt(z,At(L)),na=(z,L)=>()=>(L||z((L={exports:{}}).exports,L),L.exports),Et=(z,L,X)=>Lt(z,typeof L!="symbol"?L+"":L,X),Ms=(z,L,X)=>L.has(z)||Vt("Cannot "+X),f=(z,L,X)=>(Ms(z,L,"read from private field"),X?X.call(z):L.get(z)),T=(z,L,X)=>L.has(z)?Vt("Cannot add the same private member more than once"):L instanceof WeakSet?L.add(z):L.set(z,X),N=(z,L,X,$t)=>(Ms(z,L,"write to private field"),$t?$t.call(z,X):L.set(z,X),X),M=(z,L,X)=>(Ms(z,L,"access private method"),X),ra=(z,L,X,$t)=>({set _(es){N(z,L,es,X)},get _(){return f(z,L,$t)}}),la=na((z,L)=>{var X=Object.create,$t=Object.defineProperty,es=Object.getOwnPropertyDescriptor,Os=Object.getOwnPropertyNames,oa=Object.prototype.hasOwnProperty,Nn=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),le=t=>{throw TypeError(t)},Fn=(t,e,s)=>e in t?$t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,Wn=(t,e)=>$t(t,"name",{value:e,configurable:!0}),$=(t,e)=>function(){return t&&(e=(0,t[Os(t)[0]])(t=0)),e},jn=(t,e)=>function(){return e||(0,t[Os(t)[0]])((e={exports:{}}).exports,e),e.exports},st=(t,e)=>{for(var s in e)$t(t,s,{get:e[s],enumerable:!0})},aa=(t,e,s,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Os(e))!oa.call(t,i)&&i!==s&&$t(t,i,{get:()=>e[i],enumerable:!(n=es(e,i))||n.enumerable});return t},Z=t=>aa($t({},"__esModule",{value:!0}),t),tt=t=>{var e;return[,,,X((e=t==null?void 0:t[Nn("metadata")])!=null?e:null)]},Ln=["class","method","getter","setter","accessor","field","value","get","set"],$e=t=>t!==void 0&&typeof t!="function"?le("Function expected"):t,ca=(t,e,s,n,i)=>({kind:Ln[t],name:e,metadata:n,addInitializer:l=>s._?le("Already initialized"):i.push($e(l||null))}),Ps=(t,e)=>Fn(e,Nn("metadata"),t[3]),J=(t,e,s,n)=>{for(var i=0,l=t[e>>1],r=l&&l.length;i<r;i++)e&1?l[i].call(s):n=l[i].call(s,n);return n},Q=(t,e,s,n,i,l)=>{var r,o,a,c,h,u=e&7,d=!!(e&8),g=!!(e&16),p=u>3?t.length+1:u?d?1:2:0,x=Ln[u+5],b=u>3&&(t[p-1]=[]),m=t[p]||(t[p]=[]),w=u&&(!g&&!d&&(i=i.prototype),u<5&&(u>3||!g)&&es(u<4?i:{get[s](){return ut(this,l)},set[s](S){return vt(this,l,S)}},s));u?g&&u<4&&Wn(l,(u>2?"set ":u>1?"get ":"")+s):Wn(i,s);for(var k=n.length-1;k>=0;k--)c=ca(u,s,a={},t[3],m),u&&(c.static=d,c.private=g,h=c.access={has:g?S=>ha(i,S):S=>s in S},u^3&&(h.get=g?S=>(u^1?ut:Es)(S,i,u^4?l:w.get):S=>S[s]),u>2&&(h.set=g?(S,v)=>vt(S,i,v,u^4?l:w.set):(S,v)=>S[s]=v)),o=(0,n[k])(u?u<4?g?l:w[x]:u>4?void 0:{get:w.get,set:w.set}:i,c),a._=1,u^4||o===void 0?$e(o)&&(u>4?b.unshift(o):u?g?l=o:w[x]=o:i=o):typeof o!="object"||o===null?le("Object expected"):($e(r=o.get)&&(w.get=r),$e(r=o.set)&&(w.set=r),$e(r=o.init)&&b.unshift(r));return u||Ps(t,i),w&&$t(i,s,w),g?u^4?l:w:i},ua=(t,e,s)=>Fn(t,typeof e!="symbol"?e+"":e,s),Rs=(t,e,s)=>e.has(t)||le("Cannot "+s),ha=(t,e)=>Object(e)!==e?le('Cannot use the "in" operator on this value'):t.has(e),ut=(t,e,s)=>(Rs(t,e,"read from private field"),s?s.call(t):e.get(t)),_t=(t,e,s)=>e.has(t)?le("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),vt=(t,e,s,n)=>(Rs(t,e,"write to private field"),n?n.call(t,s):e.set(t,s),s),Es=(t,e,s)=>(Rs(t,e,"access private method"),s),da=(t,e,s,n)=>({set _(i){vt(t,e,i,s)},get _(){return ut(t,e,n)}}),Mn,_s,On=$({"base.ts"(){"use strict";Mn=(()=>{let t={redirect:1,onlyinclude:1,noinclude:1,include:1,comment:1,ext:1,arg:2,"magic-word":2,template:2,heading:2,html:3,table:4,hr:5,"double-underscore":5,link:6,category:6,file:6,quote:7,"ext-link":8,"free-ext-link":9,"magic-link":9,list:10,dd:10,converter:11,"list-range":11};return Object.setPrototypeOf(t,null),t})(),_s=(()=>{let t=["bold-header","format-leakage","fostered-content","h1","illegal-attr","insecure-style","invalid-gallery","invalid-imagemap","invalid-invoke","invalid-isbn","lonely-apos","lonely-bracket","lonely-http","nested-link","no-arg","no-duplicate","no-ignored","obsolete-attr","obsolete-tag","parsing-order","pipe-like","table-layout","tag-like","unbalanced-header","unclosed-comment","unclosed-quote","unclosed-table","unescaped","unknown-page","unmatched-tag","unterminated-url","url-encoding","var-anchor","void-ext"];return Object.freeze(t),t})()}});function wt(t,e,s){return s===1?t.replace(/\0(\d+)g\x7F/gu,(n,i)=>wt(String(e[i]),e,2)):s===2?t.replace(/\0(\d+)n\x7F/gu,(n,i)=>String(e[i])):t.replace(/\0(\d+)\x7F/gu,(n,i)=>e[i])}var qt,qs,oe,ae,ce,ue,Pn,yt,Xt,Rn,En,Ce,_n,qn,zn,Ie,he,ht=$({"util/string.ts"(){"use strict";qt=String.raw` \xA0\u1680\u2000-\u200A\u202F\u205F\u3000`,qs=String.raw`[^[\]<>"\0-\x1F\x7F${qt}\uFFFD]`,oe=String.raw`(?:\[[\da-f:.]+\]|${qs})`,ae=String.raw`(?:${qs}|\0\d+[cn!~]\x7F)*`,ce=t=>t.trim().toLowerCase(),ue=(t,e)=>s=>s.replace(t,e),Pn=ue(/[\0\x7F]|\r$/gmu,""),yt=ue(/\0\d+[cn]\x7F/gu,""),Xt=(t,e="")=>t.map(s=>typeof s=="string"?s:s.text()).join(e),Rn={lt:"<",gt:">",lbrack:"[",rbrack:"]",lbrace:"{",rbrace:"}",nbsp:" ",amp:"&",quot:'"'},En=ue(/&(?:#(\d+|[Xx][\da-fA-F]+)|([lg]t|[LG]T|[lr]brac[ke]|nbsp|amp|AMP|quot|QUOT));/gu,(t,e,s)=>e?String.fromCodePoint(+((/^x/iu.test(e)?"0":"")+e)):Rn[s.toLowerCase()]),Ce=t=>En(t),_n=ue(/&#(\d+|x[\da-f]+);/giu,(t,e)=>String.fromCodePoint(+((/^x/iu.test(e)?"0":"")+e))),qn={"&":"amp","<":"lt",">":"gt",'"':"quot","\n":"#10"},zn=t=>ue(t,e=>`&${qn[e]};`),Ie=zn(/[&<>]/gu),he=(t,e={})=>{let{pre:s="",post:n="",sep:i=""}=e;return s+t.map(l=>l.print()).join(i)+n}}}),ga=jn({"i18n/en.json"(t,e){e.exports={"attributes-of-closing-tag":"attributes of a closing tag","bold-apostrophes":"bold apostrophes","bold-in-header":"bold in section header",close:null,"closing-and-self-closing":"tag that is both closing and self-closing",comment:null,"conflicting-image-parameter":"conflicting image $1 parameter","content-outside-table":"content to be moved outside the table",decode:null,delink:null,"duplicate-attribute":"duplicate $1 attribute","duplicate-category":"duplicate category","duplicate-id":"duplicate id","duplicate-image-parameter":"duplicate image $1 parameter","duplicate-parameter":"duplicate parameter",encode:null,escape:null,expand:null,"ext-in-html":"extension tag in HTML tag attributes",frame:null,"full-width-punctuation":"full-width punctuation","header-in-html":"section header in HTML tag attributes","horizontal-alignment":null,"html-comment":"HTML comment","html-in-table":"HTML tag in table attributes","illegal-attribute-name":"illegal attribute name","illegal-attribute-value":"illegal attribute value","illegal-module":"illegal module name","imagemap-without-image":"<imagemap> without an image","in-url":"$1 in URL","inconsistent-table":"inconsistent table layout","insecure-style":"insecure style","invalid-attribute":"containing invalid attribute","invalid-content":"invalid content in <$1>","invalid-conversion-flag":"invalid conversion flag","invalid-gallery":"invalid gallery image","invalid-image-parameter":"invalid image parameter","invalid-imagemap-link":"invalid link in <imagemap>","invalid-isbn":"invalid ISBN","invalid-parameter":"invalid parameter of <$1>","invalid-self-closing":"invalid self-closing tag","invisible-triple-braces":"invisible content inside triple braces","italic-apostrophes":"italic apostrophes","left-bracket":"left bracket","link-in-extlink":"internal link in an external link",lonely:'lonely "$1"',"missing-function":"missing module function",newline:null,"no-self-closing":"no self-closing","nonzero-tabindex":"nonzero tabindex","nothing-in":"nothing should be in <$1>","obsolete-attribute":"obsolete attribute","obsolete-tag":"obsolete HTML tag",open:null,prefix:null,"pipe-in-link":'additional "|" in the link text',"pipe-in-table":'additional "|" in a table cell',quotes:null,remove:null,table:null,"template-in-link":"template in an internal link target","unbalanced-in-section-header":"unbalanced $1 in a section header",unclosed:"unclosed $1","unclosed-tag":"unclosed tag","unescaped-query":"unescaped query string in an anonymous parameter","unexpected-argument":"unexpected template argument","unmatched-closing":"unmatched closing tag","unnecessary-encoding":"unnecessary URL encoding in an internal link",uppercase:null,"useless-attribute":"useless attribute","useless-fragment":"useless fragment","useless-link-text":"useless link text","variable-anchor":"variable anchor in a section header","vertical-alignment":null,whitespace:null}}}),pa=jn({"config/minimum.json"(t,e){e.exports={ext:[],html:[["b","bdi","del","i","ins","u","font","big","small","sub","sup","h1","h2","h3","h4","h5","h6","cite","code","em","s","strike","strong","tt","var","div","center","blockquote","ol","ul","dl","table","caption","pre","ruby","rb","rp","rt","rtc","p","span","abbr","dfn","kbd","samp","data","time","mark","tr","td","th","q","bdo"],["li","dt","dd"],["br","wbr","hr","meta","link"]],namespaces:{0:"",6:"File",10:"Template",14:"Category",828:"Module"},nsid:{"":0,file:6,template:10,category:14,module:828},functionHook:["msgnw"],variable:["!","=","pageid","articlepath","server","servername","scriptpath","stylepath"],parserFunction:[{msgnw:"msgnw",pageid:"pageid",articlepath:"articlepath",server:"server",servername:"servername",scriptpath:"scriptpath",stylepath:"stylepath","#language":"language","#special":"special","#speciale":"speciale","#tag":"tag","#formatdate":"formatdate","#dateformat":"formatdate","#invoke":"invoke","#while":"while","#dowhile":"dowhile","#loop":"loop","#forargs":"forargs","#fornumargs":"fornumargs","#if":"if","#ifeq":"ifeq","#switch":"switch","#ifexist":"ifexist","#ifexpr":"ifexpr","#iferror":"iferror","#time":"time","#timel":"timel","#expr":"expr","#rel2abs":"rel2abs","#titleparts":"titleparts","#categorytree":"categorytree","#urldecode":"urldecode","#choose":"choose","#var":"var","#varexists":"varexists","#var_final":"var_final","#vardefine":"vardefine","#vardefineecho":"vardefineecho","#widget":"widget","#related":"related","#regex":"regex","#regex_var":"regex_var","#regexquote":"regexquote","#regexall":"regexall","#len":"len","#pos":"pos","#rpos":"rpos","#sub":"sub","#count":"count","#rmatch":"rmatch","#rreplace":"rreplace","#replace":"replace","#rsplit":"rsplit","#explode":"explode","#tab":"tab","#seo":"seo","#babel":"babel","#translation":"translation","#commaseparatedlist":"commaseparatedlist","#coordinates":"coordinates","#lst":"lst","#lsth":"lsth","#lstx":"lstx","#assessment":"assessment","#mentor":"mentor","#property":"property","#target":"target","#section":"lst","#section-x":"lstx","#section-h":"lsth","#statements":"statements","#useliquidthreads":"useliquidthreads","#lqtpagelimit":"lqtpagelimit","#avatar":"avatar","#img":"img","#chart":"chart"},{"!":"!","=":"=","#FORMAL":"formal","#bcp47":"bcp47","#dir":"dir","#interwikilink":"interwikilink","#interlanguagelink":"interlanguagelink","#timef":"timef","#timefl":"timefl"},["msg","raw"],["subst","safesubst"]],doubleUnderscore:[[],[]],protocol:"bitcoin:|ftp://|ftps://|geo:|git://|gopher://|http://|https://|irc://|ircs://|magnet:|mailto:|matrix:|mms://|news:|nntp://|redis://|sftp://|sip:|sips:|sms:|ssh://|svn://|tel:|telnet://|urn:|wikipedia://|worldwind://|xmpp:",interwiki:[],img:{},redirection:["#redirect"],variants:[]}}}),St,Un,zs,Zt=$({"util/constants.ts"(){"use strict";St=11,Un=ga(),zs=pa()}});function de(t){let e=new Map,s=new WeakMap;return n=>{let i=typeof n=="string"?e:s;if(i.has(n)){let r=i.get(n);return r.lastIndex=0,r}let l=t(n);return i.set(n,l),l}}var Te,Bn,Jt=$({"../common/dist/index.mjs"(){"use strict";Te=t=>decodeURIComponent(t.replace(/%(?![\da-f]{2})/giu,"%25")),Bn=de}}),nt,ot=$({"lib/rect.ts"(){"use strict";var t,e,s,n,i,l;nt=(l=class{constructor(r,o){T(this,n),T(this,t),T(this,e),T(this,s),N(this,t,r),N(this,e,o)}get start(){return f(this,e)}get top(){return M(this,n,i).call(this).top}get left(){return M(this,n,i).call(this).left}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakSet,i=function(){var r;return(r=f(this,s))!=null||N(this,s,f(this,t).getRootNode().posFromIndex(f(this,e))),f(this,s)},l)}}),Hn,Dn,Ne,Us,Bs,R,K,Ct,ss,G,Hs,zt,Ds,Gs,Vs,Fe,ge,Xs,Qt,Gn,B=$({"util/lint.ts"(){"use strict";Jt(),jt(),ot(),_(),Hn=new Set(["tr","td","th","caption"]),Dn=new Set(["Template:!!","Template:!-"]),Ne=t=>{let e=t.childNodes.find(s=>s.text().trim());if(!e||e.type==="text"&&e.data.trim().startsWith("!")||e.is("magic-word")&&e.name==="!"||e.is("template")&&Dn.has(e.name)||e.is("html")&&Hn.has(e.name))return!1;if(e.is("arg"))return e.length>1&&Ne(e.childNodes[1]);if(e.is("magic-word"))try{let s=e.getPossibleValues().map(Ne);return s.includes(2)?2:s.includes(1)&&1}catch(s){}return e.is("template")||e.is("magic-word")&&e.name==="invoke"?1:2},Us=(t,e,s,n)=>({line:t+s-1,character:(s===1?e:0)+n}),Bs=t=>(e,s,n,i,l="error")=>{let{start:r}=s,{top:o,left:a}=s instanceof nt?s:new nt(e,r),{offsetHeight:c,offsetWidth:h}=e,{startIndex:u,startLine:d,startCol:g}=t(e,r,o,a),{line:p,character:x}=Us(d,g,c,h);return{rule:n,message:A.msg(i),severity:l,startIndex:u,endIndex:u+e.toString().length,startLine:d,endLine:p,startCol:g,endCol:x}},R=Bs((t,e,s,n)=>{let i=t.getRelativeIndex(),{top:l,left:r}=t.parentNode.posFromIndex(i);return{startIndex:e+i,startLine:s+l,startCol:l?r:n+r}}),K=Bs((t,e,s,n)=>({startIndex:e,startLine:s,startCol:n})),Ct=(t,e,s,n=0)=>({desc:A.msg(e),range:[t.startIndex+n,t.endIndex],text:s}),ss=(t,e,s)=>({desc:A.msg(e),range:[t,t],text:s}),G=(t,e=0,s="")=>typeof t=="number"?{desc:A.msg("remove"),range:[t,t+e],text:s}:Ct(t,"remove",s,e),Hs=(t,e)=>Ct(t,"decode",Te(e.text().replace(/%(?=21|3[ce]|5[bd]|7[b-d])/giu,"%25"))),zt=(t,e,s=0)=>({desc:A.msg("close"),range:[t+s,t],text:e}),Ds=t=>({desc:A.msg("open"),range:[t+1,t+2],text:""}),Gs=(t,e)=>Ct(t,"comment",`<!--${e}-->`),Vs=(t,e)=>Ct(t,"uppercase",e.toUpperCase()),Fe=(t,e=0)=>({desc:A.msg("whitespace"),range:[t,t+e],text:" "}),ge=(t,e,s=1)=>({desc:A.msg("escape"),range:[t,t+s],text:e.repeat(s)}),Xs=(t,e)=>({desc:A.msg("escape"),range:[t,t+e.length],text:e.replace(/\|/gu,"&#124;")}),Qt=(t,e,s,n)=>{if(t&&(n||A.viewOnly&&t[0]===kt.rev))return t[1];let i=e();return(n||A.viewOnly)&&s([kt.rev,i]),i},Gn=(t,e)=>t==="ol"&&e==="type"?["1","a","A","i","I"]:t==="th"&&e==="scope"?["row","col","rowgroup","colgroup"]:e==="dir"?["ltr","rtl","auto"]:e==="aria-hidden"?["true","false"]:[]}}),Vn,Zs,Xn=$({"parser/selector.ts"(){"use strict";Vn=(t,e,s)=>{if(t.includes("#")){let n=t.indexOf("#");return(n===0||t.slice(0,n)===e)&&t.slice(n+1)===s}return!t||t===e},Zs=(t,e,s)=>{let n=t.split(",");return({type:i,name:l})=>n.some(r=>Vn(r.trim(),i,l))}}}),is,Js=$({"mixin/cached.ts"(){"use strict";B(),is=(t=!0)=>e=>{let s=new WeakMap;return function(...n){return Qt(s.get(this),()=>e.apply(this,n),i=>{s.set(this,i)},t)}}}}),Zn,fa=$({"mixin/nodeLike.ts"(){"use strict";Zn=t=>{class e extends t{get firstChild(){return this.childNodes[0]}get lastChild(){return this.childNodes[this.childNodes.length-1]}get offsetHeight(){return this.getDimension().height}get offsetWidth(){return this.getDimension().width}}return e}}}),Jn,Qn,ns,We,je,rs,Le,Me,Oe,Kt,Kn=$({"lib/node.ts"(){"use strict";B(),jt(),Js(),fa(),_(),Qn=[Zn],Jn=[is(!1)],Kt=class{constructor(){J(Oe,5,this),ua(this,"childNodes",[]),_t(this,ns),_t(this,We),_t(this,je),_t(this,rs),_t(this,Le),_t(this,Me,{})}get parentNode(){return ut(this,ns)}get nextSibling(){return ut(this,We)}get previousSibling(){return ut(this,je)}getChildNodes(){let{childNodes:t}=this;return Object.isFrozen(t)?[...t]:t}getAttribute(t){return t==="padding"?0:this[t]}setAttribute(t,e){switch(t){case"parentNode":vt(this,ns,e),e||(vt(this,We,void 0),vt(this,je,void 0));break;case"nextSibling":vt(this,We,e);break;case"previousSibling":vt(this,je,e);break;case"aIndex":A.viewOnly&&vt(this,Le,[kt.rev,e]);break;default:this[t]=e}}getRootNode(){return Qt(ut(this,rs),()=>{var t,e;return(e=(t=this.parentNode)==null?void 0:t.getRootNode())!=null?e:this},t=>{let[,e]=t;e.type==="root"&&vt(this,rs,t)})}indexFromPos(t,e){this.lspError("AstNode.indexFromPos")}posFromIndex(t){let{length:e}=String(this);if(t+=t<0?e:0,t>=0&&t<=e){let s=this.getLines(),n=s.findIndex(([,,i])=>t<=i);return{top:n,left:t-s[n][1]}}}getDimension(){let t=this.getLines(),e=t[t.length-1];return{height:t.length,width:e[2]-e[1]}}getGaps(t){return 0}getRelativeIndex(t){if(t===void 0){let{parentNode:e}=this;return e?e.getRelativeIndex(e.childNodes.indexOf(this)):0}return Qt(ut(this,Me)[t],()=>{let{childNodes:e}=this,s=t+(t<0?e.length:0),n=this.getAttribute("padding");for(let i=0;i<s;i++)A.viewOnly&&(ut(this,Me)[i]=[kt.rev,n]),n+=e[i].toString().length+this.getGaps(i);return n},e=>{ut(this,Me)[t]=e})}getAbsoluteIndex(){return Qt(ut(this,Le),()=>{let{parentNode:t}=this;return t?t.getAbsoluteIndex()+this.getRelativeIndex():0},t=>{vt(this,Le,t)})}getBoundingClientRect(){this.lspError("AstNode.getBoundingClientRect")}is(t){return this.type===t}getLines(){let t=[],e=0;for(let s of String(this).split(`
`)){let n=e+s.length;t.push([s,e,n]),e=n+1}return t}seal(t,e){let s=!e&&!!this[t];Object.defineProperty(this,t,{enumerable:s,configurable:!0})}lspError(t){throw new Error(`${t} method is only available in the LSP version!`)}},Oe=tt(null),ns=new WeakMap,We=new WeakMap,je=new WeakMap,rs=new WeakMap,Le=new WeakMap,Me=new WeakMap,Q(Oe,1,"getLines",Jn,Kt),Kt=Q(Oe,0,"AstNode",Qn,Kt),J(Oe,1,Kt)}}),Yn,ma=$({"mixin/elementLike.ts"(){"use strict";Xn(),Yn=t=>{var e,s;class n extends t{constructor(){super(...arguments),T(this,e)}getElementBy(l){for(let r of this.childNodes){if(r.type==="text")continue;if(l(r))return r;let o=r.getElementBy(l);if(o)return o}}querySelector(l){return this.getElementBy(M(this,e,s).call(this,l))}getElementsBy(l,r=[]){for(let o of this.childNodes)o.type!=="text"&&(l(o)&&r.push(o),o.getElementsBy(l,r));return r}querySelectorAll(l){return this.getElementsBy(M(this,e,s).call(this,l))}escape(){}}return e=new WeakSet,s=function(i){return Zs(i,this)},n}}}),tr,Qs,er,Pe,xa=$({"lib/element.ts"(){"use strict";ht(),jt(),Xn(),Kn(),ma(),tr=[Yn],Pe=class extends(er=Kt){get length(){return this.childNodes.length}text(t){return Xt(this.childNodes,t)}normalize(){let t=this.getChildNodes(),e=s=>{var n,i;t.splice(s,1),(n=t[s-1])==null||n.setAttribute("nextSibling",t[s]),(i=t[s])==null||i.setAttribute("previousSibling",t[s-1])};for(let s=t.length-1;s>=0;s--){let{type:n,data:i}=t[s];n!=="text"||t.length===1||this.getGaps(s-(s&&1))||i===""&&e(s)}this.setAttribute("childNodes",t)}removeAt(t){this.lspError("AstElement.removeAt")}insertAt(t,e=this.length){return xn(this,e,0,[t]),t}closest(t){let e=Zs(t,this),{parentNode:s}=this;for(;s;){if(e(s))return s;({parentNode:s}=s)}}append(...t){this.safeAppend(t)}safeAppend(t){for(let e of t)this.insertAt(e)}safeReplaceChildren(t){}setText(t,e=0){e+=e<0?this.length:0;let s=this.childNodes[e],{data:n}=s;return s.replaceData(t),n}toString(t,e=""){return this.childNodes.map(s=>s.toString(t)).join(e)}caretPositionFromIndex(t){this.lspError("AstElement.caretPositionFromIndex")}elementFromIndex(t){this.lspError("AstElement.elementFromIndex")}elementFromPoint(t,e){this.lspError("AstElement.elementFromPoint")}lint(t=this.getAbsoluteIndex(),e){let s=[];for(let n=0,i=t+this.getAttribute("padding");n<this.length;n++){let l=this.childNodes[n];l.setAttribute("aIndex",i);let r=l.lint(i,e);r.length>0&&s.push(...r),i+=l.toString().length+this.getGaps(n)}return s}print(t={}){let e=t.class;return this.toString()?(e===""?"":`<span class="wpb-${e!=null?e:this.type}${this.getAttribute("invalid")?" wpb-invalid":""}">`)+he(this.childNodes,t)+(e===""?"":"</span>"):""}json(t,e=this.getAbsoluteIndex()){let s=Mt(ft({},this),{type:this.type,range:[e,e+this.toString().length],childNodes:[]});for(let n=0,i=e+this.getAttribute("padding");n<this.length;n++){let l=this.childNodes[n],{length:r}=l.toString();l.setAttribute("aIndex",i),s.childNodes.push(l.type==="text"?{data:l.data,range:[i,i+r]}:l.json(void 0,i)),i+=r+this.getGaps(n)}return s}},Qs=tt(er),Pe=Q(Qs,0,"AstElement",tr,Pe),J(Qs,1,Pe)}}),ls,Ks,Ys,sr,ir,nr,rr,ti,ei,si,ba=$({"lib/text.ts"(){"use strict";var t,e,s;ht(),B(),_(),Kn(),ls=String.raw`[${qt}\t]*`,Ks=String.raw`[^\S\n]*`,Ys=String.raw`<${Ks}(?:/${Ks})?([a-z]\w*)|\{+|\}+|\[{2,}|\[(?![^[]*?\])|((?:^|\])[^[]*?)\]+|(?:rfc|pmid)(?=[-:：]?${ls}\d)|isbn(?=[-:：]?${ls}(?:\d(?:${ls}|-)){6})`,sr=new RegExp(String.raw`${Ys}|https?[:/]/+`,"giu"),ir=new RegExp(Ys,"giu"),nr=new Set(["attr-value","ext-link-text","link-text"]),rr={"[":/[[\]]/u,"{":/[{}]/u,"]":/[[\]](?=[^[\]]*$)/u,"}":/[{}](?=[^{}]*$)/u},ti=new Set(["html","head","style","title","body","a","audio","img","video","embed","iframe","object","canvas","script","col","colgroup","tbody","tfoot","thead","button","input","label","option","select","textarea"]);try{ei=new RegExp(String.raw`[\p{L}\p{N}_]`,"u")}catch(n){ei=/\w/u}si=(s=class extends Kt{constructor(n){super(),T(this,t),Et(this,"data",""),this.data=n}get type(){return"text"}toString(n){var i;return n&&!((i=this.parentNode)!=null&&i.getAttribute("built"))?yt(this.data):this.data}text(){return this.data}lint(n=this.getAbsoluteIndex(),i){var l,r,o;if(i===!1)return[];let{data:a,parentNode:c,nextSibling:h,previousSibling:u}=this;if(!c)throw new Error("An isolated text node cannot be linted!");let{type:d,name:g,parentNode:p}=c;if(d==="attr-value"){let{name:O,tag:V}=p;if(V==="ref"&&(O==="name"||O==="follow")||O==="group"&&(V==="ref"||V==="references")||V==="choose"&&(O==="before"||O==="after"))return[]}if(i!=null||(i=d==="free-ext-link"||d==="ext-link-url"||d==="ext-link-text"||d==="image-parameter"&&g==="link"||d==="attr-value"?ir:sr),a.search(i)===-1)return[];i.lastIndex=0;let x=[],b=h==null?void 0:h.type,m=h==null?void 0:h.name,w=u==null?void 0:u.type,k=this.getRootNode(),S=k.toString(),{ext:v,html:y,variants:C}=k.getAttribute("config"),{top:I,left:D}=k.posFromIndex(n),P=A.lintConfig["tag-like"],q=typeof P=="number"?new Set:new Set(Object.keys(P[1]).filter(O=>O!=="invalid"&&O!=="disallowed")),U=new Set(["onlyinclude","noinclude","includeonly",...v,...y[0],...y[1],...y[2],...q,...ti]);for(let O=i.exec(a);O;O=i.exec(a)){let[,V,lt]=O,{index:et,0:j}=O;if(lt&&lt!=="]"){let{length:pt}=lt;et+=pt,j=j.slice(pt)}j=j.toLowerCase();let[F]=j,H=F==="r"||F==="p"||F==="i",Y=F==="{",gt=F==="}",rt=F==="[",at=F==="]",{length:Ft}=j;if(F==="<"&&!U.has(V.toLowerCase())||rt&&d==="ext-link-text"&&(/&(?:rbrack|#93|#x5[Dd];);/u.test(a.slice(et+1))||h!=null&&h.is("ext")&&m==="nowiki"&&(l=h.innerText)!=null&&l.includes("]"))||H&&(!c.isPlain()||nr.has(d)))continue;at&&(et||Ft>1)&&i.lastIndex--;let ke=n+et,Fs=ke+Ft,bt,Rt,Ae=S[Fs],An=S[ke-1],$n=Y||rt,Cn=Y&&An==="-"&&C.length>0,In=gt&&Ae==="-"&&C.length>0,Xo=rt&&b==="free-ext-link"&&!a.slice(et+1).trim()||at&&w==="free-ext-link"&&!a.slice(0,et).includes("]");if(H)bt="lonely-http",j=j.toUpperCase(),Rt=A.lintConfig.getSeverity(bt,j);else if(F==="<"){bt="tag-like";let pt;/^<\/?\s/u.test(j)||!/[\s/>]/u.test(Ae!=null?Ae:"")?pt="invalid":q.has(V)?pt=V:ti.has(V)&&!v.includes(V)&&(pt="disallowed"),Rt=A.lintConfig.getSeverity(bt,pt)}else if(Cn||In)bt="lonely-bracket",Rt=A.lintConfig.getSeverity(bt,"converter"),Cn&&et>0?(j="-{",et--,ke--,Ft=2):In&&et<a.length-1&&(j="}-",Fs++,Ft=2);else if(Xo)bt="lonely-bracket",Rt=A.lintConfig.getSeverity(bt,"extLink");else if($n||gt||at)if(bt="lonely-bracket",Ft>1||Y&&Ae===F||gt&&An===F)Rt=A.lintConfig.getSeverity(bt,"double");else{if(!rt||d!=="ext-link-text"){let pt=rr[F],Tn=$n?a.slice(et+1):a.slice(0,et);if(Y&&((r=pt.exec(Tn))==null?void 0:r[0])==="}"||gt&&((o=pt.exec(Tn))==null?void 0:o[0])==="{")continue;if(!Tn.includes(F)){let Ko=$n?"nextSibling":"previousSibling",re=this[Ko];for(;re&&(re.type!=="text"||!pt.test(re.data));)re=re[Ko];if(re&&pt.exec(re.data)[0]!==F)continue}}Rt=A.lintConfig.getSeverity(bt,"single")}else bt="lonely-http",Rt=A.lintConfig.getSeverity(bt);if(!Rt)continue;let Zo=this.posFromIndex(et),{line:Jo,character:Qo}=Us(I,D,Zo.top+1,Zo.left),ne={rule:bt,message:A.msg("lonely",H||F==="h"||Cn||In?j:F),severity:Rt,startIndex:ke,endIndex:Fs,startLine:Jo,endLine:Jo,startCol:Qo,endCol:Qo+Ft};if(F==="<")ne.suggestions=[ge(ke,"&lt;")];else if(F==="h"&&d!=="link-text"&&ei.test(An||""))ne.suggestions=[Fe(ke)];else if(rt&&d==="ext-link-text"){let pt=c.getAbsoluteIndex()+c.toString().length;ne.suggestions=[ge(pt,"&#93;")]}else if(at&&Xo){let pt=n-u.toString().length;ne.suggestions=[ss(pt,"left-bracket","[")]}else H&&(ne.suggestions=[...O[0]===j?[]:[Vs(ne,j)],...Ae===":"||Ae==="："?[Fe(Fs,1)]:[]]);x.push(ne)}return x}replaceData(n){M(this,t,e).call(this,n)}splitText(n){this.lspError("AstText.splitText")}escape(){}print(){return Ie(this.data)}},t=new WeakSet,e=function(n){this.setAttribute("data",n)},s)}}),Yt,pe=$({"mixin/hidden.ts"(){"use strict";Yt=(t=!0,e=!0)=>s=>{class n extends s{text(){return""}lint(l){return t?[]:super.lint(l)}}return n}}}),Wt,Ot=$({"mixin/noEscape.ts"(){"use strict";Wt=t=>{class e extends t{escape(){}}return e}}}),te,fe=$({"src/syntax.ts"(){"use strict";var t,e;E(),te=(e=class extends W{constructor(s,n,i,l,r){super(s,i,l,r),T(this,t),N(this,t,n)}get type(){return f(this,t)}lint(s=this.getAbsoluteIndex()){return super.lint(s,!1)}},t=new WeakMap,e)}}),Pt,Ut=$({"mixin/padded.ts"(){"use strict";Pt=({length:t})=>e=>{class s extends e{getAttribute(i){return i==="padding"?t:super.getAttribute(i)}}return s}}}),mt,Bt=$({"src/atom.ts"(){"use strict";var t,e;E(),mt=(e=class extends W{constructor(s,n,i,l,r){super(s,i,l,r),T(this,t),N(this,t,n)}get type(){return f(this,t)}set type(s){N(this,t,s)}getAttribute(s){var n;return s==="invalid"?this.type==="converter-flag"&&!!((n=this.parentNode)!=null&&n.isInvalidFlag(this)):super.getAttribute(s)}},t=new WeakMap,e)}}),lr,or,ii,ar,Ht,os=$({"src/link/base.ts"(){"use strict";var t,e,s,n;B(),Zt(),ot(),Ut(),Ot(),_(),E(),Bt(),lr=i=>i==="redirect-target"||i==="link",or=[Wt,Pt("[[")],Ht=(n=class extends(ar=W){constructor(i,l,r,o=[],a="|"){if(super(void 0,r,o,{}),T(this,t,!0),T(this,e),T(this,s),this.insertAt(new mt(i,"link-target",r,o,{})),l!==void 0){let c=new W(l,r,o,{});c.type="link-text",c.setAttribute("stage",St-1),this.insertAt(c)}N(this,e,a)}get link(){}get fragment(){return f(this,s).fragment}afterBuild(){N(this,s,this.getTitle()),f(this,e).includes("\0")&&N(this,e,this.buildFromStr(f(this,e),0)),this.setAttribute("name",f(this,s).title),super.afterBuild()}setAttribute(i,l){i==="bracket"?N(this,t,l):i==="title"?N(this,s,l):super.setAttribute(i,l)}toString(i){let l=super.toString(i,f(this,e));return f(this,t)?`[[${l}]]`:l}text(){let i=super.text("|");return f(this,t)?`[[${i}]]`:i}getAttribute(i){return i==="title"?f(this,s):super.getAttribute(i)}getGaps(i){return i===0?f(this,e).length:1}lint(i=this.getAbsoluteIndex(),l){let r=super.lint(i,l),{childNodes:[o,a],type:c}=this,{encoded:h,fragment:u}=f(this,s),d=new nt(this,i),g="unknown-page",p=A.lintConfig.getSeverity(g);if(p&&o.childNodes.some(({type:x})=>x==="template")&&r.push(R(o,d,g,"template-in-link",p)),g="url-encoding",p=A.lintConfig.getSeverity(g),p&&h){let x=R(o,d,g,"unnecessary-encoding",p);x.fix=Hs(x,o),r.push(x)}if(g="pipe-like",p=A.lintConfig.getSeverity(g,"link"),p&&(c==="link"||c==="category")){let x=a==null?void 0:a.childNodes.findIndex(m=>m.type==="text"&&m.data.includes("|")),b=a==null?void 0:a.childNodes[x];if(b){let m=R(a,d,g,"pipe-in-link",p),w=m.startIndex+a.getRelativeIndex(x);m.suggestions=[Xs(w,b.data)],r.push(m)}}if(g="no-ignored",p=A.lintConfig.getSeverity(g,"fragment"),p&&u!==void 0&&!lr(c)){let x=R(o,d,g,"useless-fragment",p),b=o.childNodes.findIndex(w=>w.type==="text"&&w.data.includes("#")),m=o.childNodes[b];m&&(x.fix=G(x,o.getRelativeIndex(b)+m.data.indexOf("#"))),r.push(x)}return r}getTitle(i,l){return this.normalizeTitle(this.firstChild.text(),0,{halfParsed:l,temporary:i,decode:!0,selfLink:!0})}print(){return super.print(f(this,t)?{pre:"[[",post:"]]",sep:f(this,e)}:{sep:f(this,e)})}json(i,l=this.getAbsoluteIndex()){let r=super.json(void 0,l),{type:o,fragment:a}=this;return a!==void 0&&(o==="link"||o==="redirect-target")&&(r.fragment=a),r}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n),ii=tt(ar),Ht=Q(ii,0,"LinkBaseToken",or,Ht),J(ii,1,Ht)}}),cr,ni,ur,It,ee=$({"src/nowiki/base.ts"(){"use strict";Ot(),E(),cr=[Wt],It=class extends(ur=W){get innerText(){return this.firstChild.data}constructor(t="",e,s){super(t,e,s)}},ni=tt(ur),It=Q(ni,0,"NowikiBaseToken",cr,It),J(ni,1,It)}}),hr,ri,dr,dt,Dt=$({"src/nowiki/noinclude.ts"(){"use strict";pe(),ee(),hr=[Yt()],dt=class extends(dr=It){get type(){return"noinclude"}toString(t){return t?"":super.toString()}},ri=tt(dr),dt=Q(ri,0,"NoincludeToken",hr,dt),J(ri,1,dt)}}),gr,va=$({"src/link/redirectTarget.ts"(){"use strict";B(),_(),os(),Dt(),gr=class extends Ht{get type(){return"redirect-target"}constructor(t,e,s,n){super(t,void 0,s,n),e!==void 0&&this.insertAt(new dt(e,s,n))}getTitle(){return this.normalizeTitle(this.firstChild.toString(),0,{halfParsed:!0,decode:!0})}lint(t=this.getAbsoluteIndex()){let e=super.lint(t,!1),s="no-ignored",n=A.lintConfig.getSeverity(s,"redirect");if(n&&this.length===2){let i=R(this.lastChild,{start:t},s,"useless-link-text",n);i.startIndex--,i.startCol--,i.fix=G(i),e.push(i)}return e}}}}),pr,li,fr,Re,wa=$({"src/redirect.ts"(){"use strict";var t,e,s;pe(),Ot(),E(),fe(),va(),pr=[Yt(!1,!1),Wt],Re=(s=class extends(fr=W){constructor(n,i,l,r,o,a,c=[]){super(void 0,a,c),T(this,t),T(this,e),N(this,t,n),N(this,e,o),this.append(new te(i,"redirect-syntax",a,c),new gr(l,r==null?void 0:r.slice(1),a,c))}get type(){return"redirect"}getAttribute(n){return n==="padding"?f(this,t).length:super.getAttribute(n)}toString(n){return f(this,t)+super.toString(n)+f(this,e)}lint(n=this.getAbsoluteIndex()){let i=n+f(this,t).length+this.firstChild.toString().length;return this.lastChild.setAttribute("aIndex",i),this.lastChild.lint(i)}print(){return super.print({pre:f(this,t),post:f(this,e)})}},t=new WeakMap,e=new WeakMap,s),li=tt(fr),Re=Q(li,0,"RedirectToken",pr,Re),J(li,1,Re)}}),mr={};st(mr,{parseRedirect:()=>xr});var xr,ya=$({"parser/redirect.ts"(){"use strict";_(),wa(),xr=(t,e,s)=>{var n;(n=e.regexRedirect)!=null||(e.regexRedirect=new RegExp(String.raw`^(\s*)((?:${e.redirection.join("|")})\s*(?::\s*)?)\[\[([^\n|\]]+)(\|.*?)?\]\](\s*)`,"iu"));let i=e.regexRedirect.exec(t);return i&&A.normalizeTitle(i[3],0,!1,e,{halfParsed:!0,temporary:!0,decode:!0}).valid?(t=`\0${s.length}o${t.slice(i[0].length)}`,new Re(...i.slice(1),e,s),t):!1}}}),br,oi,vr,Ee,Sa=$({"src/onlyinclude.ts"(){"use strict";Ut(),Ot(),E(),br=[Wt,Pt("<onlyinclude>")],Ee=class extends(vr=W){get type(){return"onlyinclude"}toString(t){return`<onlyinclude>${super.toString(t)}</onlyinclude>`}isPlain(){return!0}print(){return super.print({pre:'<span class="wpb-ext">&lt;onlyinclude&gt;</span>',post:'<span class="wpb-ext">&lt;/onlyinclude&gt;</span>'})}},oi=tt(vr),Ee=Q(oi,0,"OnlyincludeToken",br,Ee),J(oi,1,Ee)}}),_e,as=$({"mixin/gapped.ts"(){"use strict";_e=(t=1)=>e=>{class s extends e{getGaps(){return t}}return s}}}),wr,ai,yr,se,ci=$({"src/tagPair/index.ts"(){"use strict";var t,e;as(),Ot(),E(),wr=[_e(),Wt],se=(e=class extends(yr=W){constructor(s,n,i,l,r,o=[]){super(void 0,r),T(this,t),Et(this,"closed"),Et(this,"selfClosing"),this.setAttribute("name",s.toLowerCase()),N(this,t,[s,l||s]),this.closed=l!=="",this.selfClosing=l===void 0,this.append(n,i);let a=typeof n=="string"?-1:o.indexOf(n);o.splice(a===-1?1/0:a,0,this)}get innerText(){return this.selfClosing?void 0:this.lastChild.text()}toString(s){let{selfClosing:n,firstChild:i,lastChild:l}=this,[r,o]=f(this,t);return n?`<${r}${i.toString(s)}/>`:`<${r}${i.toString(s)}>${l.toString(s)}${this.closed?`</${o}>`:""}`}text(){let[s,n]=f(this,t);return this.selfClosing?`<${s}${this.firstChild.text()}/>`:`<${s}${super.text(">")}${this.closed?`</${n}>`:""}`}getAttribute(s){return s==="padding"?f(this,t)[0].length+1:super.getAttribute(s)}print(){let[s,n]=f(this,t);return super.print(this.selfClosing?{pre:`&lt;${s}`,post:"/&gt;"}:{pre:`&lt;${s}`,sep:"&gt;",post:this.closed?`&lt;/${n}&gt;`:""})}},t=new WeakMap,e),ai=tt(yr),se=Q(ai,0,"TagPairToken",wr,se),J(ai,1,se)}}),Sr,ka=$({"src/tagPair/translate.ts"(){"use strict";var t,e,s;E(),ci(),fe(),Dt(),Sr=(s=class extends se{constructor(n,i,l,r=[]){let o=new te(n,"translate-attr",l,r);i=i==null?void 0:i.replace(/(<tvar\|[^>]+>)([\s\S]*?)(<\/>)/gu,(c,h,u,d)=>(new dt(h,l,r),new dt(d,l,r),`\0${r.length-1}n${u}\0${r.length}n`)).replace(/(<tvar\s+name\s*=(?:\s*(?:(["'])[\s\S]*?\2|[^"'\s>]+))?\s*>)([\s\S]*?)(<\/tvar\s*>)/giu,(c,h,u,d,g)=>(new dt(h,l,r),new dt(g,l,r),`\0${r.length-1}n${d}\0${r.length}n`));let a=new W(i,l,r);a.type="translate-inner",super("translate",o,a,"translate",l,r),T(this,t),this.seal("closed",!0),this.seal("selfClosing",!0)}get type(){return"translate"}toString(n){return n?this.lastChild.toString(!0):super.toString()}text(){return this.lastChild.text()}print(){return`<span class="wpb-ext">&lt;translate${M(this,t,e).call(this)?'<span class="wpb-ext-attrs"> <span class="wpb-ext-attr"><span class="wpb-attr-key">nowrap</span></span></span>':""}&gt;${this.lastChild.print({class:"ext-inner"})}&lt;/translate&gt;</span>`}},t=new WeakSet,e=function(){return this.firstChild.toString()===" nowrap"},s)}}),kr,ui,Ar,qe,Aa=$({"src/tagPair/include.ts"(){"use strict";B(),ot(),pe(),_(),ci(),kr=[Yt(!1)],qe=class extends(Ar=se){get type(){return"include"}constructor(t,e="",s,n,i,l){super(t,e,s!=null?s:"",s===void 0||n!=null?n:"",i,l)}toString(t){return t?"":super.toString()}lint(t=this.getAbsoluteIndex()){let e=[],{firstChild:s,closed:n,name:i}=this,l=new nt(this,t),r=["no-ignored","unclosed-comment"],o=r.map(a=>A.lintConfig.getSeverity(a,"include"));if(o[0]&&s.data.trim()){let a=R(s,l,r[0],"useless-attribute",o[0]);a.suggestions=[G(a)],e.push(a)}if(o[1]&&!n){let a=K(this,l,r[1],A.msg("unclosed",`<${i}>`),o[1]);a.suggestions=[zt(a.endIndex,`</${i}>`)],e.push(a)}return e}},ui=tt(Ar),qe=Q(ui,0,"IncludeToken",kr,qe),J(ui,1,qe)}}),cs,hi=$({"mixin/attributesParent.ts"(){"use strict";cs=(t=0)=>e=>{var s,n;class i extends e{constructor(){super(...arguments),T(this,s)}hasAttr(r){this.lspError("AttributesParent.hasAttr")}getAttr(r){return M(this,s,n).call(this).getAttr(r)}}return s=new WeakSet,n=function(){return this.childNodes[t]},i}}}),it,di,gi,ze,us,pi,ie,fi,mi,xi,hs,bi,Tt,$r,Cr,Ir,Tr,$a=$({"util/sharable.ts"(){"use strict";it=new Set(["align"]),di=new Set(["cite"]),gi=new Set(["cite","datetime"]),ze=new Set(["width"]),us=new Set(["axis","align","bgcolor","height","width","valign"]),pi=new Set([...us,"abbr","headers","scope","rowspan","colspan"]),ie=new Set(["type"]),fi=new Set(["summary","align","bgcolor","cellpadding","cellspacing","frame","rules","width"]),mi=new Set(["clear"]),xi=new Set(["bgcolor","align","valign"]),hs=new Set(["qid","forcemathmode","type","display"]),bi=new Set(["enclose","inline","lang","line","linelinks","style","class","id","dir","copy","highlight","start"]),Tt=new Set,$r=new Set(["id","class","style","lang","dir","title","tabindex","aria-describedby","aria-flowto","aria-hidden","aria-label","aria-labelledby","aria-level","aria-owns","role","about","property","resource","datatype","typeof","itemid","itemprop","itemref","itemscope","itemtype"]),Cr={div:it,h1:it,h2:it,h3:it,h4:it,h5:it,h6:it,blockquote:di,q:di,p:it,br:mi,pre:ze,ins:gi,del:gi,ul:ie,ol:new Set(["type","start","reversed"]),li:new Set(["type","value"]),table:new Set([...fi,"border"]),caption:it,tr:xi,td:pi,th:pi,font:new Set(["size","color","face"]),hr:ze,data:new Set(["value"]),time:new Set(["datetime"]),meta:new Set(["itemprop","content"]),link:new Set(["itemprop","href","title"]),gallery:ie,poem:it,categorytree:it,combooption:it,math:Tt,chem:Tt,ce:Tt,img:new Set(["alt","src","width","height","loading","srcset"])},Ir={gallery:new Set(["mode","showfilename","caption","perrow","widths","heights","showthumbnails"]),poem:new Set(["compact"]),categorytree:new Set(["hideroot","onlyroot","depth","mode","hideprefix","namespaces","showcount","notranslations"]),combooption:new Set(["name","for","inline"]),nowiki:Tt,indicator:new Set(["name"]),langconvert:new Set(["from","to"]),ref:new Set(["group","name","follow","dir","details"]),references:new Set(["group","responsive"]),charinsert:new Set(["label"]),choose:new Set(["uncached","before","after"]),option:new Set(["weight"]),imagemap:Tt,inputbox:Tt,templatestyles:new Set(["src","wrapper"]),dynamicpagelist:Tt,poll:new Set(["id","show-results-before-voting"]),sm2:ie,flashmp3:ie,score:new Set(["line_width_inches","lang","override_midi","raw","note-language","override_audio","override_ogg","sound","vorbis"]),seo:new Set(["title","title_mode","title_separator","keywords","description","robots","google_bot","image","image_width","image_height","image_alt","type","site_name","locale","section","author","published_time","twitter_site"]),tab:new Set(["nested","name","index","class","block","inline","openname","closename","collapsed","dropdown","style","bgcolor","container","id","title"]),tabs:new Set(["plain","class","container","id","title","style"]),combobox:new Set(["placeholder","value","id","class","text","dropdown","style"]),math:new Set([...hs,"chem"]),chem:hs,ce:hs,hiero:Tt,phonos:new Set(["ipa","class","text","lang","wikibase","file"]),section:new Set(["begin","end"]),source:bi,syntaxhighlight:bi,templatedata:Tt,timeline:new Set(["method","font"]),quiz:new Set(["display","shuffleanswers","points","shuffle","case"]),languages:Tt},Tr={table:fi,td:new Set([...us,"scope"]),th:us,br:mi,caption:it,div:it,hr:ze,h1:it,h2:it,h3:it,h4:it,h5:it,h6:it,li:ie,p:it,pre:ze,tr:xi,ul:ie}}}),Nr,Fr,Wr,jr,ds,Ca=$({"src/attribute.ts"(){"use strict";var t,e,s,n,i,l,r;B(),ht(),Zt(),$a(),ot(),_(),E(),Bt(),Nr=/expression|(?:accelerator|-o-link(?:-source)?|-o-replace)\s*:|(?:url|src|image(?:-set)?)\s*\(|attr\s*\([^)]+[\s,]url/u,Fr=/(?:^|\s|\*\/)(?:javascript|vbscript)(?:\W|$)/iu,Wr=new Set(["ext","arg","magic-word","template"]),jr=new Set(["about","property","resource","datatype","typeof","itemid","itemprop","itemref","itemscope","itemtype"]),ds=(r=class extends W{constructor(o,a,c,h="",u,d=[],g=A.getConfig(),p=[]){let x=new mt(c,"attr-key",g,p),b;if(c==="title"||a==="img"&&c==="alt")b=new W(u,g,p,{}),b.type="attr-value",b.setAttribute("stage",St-1);else if(a==="gallery"&&c==="caption"||a==="choose"&&(c==="before"||c==="after")){let m=Mt(ft({},g),{excludes:[...g.excludes,"heading","html","table","hr","list"]});b=new W(u,m,p,{}),b.type="attr-value",b.setAttribute("stage",1)}else b=new mt(u,"attr-value",g,p,{});super(void 0,g,p),T(this,i),T(this,t),T(this,e),T(this,s),T(this,n),N(this,t,o),this.append(x,b),N(this,s,h),N(this,n,[...d]),N(this,e,a),this.setAttribute("name",ce(yt(c)))}get type(){return f(this,t)}get tag(){return f(this,e)}get balanced(){return!f(this,s)||f(this,n)[0]===f(this,n)[1]}afterBuild(){f(this,s).includes("\0")&&N(this,s,this.buildFromStr(f(this,s),0)),this.parentNode&&N(this,e,this.parentNode.name),this.setAttribute("name",ce(this.firstChild.text())),super.afterBuild()}toString(o){let[a="",c=""]=f(this,n);return f(this,s)?super.toString(o,f(this,s)+a)+c:this.firstChild.toString(o)}text(){return f(this,s)?`${super.text(`${f(this,s).trim()}"`)}"`:this.firstChild.text()}getGaps(){var o,a;return f(this,s)?f(this,s).length+((a=(o=f(this,n)[0])==null?void 0:o.length)!=null?a:0):0}lint(o=this.getAbsoluteIndex(),a){var c;let h=super.lint(o,a),{balanced:u,firstChild:d,lastChild:g,name:p,tag:x}=this,b=new nt(this,o),m=["unclosed-quote","obsolete-attr"],w=m.map(S=>A.lintConfig.getSeverity(S,p));if(w[0]&&!u){let S=R(g,b,m[0],A.msg("unclosed","quotes"),w[0]);S.startIndex--,S.startCol--,S.suggestions=[zt(S.endIndex,f(this,n)[0])],h.push(S)}let k=M(this,i,l).call(this,o,b);return k&&h.push(k),w[1]&&(c=Tr[x])!=null&&c.has(p)&&h.push(R(d,b,m[1],"obsolete-attribute",w[1])),h}getValue(){return f(this,s)?this.lastChild.text().trim():this.type==="ext-attr"||""}escape(){}getAttribute(o){return o==="invalid"?M(this,i,l).call(this):super.getAttribute(o)}print(){let[o="",a=""]=f(this,n);return f(this,s)?super.print({sep:Ie(f(this,s))+o,post:a}):super.print()}json(o,a=this.getAbsoluteIndex()){let c=super.json(void 0,a);return c.tag=this.tag,c}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakSet,l=function(o,a){let{firstChild:c,lastChild:h,type:u,name:d,tag:g,parentNode:p}=this,x=!h.childNodes.some(({type:v})=>Wr.has(v)),b=this.getValue(),m=Ir[g],w=Cr[g],{length:k}=this.toString(),S="illegal-attr";if(!(m!=null&&m.has(d))&&!(w!=null&&w.has(d))&&(u==="ext-attr"?m||w:!/\{\{[^{]+\}\}/u.test(d))&&(u==="ext-attr"&&!w||!/^(?:xmlns:[\w:.-]+|data-(?!ooui|mw|parsoid)[^:]*)$/u.test(d)&&(g==="meta"||g==="link"||!$r.has(d)))||(d==="itemtype"||d==="itemid"||d==="itemref")&&!(p!=null&&p.hasAttr("itemscope"))){if(o===void 0)return!0;let v=A.lintConfig.getSeverity(S,"unknown");if(v){let y=R(c,a,S,"illegal-attribute-name",v);return y.suggestions=[G(o,k)],y}}else if(d==="style"&&typeof b=="string"&&Nr.test(b)){if(o===void 0)return!0;S="insecure-style";let v=A.lintConfig.getSeverity(S);return v&&R(h,a,S,"insecure-style",v)}else if(d==="tabindex"&&typeof b=="string"&&b!=="0"){if(o===void 0)return!0;let v=A.lintConfig.getSeverity(S,"tabindex");if(v){let y=R(h,a,S,"nonzero-tabindex",v);return y.suggestions=[G(o,k),Ct(y,"0 tabindex","0")],y}}else if(x&&u!=="ext-attr"){let v=Gn(g,d),y=String(b).toLowerCase();if(v.length>0&&v.every(C=>C!==y)){if(o===void 0)return!0;let C=A.lintConfig.getSeverity(S,"value");return C&&R(h,a,S,"illegal-attribute-value",C)}}else if(typeof b=="string"&&((/^xmlns:[\w:.-]+$/u.test(d)||jr.has(d))&&Fr.test(b)||x&&(d==="href"||g==="img"&&d==="src")&&!new RegExp(String.raw`^(?:${this.getAttribute("config").protocol}|//)\S+$`,"iu").test(b))){if(o===void 0)return!0;let v=A.lintConfig.getSeverity(S,"value");return v&&R(h,a,S,"illegal-attribute-value",v)}return!1},r)}}),vi,Lr,wi,gs,yi=$({"src/attributes.ts"(){"use strict";var t,e,s,n;B(),ht(),ot(),_(),E(),Bt(),Ca(),vi=i=>i.slice(0,-1),Lr=i=>`${vi(i)}-dirty`;try{wi=new RegExp(String.raw`[\p{L}\p{N}]`,"u")}catch(i){wi=/[^\W_]/u}gs=(n=class extends W{constructor(i,l,r,o,a=[]){if(super(void 0,o,a,{}),T(this,e),T(this,t),N(this,t,l),this.setAttribute("name",r),i){let c=/([^\s/](?:(?!\0\d+~\x7F)[^\s/=])*)(?:((?:\s(?:\s|\0\d+[cn]\x7F)*)?(?:=|\0\d+~\x7F)(?:\s|\0\d+[cn]\x7F)*)(?:(["'])([\s\S]*?)(\3|$)|(\S*)))?/gu,h="",u=c.exec(i),d=0,g=()=>{h&&(super.insertAt(new mt(h,Lr(l),o,a,{})),h="")};for(;u;){let{index:p,0:x,1:b,2:m,3:w,4:k,5:S,6:v}=u;if(h+=i.slice(d,p),/^(?:[\w:]|\0\d+t\x7F)(?:[\w:.-]|\0\d+t\x7F)*$/u.test(yt(b).trim())){let y=k!=null?k:v,C=[w,S],I=new ds(vi(l),r,b,m,y,C,o,a);g(),super.insertAt(I)}else h+=x;({lastIndex:d}=c),u=c.exec(i)}h+=i.slice(d),g()}}get type(){return f(this,t)}afterBuild(){let{parentNode:i}=this;i!=null&&i.is("td")&&this.setAttribute("name",i.subtype),super.afterBuild()}getAttrTokens(i){return this.childNodes.filter(l=>l instanceof ds&&(!i||l.name===ce(i)))}hasAttr(i){return this.getAttrTokens(i).length>0}getAttrToken(i){let l=this.getAttrTokens(i);return l[l.length-1]}getAttr(i){var l;return(l=this.getAttrToken(i))==null?void 0:l.getValue()}lint(i=this.getAbsoluteIndex(),l){let r=super.lint(i,l),{parentNode:o,childNodes:a}=this,c=new Map,h=new Set,u=new nt(this,i),d=["no-ignored","no-duplicate"],g=["closingTag","invalidAttributes","nonWordAttributes"].map(x=>A.lintConfig.getSeverity(d[0],x));if(g[0]&&M(this,e,s).call(this)){let x=K(this,u,d[0],"attributes-of-closing-tag",g[0]),b=o.getAbsoluteIndex();x.suggestions=[G(x),Ds(b)],r.push(x)}for(let x of a)if(x instanceof ds){let{name:b}=x;c.has(b)?(h.add(b),c.get(b).push(x)):c.set(b,[x])}else{let b=x.text().trim(),m=g[wi.test(b)?1:2];if(b&&m){let w=R(x,u,d[0],"invalid-attribute",m);w.suggestions=[G(w,0," ")],r.push(w)}}let p=A.lintConfig.getSeverity(d[1],"attribute");if(p&&h.size>0)for(let x of h){let b=c.get(x).map(m=>{let w=m.getValue();return[m,w===!0?"":w]});r.push(...b.map(([m,w],k)=>{let S=R(m,u,d[1],A.msg("duplicate-attribute",x),p),v=G(S);return!w||b.slice(0,k).some(([,y])=>y===w)?S.fix=v:S.suggestions=[v],S}))}return r}getAttribute(i){return i==="invalid"?M(this,e,s).call(this):super.getAttribute(i)}print(){return this.toString()?`<span class="wpb-${this.type}${M(this,e,s).call(this)?" wpb-invalid":""}">${this.childNodes.map(i=>i.print(i instanceof mt?{class:i.toString().trim()&&"attr-dirty"}:void 0)).join("")}</span>`:""}},t=new WeakMap,e=new WeakSet,s=function(){let{parentNode:i}=this;return(i==null?void 0:i.type)==="html"&&i.closing&&this.text().trim()!==""},n)}}),Mr={};st(Mr,{PreToken:()=>Or});var Or,Ia=$({"src/pre.ts"(){"use strict";Zt(),E(),Dt(),Or=class extends W{get type(){return"ext-inner"}constructor(t,e,s=[]){if(t){let n=/<nowiki>/giu,i=/<\/nowiki>/giu,{length:l}=n.source,r=n.exec(t);r&&(i.lastIndex=r.index+l);let o=i.exec(t),a=0,c="";for(;r&&o;)new dt(r[0],e,s),new dt(o[0],e,s),c+=`${t.slice(a,r.index)}\0${s.length-1}n${t.slice(r.index+l,o.index)}\0${s.length}n`,a=o.index+l+1,n.lastIndex=a,r=n.exec(t),r&&(i.lastIndex=r.index+l),o=i.exec(t);t=c+t.slice(a)}super(t,e,s,{}),this.setAttribute("stage",St-1)}isPlain(){return!0}lint(t=this.getAbsoluteIndex()){return super.lint(t,/<\s*\/\s*(pre)\b/giu)}}}}),ps,Si=$({"mixin/multiLine.ts"(){"use strict";ps=t=>{class e extends t{toString(n){return super.toString(n,`
`)}text(){return super.text(`
`).replace(/\n\s*\n/gu,`
`)}getGaps(){return 1}print(){return super.print({sep:`
`})}}return e}}}),Pr={};st(Pr,{ParamTagToken:()=>me});var Rr,ki,Er,me,_r=$({"src/paramTag/index.ts"(){"use strict";B(),ot(),vs(),Si(),_(),E(),Bt(),Rr=[ps],me=class extends(Er=W){get type(){return"ext-inner"}constructor(t,e,s=A.getConfig(),n=[],i){if(super(void 0,s,n,{}),e){let l=mt;this.append(...e.split(`
`).map(r=>i?r:Ve(r,s,n,t)).map(r=>new l(r,"param-line",s,n,{})))}n.splice(n.indexOf(this),1),n.push(this)}lint(t=this.getAbsoluteIndex()){let e="no-ignored",s=A.lintConfig.getSeverity(e,this.name);if(!s)return[];let n=new nt(this,t),i=A.msg("invalid-parameter",this.name),l=[];for(let r of this.childNodes){r.setAttribute("aIndex",t);let o=r.childNodes.filter(({type:a})=>a!=="comment"&&a!=="include"&&a!=="noinclude");if(o.some(({type:a})=>a==="ext"))l.push(R(r,n,e,i,s));else{let a=o.findIndex(({type:h})=>h!=="text"),c=o.slice(0,a===-1?void 0:a).map(String).join("");if(c&&!(a===-1?/^[a-z]+(?:\[\])?\s*=/iu:/^[a-z]+(?:\[\])?\s*(?:=|$)/iu).test(c)){let h=R(r,n,e,i,s);h.suggestions=[G(h)],l.push(h)}else{let h=r.lint(t,!1);h.length>0&&l.push(...h)}}t+=r.toString().length+1}return l}},ki=tt(Er),me=Q(ki,0,"ParamTagToken",Rr,me),J(ki,1,me)}}),qr,Ai,zr,xe,Ur=$({"src/heading.ts"(){"use strict";var t,e,s,n;B(),jt(),ot(),Ot(),_(),E(),fe(),qr=[Wt],xe=(n=class extends(zr=W){constructor(i,l,r,o=[]){super(void 0,r,o),T(this,e),T(this,t),N(this,t,i);let a=new W(l[0],r,o);a.type="heading-title",a.setAttribute("stage",2);let c=new te(l[1],"heading-trail",r,o);this.append(a,c)}get type(){return"heading"}get level(){return f(this,t)}toString(i){let l=M(this,e,s).call(this);return l+this.firstChild.toString(i)+l+this.lastChild.toString(i)}text(){let i=M(this,e,s).call(this);return i+this.firstChild.text()+i}getAttribute(i){return i==="invalid"?this.inHtmlAttrs()===2:i==="padding"?this.level:super.getAttribute(i)}getGaps(){return this.level}lint(i=this.getAbsoluteIndex(),l){let r=super.lint(i,l),{firstChild:o,level:a}=this,c=o.toString(),h=c.startsWith("="),u=h||c.endsWith("="),d=new nt(this,i),g=this.inHtmlAttrs(),p=["h1","unbalanced-header","format-leakage"],x=p.map(b=>A.lintConfig.getSeverity(b,"apostrophe"));if(x[0]&&this.level===1){let b=R(o,d,p[0],"<h1>",x[0]);u||(b.suggestions=[Ct(b,"h2",`=${c}=`)]),r.push(b)}if(x[1]&&u){let b=A.msg("unbalanced-in-section-header",'"="'),m=R(o,d,p[1],b,x[1]);if(c!=="=")if(h){let[w]=/^=+/u.exec(c),k=a+w.length;m.suggestions=[{desc:`h${a}`,range:[m.startIndex,m.startIndex+w.length],text:""}],k<7&&m.suggestions.push({desc:`h${k}`,range:[m.endIndex,m.endIndex],text:w})}else{let w=/[^=](=+)$/u.exec(c)[1],k=a+w.length;m.suggestions=[{desc:`h${a}`,range:[m.endIndex-w.length,m.endIndex],text:""}],k<7&&m.suggestions.push({desc:`h${k}`,range:[m.startIndex,m.startIndex],text:w})}r.push(m)}if(g){let b="parsing-order",m=A.lintConfig.getSeverity(b,g===2?"heading":"templateInTable");m&&r.push(K(this,d,b,"header-in-html",m))}if(x[2]){let b=this.getRootNode().toString(),m=o.childNodes.filter(Is("quote")),w=m.filter(({bold:S})=>S),k=m.filter(({italic:S})=>S);if(w.length%2){let S=R(w[w.length-1],Mt(ft({},d),{start:i+a,left:d.left+a}),p[2],A.msg("unbalanced-in-section-header","bold-apostrophes"),x[2]),v=i+a+c.length,y=G(S);b.slice(S.endIndex,v).trim()?S.suggestions=[y,zt(v,"'''")]:w.length===1&&k.length===0?S.fix=y:S.suggestions=[y],r.push(S)}if(k.length%2){let S=R(k[k.length-1],{start:i+a},p[2],A.msg("unbalanced-in-section-header","italic-apostrophes"),x[2]),v=i+a+c.length;b.slice(S.endIndex,v).trim()?S.suggestions=[zt(v,"''")]:k.length===1&&w.length===0?S.fix=G(S):S.suggestions=[G(S)],r.push(S)}}return r}print(){let i=M(this,e,s).call(this);return super.print({pre:i,sep:i})}json(i,l=this.getAbsoluteIndex()){let r=super.json(void 0,l);return r.level=this.level,r}},t=new WeakMap,e=new WeakSet,s=function(){return"=".repeat(this.level)},n),Ai=tt(zr),xe=Q(Ai,0,"HeadingToken",qr,xe),J(Ai,1,xe)}}),Br,Hr,Ta=$({"src/parameter.ts"(){"use strict";ht(),B(),_(),E(),Br=new RegExp(`https?://${oe}${ae}$`,"iu"),Hr=class extends W{get type(){return"parameter"}get anon(){return this.firstChild.length===0}get duplicated(){var t;try{return!!((t=this.parentNode)!=null&&t.getDuplicatedArgs().some(([e])=>e===this.name))}catch(e){return!1}}constructor(t,e,s,n=[]){super(void 0,s,n);let i=new W(typeof t=="number"?void 0:t,s,n,{}),l=new W(e,s,n);i.type="parameter-key",i.setAttribute("stage",2),l.type="parameter-value",l.setAttribute("stage",2),this.append(i,l)}trimName(t,e=!0){let s=(typeof t=="string"?t:t.toString(!0)).replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1");return this.setAttribute("name",s),s}afterBuild(){if(!this.anon){let{parentNode:t,firstChild:e}=this,s=this.trimName(e);t&&t.getArgs(s,!1,!1).add(this)}super.afterBuild()}toString(t){return this.anon?this.lastChild.toString(t):super.toString(t,"=")}text(){return this.anon?this.lastChild.text():super.text("=")}getGaps(){return this.anon?0:1}lint(t=this.getAbsoluteIndex(),e){var s;let n=super.lint(t,e),i="unescaped",l=A.lintConfig.getSeverity(i);if(l){let{firstChild:r}=this,o=(s=Br.exec(r.text()))==null?void 0:s[0];try{if(o&&new URL(o).search){let a=R(r,{start:t},i,"unescaped-query",l);a.startIndex=a.endIndex,a.startLine=a.endLine,a.startCol=a.endCol,a.endIndex++,a.endCol++,a.fix=ge(a.startIndex,"{{=}}"),n.push(a)}}catch(a){}}return n}print(){return super.print({sep:this.anon?"":"="})}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e);return Object.assign(s,{anon:this.anon},this.duplicated&&{duplicated:!0}),s}}}}),Dr,$i,Gr,be,Na=$({"src/transclude.ts"(){"use strict";var t,e,s,n,i,l,r,o,a;ht(),B(),jt(),ot(),as(),Ot(),_(),E(),Ta(),Bt(),fe(),Dr=[Wt,_e()],be=(a=class extends(Gr=W){constructor(c,h,u,d=[]){var g,p;let x,b=/^(?:\s|\0\d+[cn]\x7F)*\0(\d+)h\x7F(?:\s|\0\d+[cn]\x7F)*/u.exec(c);b&&(x=Number(b[1]),c=c.replace(`\0${x}h`,d[x].toString().replace(/^\n/u,""))),super(void 0,u,d,{}),T(this,l),Et(this,"modifier",""),T(this,t,"template"),T(this,e,":"),T(this,s,!1),T(this,n,new Map),T(this,i);let{parserFunction:[m,w],variable:k,functionHook:S}=u,v=(g=/^(?:\s|\0\d+[cn]\x7F)*\0\d+s\x7F/u.exec(c))==null?void 0:g[0];if(v)this.setAttribute("modifier",v),c=c.slice(v.length);else if(c.includes(":")){let[q,...U]=c.split(":"),[O]=/^(?:\s|\0\d+[cn]\x7F)*/u.exec((p=U[0])!=null?p:"");this.setModifier(`${q}:${O}`)&&(c=U.join(":").slice(O.length))}let y=c.search(/[:：]/u),C=c[y]==="：",I=y!==-1;if(I||h.length===0&&!f(this,s)){let q=I?c.slice(0,y):c,U=I&&c.slice(y+1),O=yt(q),V=I?O.slice(O.search(/\S/u))+(C?"：":""):O.trim(),lt=V.toLowerCase(),et=Array.isArray(w),j=et?w.includes(V):Object.prototype.hasOwnProperty.call(w,V),F=!et&&j?w[V]:Object.prototype.hasOwnProperty.call(m,lt)&&m[lt],H=et&&j||!("functionHook"in u)||S.includes(F),Y=et&&j||k.includes(F);if(I?F&&H:Y){this.setAttribute("name",F||lt.replace(/^#|：$/u,"")),N(this,t,"magic-word"),C&&N(this,e,"：");let gt=new te(q,"magic-word-name",u,d);if(super.insertAt(gt),U!==!1&&h.unshift([U]),this.name==="invoke")for(let rt=0;rt<2;rt++){let at=h.shift();if(!at)break;let Ft=new mt(at.join("="),`invoke-${rt?"function":"module"}`,u,d);super.insertAt(Ft)}}}if(this.type==="template"){let q=yt(c).trim();if(!this.normalizeTitle(q,10,{halfParsed:!0,temporary:!0}).valid)throw d.pop(),new SyntaxError("Invalid template name");let U=new mt(c,"template-name",u,d,{});super.insertAt(U)}typeof x=="number"&&(d[x]=void 0);let D=this.isTemplate(),P=1;for(let q=0;q<h.length;q++){let U=h[q];D||this.name==="switch"&&q>0||this.name==="tag"&&q>1||(U[0]=U.join("="),U.length=1),U.length===1&&(U.unshift(P),P++),this.insertAt(new Hr(...U,u,d))}this.seal("modifier")}get type(){return f(this,t)}get module(){}get function(){}setModifier(c){let{parserFunction:[,,h,u]}=this.getAttribute("config"),d=yt(c).trim();if(c&&!d.endsWith(":"))return!1;let g=d.slice(0,-1).toLowerCase(),p=h.includes(g),x=u.includes(g);return f(this,s)&&p||!f(this,s)&&(x||!c)||(kt.running||this.length>1)&&(p||x||!c)?(this.setAttribute("modifier",c),N(this,s,p),!!c):!1}isTemplate(){return this.type==="template"||this.name==="invoke"}afterBuild(){this.modifier.includes("\0")&&this.setAttribute("modifier",this.buildFromStr(this.modifier,0)),super.afterBuild(),this.isTemplate()&&this.type==="template"&&(N(this,i,M(this,l,r).call(this)),this.setAttribute("name",f(this,i).title))}toString(c){let{childNodes:h,length:u,firstChild:d,modifier:g,type:p}=this;return`{{${g}${p==="magic-word"?d.toString(c)+(u===1?"":f(this,e))+h.slice(1).map(x=>x.toString(c)).join("|"):super.toString(c,"|")}}}`}text(){let{childNodes:c,length:h,firstChild:u,modifier:d,type:g,name:p}=this;return g==="magic-word"&&p==="vardefine"?"":`{{${d}${g==="magic-word"?u.text()+(h===1?"":f(this,e))+Xt(c.slice(1),"|"):super.text("|")}}}`}getAttribute(c){switch(c){case"padding":return this.modifier.length+2;case"title":return f(this,i);case"colon":return f(this,e);case"invalid":return this.type==="magic-word"&&this.name==="invoke"&&(this.length===2||!M(this,l,r).call(this).valid);default:return super.getAttribute(c)}}lint(c=this.getAbsoluteIndex(),h){let u=super.lint(c,h);if(!this.isTemplate())return u;let{type:d,childNodes:g,length:p}=this,x=new nt(this,c),b=d==="magic-word",m="no-ignored",w=A.lintConfig.getSeverity(m,"fragment");if(b&&!M(this,l,r).call(this).valid)m="invalid-invoke",w=A.lintConfig.getSeverity(m,"name"),w&&u.push(R(g[1],x,m,"illegal-module",w));else if(w){let k=g[b?1:0],S=k.childNodes.findIndex(y=>y.type==="text"&&Ce(y.data).includes("#")),v=k.childNodes[S];if(v){let y=R(k,x,m,"useless-fragment",w);y.suggestions=[G(y,k.getRelativeIndex(S)+v.data.indexOf("#"))],u.push(y)}}if(m="invalid-invoke",w=A.lintConfig.getSeverity(m,"function"),w&&b&&p===2)return u.push(K(this,x,m,"missing-function",w)),u;if(m="no-duplicate",w=A.lintConfig.getSeverity(m,"parameter"),w){let k=this.getDuplicatedArgs().filter(([,v])=>!v[0].querySelector("ext")),S="duplicate-parameter";for(let[,v]of k)u.push(...v.map(y=>{let C=R(y,x,m,S,w);return C.suggestions=[G(C,-1)],C}))}return u}insertAt(c,h=this.length){return super.insertAt(c,h),c.anon?M(this,l,o).call(this,c):c.name&&this.getArgs(c.name,!1,!1).add(c),c}getAllArgs(){return this.childNodes.filter(Is("parameter"))}getAnonArgs(){return this.getAllArgs().filter(({anon:c})=>c)}getArgs(c,h,u=!0){let d=String(c).replace(/^[ \t\n\0\v]+|([^ \t\n\0\v])[ \t\n\0\v]+$/gu,"$1"),g;return f(this,n).has(d)?g=f(this,n).get(d):(g=new Set(this.getAllArgs().filter(({name:p})=>d===p)),f(this,n).set(d,g)),g}getDuplicatedArgs(){return[...f(this,n)].filter(([,{size:c}])=>c>1).map(([c,h])=>[c,[...h]])}getPossibleValues(){let{type:c,name:h,childNodes:u}=this;if(c==="template")throw new Error("TranscludeToken.getPossibleValues method is only for specific magic words!");let d,g;switch(h){case"if":case"ifexist":case"ifexpr":case"iferror":d=2;break;case"ifeq":d=3;break;case"switch":{let p=u.slice(2),x=p[p.length-1];g=[...p.filter(({anon:b})=>!b),...x!=null&&x.anon?[x]:[]].map(({lastChild:b})=>b);break}default:throw new Error("TranscludeToken.getPossibleValues method is only for specific magic words!")}g!=null||(g=u.slice(d,d+2).map(({lastChild:p})=>p));for(let p=0;p<g.length;){let{length:x,0:b}=g[p].childNodes.filter(m=>m.text().trim());if(x===0)g.splice(p,1);else if(x>1||b.type!=="magic-word")p++;else try{let m=b.getPossibleValues();g.splice(p,1,...m),p+=m.length}catch(m){p++}}return g}print(){let{childNodes:c,length:h,firstChild:u,modifier:d,type:g}=this;return`<span class="wpb-${g}${this.getAttribute("invalid")?" wpb-invalid":""}">{{${g==="magic-word"?Ie(d)+u.print()+(h===1?"":f(this,e))+he(c.slice(1),{sep:"|"}):(d?`<span class="wpb-magic-word">${Ie(d)}</span>`:"")+he(c,{sep:"|"})}}}</span>`}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakMap,l=new WeakSet,r=function(){let c=this.type==="template";return this.normalizeTitle(this.childNodes[c?0:1].text(),c?10:828,{temporary:!0})},o=function(c){let h=this.getAnonArgs(),u=typeof c!="number";for(let d=u?h.indexOf(c):c-1;d<h.length;d++){let g=h[d],{name:p}=g,x=String(d+1);(p!==x||g===c)&&(g.setAttribute("name",x),this.getArgs(x,!1,!1).add(g))}},a),$i=tt(Gr),be=Q($i,0,"TranscludeToken",Dr,be),J($i,1,be)}}),Vr,Ci,Xr,Ue,Fa=$({"src/hidden.ts"(){"use strict";pe(),E(),Vr=[Yt()],Ue=class extends(Xr=W){get type(){return"hidden"}getAttribute(t){return t==="invalid"||super.getAttribute(t)}},Ci=tt(Xr),Ue=Q(Ci,0,"HiddenToken",Vr,Ue),J(Ci,1,Ue)}}),Zr,Ii,Jr,Be,Wa=$({"src/arg.ts"(){"use strict";var t,e,s;ht(),B(),ot(),Ut(),as(),Ot(),_(),E(),Bt(),Fa(),Zr=[Wt,Pt("{{{"),_e()],Be=(s=class extends(Jr=W){constructor(n,i,l=[]){super(void 0,i,l,{}),T(this,t);for(let r=0;r<n.length;r++){let o=n[r];if(r===0){let a=new mt(o,"arg-name",i,l,{});super.insertAt(a)}else if(r>1){let a=new Ue(o,i,l);super.insertAt(a)}else{let a=new W(o,i,l);a.type="arg-default",a.setAttribute("stage",2),super.insertAt(a)}}}get type(){return"arg"}get default(){var n,i;return(i=(n=this.childNodes[1])==null?void 0:n.text())!=null?i:!1}toString(n){return`{{{${super.toString(n,"|")}}}}`}text(){return`{{{${Xt(this.childNodes.slice(0,2),"|")}}}}`}afterBuild(){super.afterBuild()}lint(n=this.getAbsoluteIndex(),i){let{childNodes:[l,r,...o]}=this;l.setAttribute("aIndex",n+3);let a=l.lint(n+3,i);if(r){let u=n+4+l.toString().length;r.setAttribute("aIndex",u);let d=r.lint(u,i);d.length>0&&a.push(...d)}let c=["no-ignored","no-arg"],h=c.map(u=>A.lintConfig.getSeverity(u,"arg"));if(h[0]&&o.length>0){let u=new nt(this,n);a.push(...o.map(d=>{let g=R(d,u,c[0],"invisible-triple-braces",h[0]);return g.startIndex--,g.startCol--,g.suggestions=[G(g),ge(g.startIndex,"{{!}}")],g}))}if(h[1]&&!this.getAttribute("include")){let u=K(this,{start:n},c[1],"unexpected-argument",h[1]);r&&(u.suggestions=[Ct(u,"expand",r.text())]),a.push(u)}return a}print(){return super.print({pre:"{{{",post:"}}}",sep:"|"})}json(n,i=this.getAbsoluteIndex()){let l=super.json(void 0,i);return l.default=this.default,l}},t=new WeakSet,e=function(){},s),Ii=tt(Jr),Be=Q(Ii,0,"ArgToken",Zr,Be),J(Ii,1,Be)}}),Qr={};st(Qr,{parseBraces:()=>ms});var Kr,Ti,fs,Ni,Fi,Wi,Yr,ji,ms,Li=$({"parser/braces.ts"(){"use strict";Jt(),ht(),Ur(),Na(),Wa(),Kr={"=":String.raw`\n(?!(?:[^\S\n]|\0\d+[cn]\x7F)*\n)`,"{":String.raw`\}{2,}|\|`,"-":String.raw`\}-`,"[":String.raw`\]\]`},Ti=String.raw`\[(?!\[)`,fs=String.raw`\n(?![=\0])`,Ni=String.raw`|\{{2,}`,Fi=new Map([["!","!"],["!!","+"],["(!","{"],["!)","}"],["!-","-"],["=","~"],["server","m"]]),Wi=de(t=>new RegExp(t,"gmu")),Yr=new RegExp(String.raw`\{\{((?:[^\n{}[]|${Ti}|${fs})*)\}\}(?!\})`+"|"+String.raw`\[\[(?:[^\n[\]{]|${fs})*\]\]`+"|"+String.raw`-\{(?:[^\n{}[]|${Ti}|${fs})*\}-`,"gu"),ji=t=>{let e=ce(yt(t));return Fi.has(e)?Fi.get(e):/^(?:filepath|(?:full|canonical)urle?):./u.test(e)?"m":/^#vardefine:./u.test(e)?"n":"t"},ms=(t,e,s)=>{var n,i,l,r,o;let a=String.raw`${e.excludes.includes("heading")?"":String.raw`^((?:\0\d+[cno]\x7F)*)={1,6}|`}\[\[|-\{(?!\{)`,{parserFunction:[,,,c]}=e,h=[],u=[],d=(k,S,v,y)=>{S[S.length-1].push(wt(k.slice(v,y),u))},g;do g!==void 0&&(t=g),g=t.replace(Yr,(k,S,v)=>{if(S!==void 0||typeof v=="string")try{let{length:y}=s,C=(S!=null?S:v).split("|");return new be(wt(C[0],u),C.slice(1).map(I=>{let D=I.indexOf("=");return(D===-1?[I]:[I.slice(0,D),I.slice(D+1)]).map(P=>wt(P,u))}),e,s),`\0${y}${ji(C[0])}`}catch(y){if(!(y instanceof SyntaxError)||y.message!=="Invalid template name")throw y}return u.push(wt(k,u)),`\0${u.length-1}`});while(g!==t);t=g;let p=t.lastIndexOf("}}")-t.length,x=p+t.length!==-1,b=Wi(a+(x?Ni:"")),m=b.exec(t),w;for(;m||w!==void 0&&w<=t.length&&(i=(n=h[h.length-1])==null?void 0:n[0])!=null&&i.startsWith("=");){if(m!=null&&m[1]){let[,{length:O}]=m;m[0]=m[0].slice(O),m.index+=O}let{0:k,index:S}=m!=null?m:{0:`
`,index:t.length},v=(l=h.pop())!=null?l:{},{0:y,index:C,parts:I,findEqual:D,pos:P}=v,q=k==="="&&D;if(k==="]]"||k==="}-")w=S+2;else if(k===`
`){w=S+1;let{pos:O,findEqual:V}=(r=h[h.length-1])!=null?r:{};if(O===void 0||V||yt(t.slice(O,C))!==""){let lt=/^(={1,6})(.+)\1((?:\s|\0\d+[cn]\x7F)*)$/u.exec(t.slice(C,S));lt&&(lt[2]=wt(lt[2],u),lt[2].includes(`
`)||(t=`${t.slice(0,C)}\0${s.length}h${t.slice(S)}`,w=C+4+String(s.length).length,new xe(lt[1].length,lt.slice(2),e,s)))}}else if(k==="|"||q)w=S+1,d(t,I,P,S),k==="|"&&I.push([]),v.pos=w,v.findEqual=k==="|",h.push(v);else if(k.startsWith("}}")){let O=k.slice(0,Math.min(y.length,3)),V=y.length-O.length,{length:lt}=s;w=S+O.length,d(t,I,P,S);let et=!1,j="t";if(O.length===3){let F=I.map(Y=>Y.join("=")),H=F.length>1&&yt(F[1]).trim();new Be(F,e,s),H&&H.endsWith(":")&&c.includes(H.slice(0,-1).toLowerCase())&&(j="s")}else try{new be(I[0][0],I.slice(1),e,s),j=ji(I[0][0])}catch(F){if(F instanceof SyntaxError&&F.message==="Invalid template name")et=!0;else throw F}et||(t=`${t.slice(0,C+V)}\0${lt}${j}${t.slice(w)}`,w=C+V+3+String(lt).length,V>1?h.push({0:y.slice(0,V),index:C,pos:C+V,parts:[[]]}):V===1&&t[C-1]==="-"&&h.push({0:"-{",index:C-1,pos:C+1,parts:[[]]}))}else w=S+k.length,k.startsWith("{")&&(m.pos=w,m.parts=[[]]),h.push(..."0"in v?[v]:[],m);let U=h[h.length-1];if(x&&p+t.length<w)for(x=!1;(o=U==null?void 0:U[0])!=null&&o.startsWith("{");)h.pop(),U=h[h.length-1];b=Wi(a+(x?Ni:"")+(U?`|${Kr[U[0][0]]}${U.findEqual?"|=":""}`:"")),b.lastIndex=w,m=b.exec(t)}return wt(t,u)}}}),tl={};st(tl,{InputboxToken:()=>el});var el,ja=$({"src/paramTag/inputbox.ts"(){"use strict";vs(),Li(),_(),_r(),el=class extends me{constructor(t,e,s=A.getConfig(),n=[]){let i=Symbol("InputboxToken"),l=s.excludes.includes("heading")?s:Mt(ft({},s),{excludes:[...s.excludes,"heading"]}),{length:r}=n;n.push(i),e&&(e=Ve(e,l,n,t)),e&&(e=ms(e,l,n)),n.splice(r,1),super(t,e,l,n,{})}}}}),xs={};st(xs,{NestedToken:()=>nl});var sl,il,nl,Mi=$({"src/nested.ts"(){"use strict";var t,e,s;B(),ot(),vs(),Li(),_(),E(),zl(),Dt(),sl=new Set(["comment","include","arg","template","magic-word"]),il=[!1,!0].map(n=>{let i=n?"includeonly":"noinclude";return new RegExp(String.raw`^(?:<${i}(?:\s[^>]*)?/?>|</${i}\s*>)$`,"iu")}),nl=(s=class extends W{constructor(n,i,l,r,o=[]){if(typeof i=="boolean"){let a=Symbol("NestedToken"),{length:c}=o;o.push(a),n&&(n=Ve(n,r,o,i)),n&&(n=ms(n,r,o)),o.splice(c,1)}else n&&(n=n.replace(i,(a,c,h,u,d)=>{let g=`\0${o.length+1}e`;return new Se(c,h,u,d,r,!1,o),g}));n&&(n=n.replace(/(^|\0\d+.\x7F)([^\0]+)(?=$|\0\d+.\x7F)/gu,(a,c,h)=>(new dt(h,r,o),`${c}\0${o.length}n`))),super(n,r,o),T(this,t),T(this,e),N(this,t,[...l]),N(this,e,i)}get type(){return"ext-inner"}lint(n=this.getAbsoluteIndex(),i){let l=super.lint(n,i),r="no-ignored",o=A.lintConfig.getSeverity(r,this.name);if(!o)return l;let a=new nt(this,n),c=typeof f(this,e)=="boolean"?il[f(this,e)?1:0]:/^<!--[\s\S]*-->$/u;return[...l,...this.childNodes.filter(h=>{let{type:u,name:d}=h;if(u==="ext")return!f(this,t).includes(d);if(sl.has(u))return!1;let g=h.toString().trim();return g&&!c.test(g)}).map(h=>{let u=R(h,a,r,A.msg("invalid-content",this.name),o);return u.suggestions=[G(u),Gs(u,h.toString())],u})]}},t=new WeakMap,e=new WeakMap,s)}});function rl(t,e,s,n,i){e=yt(e).trim();let l=e.replace(t==="link"?/\0\d+[tq]\x7F/gu:/\0\d+t\x7F/gu,"").trim();switch(t){case"width":return!l&&!!e||/^(?:\d+x?|\d*x\d+)(?:\s*px)?$/u.test(l);case"link":{if(l){if(ll(s.protocol).test(l))return ol(s.protocol).test(l)&&e;l.startsWith("[[")&&l.endsWith("]]")&&(l=l.slice(2,-2))}else return e;let r=A.normalizeTitle(l,0,!1,s,{halfParsed:n,decode:!0,selfLink:!0});return r.valid&&r}case"lang":return(i==="svg"||i==="svgz")&&!/[^a-z\d-]/u.test(l);case"alt":case"class":case"manualthumb":return!0;case"page":return(i==="djvu"||i==="djv"||i==="pdf")&&Number(l)>0;default:return!!l&&!isNaN(l)}}var ll,ol,al,cl,ul,La=$({"src/imageParameter.ts"(){"use strict";var t,e,s,n;Jt(),ht(),B(),_(),E(),ll=de(i=>new RegExp(String.raw`^(?:${i}|//|\0\d+m\x7F)`,"iu")),ol=de(i=>new RegExp(String.raw`^(?:(?:${i}|//)${oe}|\0\d+m\x7F)${ae}$`,"iu")),al=de(i=>new RegExp(String.raw`^(\s*(?!\s))${i.replace("$1","(.*)")}${i.endsWith("$1")?`(?=$|
)`:""}(\s*)$`,"u")),cl=new Set(["alt","link","lang","page","caption"]),ul=(n=class extends W{constructor(i,l,r,o){var a=(...d)=>(super(...d),T(this,e),T(this,t,""),this);let c,h=Object.entries(r.img).map(([d,g])=>[d,g,al(d)]),u=h.find(([,d,g])=>(c=g.exec(i),c&&(c.length!==4||rl(d,c[2],r,!0,l)!==!1)));if(u&&c){c.length===3?(a(void 0,r,o),N(this,t,i)):(a(c[2],r,o,{}),N(this,t,c[1]+u[0]+c[3])),this.setAttribute("name",u[1]);return}a(i,r.excludes.includes("list")?r:Mt(ft({},r),{excludes:[...r.excludes,"list"]}),o),this.setAttribute("name","caption"),this.setAttribute("stage",7)}get type(){return"image-parameter"}get link(){return this.name==="link"?rl("link",super.text(),this.getAttribute("config")):void 0}afterBuild(){var i;(i=this.parentNode)!=null&&i.is("gallery-image")&&!cl.has(this.name)&&this.setAttribute("name","invalid"),super.afterBuild()}toString(i){return f(this,t)?f(this,t).replace("$1",super.toString(i)):super.toString(i)}text(){return f(this,t)?f(this,t).replace("$1",super.text()).trim():super.text().trim()}isPlain(){return this.name==="caption"}getAttribute(i){return i==="invalid"?this.name==="invalid":i==="padding"?Math.max(0,f(this,t).indexOf("$1")):super.getAttribute(i)}lint(i=this.getAbsoluteIndex(),l){let r=super.lint(i,l),{link:o,name:a}=this;if(a==="invalid"){let c="invalid-gallery",h=A.lintConfig.getSeverity(c,"parameter");if(h){let u=K(this,{start:i},c,"invalid-image-parameter",h);u.fix=G(u,-1),r.push(u)}}else if(typeof o=="object"&&o.encoded){let c="url-encoding",h=A.lintConfig.getSeverity(c,"file");if(h){let u=K(this,{start:i},c,"unnecessary-encoding",h);u.fix=Hs(u,this),r.push(u)}}return r}getValue(){return this.name==="invalid"?this.text():M(this,e,s).call(this)||super.text()}print(){return f(this,t)?`<span class="wpb-image-parameter${this.name==="invalid"?" wpb-invalid":""}">${f(this,t).replace("$1",`<span class="wpb-image-caption">${he(this.childNodes)}</span>`)}</span>`:super.print({class:"image-caption"})}},t=new WeakMap,e=new WeakSet,s=function(){return f(this,t)&&!f(this,t).includes("$1")},n)}}),Oi,hl,dl,Pi,Ri,Ei,gl,_i,qi,pl=$({"src/link/file.ts"(){"use strict";B(),ot(),_(),os(),La(),Oi=new Map([["manualthumb","Thumb"],["frameless","Frameless"],["framed","Frame"],["thumbnail","Thumb"]]),hl=new Set(["arg"]),dl=new Set(["template","magic-word"]),Pi=new Set(["left","right","center","none"]),Ri=new Set(["baseline","sub","super","top","text-top","middle","bottom","text-bottom"]),Ei=new Set(["tiff","tif","png","gif","jpg","jpeg","webp","xcf","pdf","svg","djvu"]),gl=t=>{if(t===void 0)return[];let e=/-\{|\}-|\|/gu,s=[],n=e.exec(t),i=0,l=0;for(;n;){let{0:r,index:o}=n;r!=="|"?i+=r==="-{"?1:-1:i===0&&(s.push(t.slice(l,o)),{lastIndex:l}=e),n=e.exec(t)}return s.push(t.slice(l)),s},_i=(t,e)=>t.filter(({childNodes:s})=>{let n=s.filter(i=>i.text().trim());return n.length!==1||!e.has(n[0].type)}),qi=class extends Ht{get type(){return"file"}get extension(){return this.getAttribute("title").extension}constructor(t,e,s,n=[],i="|"){super(t,void 0,s,n,i);let{extension:l}=this.getTitle(!0,!0);this.safeAppend(gl(e).map(r=>new ul(r,l,s,n)))}lint(t=this.getAbsoluteIndex(),e){var s;let n=super.lint(t,e),i=_i(this.getAllArgs(),hl),l=[...new Set(i.map(({name:m})=>m))],r=l.filter(m=>Oi.has(m)),o=l.filter(m=>Pi.has(m)),a=l.filter(m=>Ri.has(m)),[c]=r,h=c==="framed"||c==="manualthumb",u=new nt(this,t),{extension:d}=this,g="nested-link",p=A.lintConfig.getSeverity(g,"file");if(p&&Ei.has(d)&&this.closest("ext-link-text")&&((s=this.getValue("link"))==null?void 0:s.trim())!==""){let m=K(this,u,g,"link-in-extlink",p),w=this.getArg("link");if(w){let k=t+w.getRelativeIndex();m.fix={desc:A.msg("delink"),range:[k,k+w.toString().length],text:"link="}}else m.fix=ss(m.endIndex-2,"delink","|link=");n.push(m)}if(g="invalid-gallery",p=A.lintConfig.getSeverity(g,"parameter"),p&&h)for(let m of i.filter(({name:w})=>w==="width")){let w=R(m,u,g,"invalid-image-parameter",p);w.fix=G(w,-1),n.push(w)}if(i.length===l.length&&r.length<2&&o.length<2&&a.length<2)return n;g="no-duplicate";let x=["unknownImageParameter","imageParameter"].map(m=>A.lintConfig.getSeverity(g,m)),b=(m,w,k,S=!0)=>m.map(v=>{if(p=x[Number(typeof S=="function"?S(v):S)],!p)return!1;let y=R(v,u,g,A.msg(`${w}-image-parameter`,k),p);return y.suggestions=[G(y,-1)],y}).filter(v=>v!==!1);for(let m of l){if(m==="invalid"||m==="width"&&h)continue;let w=m==="caption",k=i.filter(({name:S})=>S===m);if(w&&(k=[...k.slice(0,-1).filter(S=>S.text()),...k.slice(-1)]),k.length>1){let S=!w||!d||Ei.has(d);if(w&&S){let v=_i(k,dl);S=v.length>1&&(y=>v.includes(y))}n.push(...b(k,"duplicate",m,S))}}return r.length>1&&n.push(...b(i.filter(({name:m})=>Oi.has(m)),"conflicting","frame")),o.length>1&&n.push(...b(i.filter(({name:m})=>Pi.has(m)),"conflicting","horizontal-alignment")),a.length>1&&n.push(...b(i.filter(({name:m})=>Ri.has(m)),"conflicting","vertical-alignment")),n}getAllArgs(){return this.childNodes.slice(1)}getArgs(t){return this.getAllArgs().filter(({name:e})=>t===e)}getArg(t){let e=this.getArgs(t);return e[t==="manualthumb"?0:e.length-1]}getValue(t){var e;return(e=this.getArg(t))==null?void 0:e.getValue()}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e),{extension:n}=this;return n&&(s.extension=n),s}}}}),fl,zi,ml,ve,xl=$({"src/link/galleryImage.ts"(){"use strict";var t,e,s;B(),Zt(),Ut(),_(),E(),pl(),fl=[Pt("")],ve=(s=class extends(ml=qi){constructor(n,i,l,r,o=[]){let a;if(l!==void 0){let{length:c}=o;a=new W(l,r,o);for(let h=0;h<St-1;h++)a.parseOnce();o.splice(c,1)}super(i,a==null?void 0:a.toString(),r,o),T(this,t),Et(this,"privateType","imagemap-image"),this.setAttribute("bracket",!1),this.privateType=`${n}-image`,this.seal("privateType",!0)}get type(){return this.privateType}getTitle(n){let i=this.type==="imagemap-image";return this.normalizeTitle(this.firstChild.toString(),i?0:6,{halfParsed:!0,temporary:n,decode:!i})}lint(n=this.getAbsoluteIndex(),i){let l=super.lint(n,i),r="invalid-gallery",o=A.lintConfig.getSeverity(r,"image");if(o&&M(this,t,e).call(this)){let a=K(this,{start:n},r,"invalid-gallery",o);a.suggestions=[ss(n,"prefix","File:")],l.push(a)}return l}getAttribute(n){return n==="invalid"?M(this,t,e).call(this):super.getAttribute(n)}},t=new WeakSet,e=function(){let{ns:n}=this.getAttribute("title");return n!==6},s),zi=tt(ml),ve=Q(zi,0,"GalleryImageToken",fl,ve),J(zi,1,ve)}}),bl={};st(bl,{GalleryToken:()=>He});var vl,Ui,wl,He,Ma=$({"src/gallery.ts"(){"use strict";var t,e,s,n;B(),Si(),_(),E(),xl(),Dt(),vl=[ps],He=(n=class extends(wl=W){constructor(i,l,r=[]){var o;super(void 0,l,r,{}),T(this,t);for(let a of(o=i==null?void 0:i.split(`
`))!=null?o:[]){let c=/^([^|]+)(?:\|(.*))?/u.exec(a);if(!c){super.insertAt(a.trim()?new dt(a,l,r):a);continue}let[,h,u]=c;M(this,t,e).call(this,h)?super.insertAt(new ve("gallery",h,u,l,r)):super.insertAt(new dt(a,l,r))}}get type(){return"ext-inner"}get widths(){return M(this,t,s).call(this,"widths")}get heights(){return M(this,t,s).call(this,"heights")}lint(i=this.getAbsoluteIndex(),l){let{top:r,left:o}=this.getRootNode().posFromIndex(i),a=[],c="no-ignored",h=["Image","NoImage","Comment"].map(u=>A.lintConfig.getSeverity(c,`gallery${u}`));for(let u=0;u<this.length;u++){let d=this.childNodes[u],g=d.toString(),{length:p}=g,x=g.trim(),{type:b}=d,m=r+u,w=u?0:o;if(d.setAttribute("aIndex",i),b==="noinclude"&&x&&!/^<!--.*-->$/u.test(x)){let[k]=h;if(x.startsWith("|")?[,k]=h:(x.startsWith("<!--")||x.endsWith("-->"))&&([,,k]=h),k){let S=i+p,v={rule:c,message:A.msg("invalid-content","gallery"),severity:k,startIndex:i,endIndex:S,startLine:m,endLine:m,startCol:w,endCol:w+p};v.suggestions=[G(v),Gs(v,g)],a.push(v)}}else if(b!=="noinclude"&&b!=="text"){let k=d.lint(i,l);k.length>0&&a.push(...k)}i+=p+1}return a}json(i,l=this.getAbsoluteIndex()){let r=super.json(void 0,l);return Object.assign(r,{widths:this.widths,heights:this.heights}),r}},t=new WeakSet,e=function(i){return this.normalizeTitle(i,6,{halfParsed:!0,temporary:!0,decode:!0}).valid},s=function(i){var l,r;let o=(l=this.parentNode)==null?void 0:l.getAttr(i),a=typeof o=="string"&&((r=/^(\d+)\s*(?:px)?$/u.exec(o))==null?void 0:r[1]);return a&&Number(a)||120},n),Ui=tt(wl),He=Q(Ui,0,"GalleryToken",vl,He),J(Ui,1,He)}}),Bi,yl=$({"src/link/index.ts"(){"use strict";Jt(),B(),_(),os(),Bi=class extends Ht{get type(){return"link"}get innerText(){return this.length>1?this.lastChild.text():Te(this.firstChild.text().replace(/^\s*:?/u,""))}lint(t=this.getAbsoluteIndex(),e){let s=super.lint(t,e),n="nested-link",i=A.lintConfig.getSeverity(n);if(i&&this.closest("ext-link-text")){let l=K(this,{start:t},n,"link-in-extlink",i);l.fix=Ct(l,"delink",this.innerText),s.push(l)}return s}}}}),Sl,kl,De,Hi=$({"src/magicLink.ts"(){"use strict";var t,e,s,n;B(),ht(),ot(),_(),E(),Sl=String.raw`(?:[${qt}\t]|&nbsp;|&#0*160;|&#[xX]0*[aA]0;)`,kl=new RegExp(`${Sl}+`,"gu"),De=(n=class extends W{constructor(i,l="free-ext-link",r=A.getConfig(),o){super(i,r,o,{}),T(this,e),T(this,t),N(this,t,l)}get type(){return f(this,t)}get innerText(){let i=new Map([["!","|"],["=","="]]),l=Xt(this.childNodes.map(r=>{let{type:o}=r,a=String(r.name);return o==="magic-word"&&i.has(a)?i.get(a):r}));return this.type==="magic-link"&&(l=l.replace(kl," ")),l}get link(){let{innerText:i}=this;return this.type==="magic-link"?i.startsWith("ISBN")?`ISBN ${i.slice(5).replace(/[- ]/gu,"").replace(/x$/u,"X")}`:i:_n(i).replace(/\n/gu,"%0A")}lint(i=this.getAbsoluteIndex(),l){let r=super.lint(i,l),o=new nt(this,i),{type:a,childNodes:c}=this;if(a==="magic-link"){let g="invalid-isbn",p=A.lintConfig.getSeverity(g);return p&&M(this,e,s).call(this)&&r.push(K(this,o,g,"invalid-isbn",p)),r}let h=a==="ext-link-url",u="unterminated-url",d=A.lintConfig.getSeverity(u,h?"pipe":"punctuation");if(d){let g=h?/\|/u:/[，；。：！？（）]+/u,p=c.find(x=>x.type==="text"&&g.test(x.data));if(p){let{data:x}=p,b=R(p,o,u,A.msg("in-url",h?'"|"':"full-width-punctuation"),d),{index:m,0:w}=g.exec(x),k=b.startIndex+m;b.suggestions=h?[Fe(k,1)]:[Fe(k),{desc:A.msg("encode"),range:[k,k+w.length],text:encodeURI(w)}],r.push(b)}}return r}getUrl(i){this.lspError("MagicLinkToken.getUrl")}getAttribute(i){return i==="invalid"?M(this,e,s).call(this):super.getAttribute(i)}},t=new WeakMap,e=new WeakSet,s=function(){if(this.type==="magic-link"){let{link:i}=this;if(i.startsWith("ISBN")){let l=[...i.slice(5)].map(r=>r==="X"?10:Number(r));return l.length===10?l.reduce((r,o,a)=>r+o*(10-a),0)%11!==0:l.length===13&&(l[12]===10||l.reduce((r,o,a)=>r+o*(a%2?3:1),0)%10!==0)}}return!1},n)}}),Al,Di,$l,we,Cl=$({"src/extLink.ts"(){"use strict";var t,e;Zt(),B(),Ut(),_(),E(),Hi(),Al=[Pt("[")],we=(e=class extends($l=W){constructor(s,n="",i="",l,r=[]){super(void 0,l,r,{}),T(this,t);let o=s&&/^\0\d+f\x7F$/u.test(s)?r[Number(s.slice(1,-2))]:new De(s,"ext-link-url",l,r);if(this.insertAt(o),N(this,t,n),i){let a=new W(i,l,r,{});a.type="ext-link-text",a.setAttribute("stage",St-1),this.insertAt(a)}}get type(){return"ext-link"}toString(s){return this.length===1?`[${super.toString(s)}${f(this,t)}]`:`[${super.toString(s,f(this,t))}]`}text(){return`[${super.text(" ")}]`}getGaps(){return f(this,t).length}lint(s=this.getAbsoluteIndex(),n){let i=super.lint(s,n),l="var-anchor",r=A.lintConfig.getSeverity(l,"extLink");return r&&this.length===1&&this.closest("heading-title")&&i.push(K(this,{start:s},l,"variable-anchor",r)),i}print(){return super.print(this.length===1?{pre:"[",post:`${f(this,t)}]`}:{pre:"[",sep:f(this,t),post:"]"})}},t=new WeakMap,e),Di=tt($l),we=Q(Di,0,"ExtLinkToken",Al,we),J(Di,1,we)}}),Gi,Oa=$({"src/imagemapLink.ts"(){"use strict";E(),Dt(),yl(),Cl(),Gi=class extends W{get type(){return"imagemap-link"}constructor(t,e,s,n,i=[]){super(void 0,n,i),this.append(t,e.length===2?new Bi(...e,n,i):new we(...e,n,i),new dt(s,n,i))}}}}),Il={};st(Il,{ImagemapToken:()=>Ge});var Tl,Vi,Nl,Ge,Pa=$({"src/imagemap.ts"(){"use strict";B(),jt(),ot(),Si(),_(),E(),Dt(),xl(),Oa(),Tl=[ps],Ge=class extends(Nl=W){get type(){return"ext-inner"}get image(){return this.childNodes.find(Is("imagemap-image"))}constructor(t,e=A.getConfig(),s=[]){if(super(void 0,e,s,{}),!t)return;let n=t.split(`
`),i=new Set(e.protocol.split("|")),l=dt,r=!0,o=!1;for(let a of n){let c=a.trim();if(!(o||!c||c.startsWith("#"))){if(r){let h=a.indexOf("|"),u=h===-1?a:a.slice(0,h),{valid:d,ns:g}=this.normalizeTitle(u,0,{halfParsed:!0,temporary:!0});if(d&&g===6){let p=new ve("imagemap",u,h===-1?void 0:a.slice(h+1),e,s);super.insertAt(p),r=!1;continue}else o=!0}else if(a.trim().split(/[\t ]/u,1)[0]==="desc"){super.insertAt(a);continue}else if(a.includes("[")){let h=a.indexOf("["),u=a.slice(h),d=/^\[\[([^|]+)(?:\|([^\]]*))?\]\][\w\s]*$/u.exec(u);if(d){if(this.normalizeTitle(d[1],0,{halfParsed:!0,temporary:!0,selfLink:!0}).valid){super.insertAt(new Gi(a.slice(0,h),d.slice(1),u.slice(u.indexOf("]]")+2),e,s));continue}}else if(u.startsWith("[//")||i.has(u.slice(1,u.indexOf(":")+1))||i.has(u.slice(1,u.indexOf("//")+2))){let g=/^\[([^\]\s]+)(?:(\s+(?!\s))([^\]]*))?\][\w\s]*$/u.exec(u);if(g){super.insertAt(new Gi(a.slice(0,h),g.slice(1),u.slice(u.indexOf("]")+1),e,s));continue}}}}super.insertAt(new l(a,e,s))}}lint(t=this.getAbsoluteIndex(),e){let s=super.lint(t,e),n=new nt(this,t),{childNodes:i,image:l}=this,r="invalid-imagemap",o=A.lintConfig.getSeverity(r,l?"link":"image");return o&&(l?s.push(...i.filter(a=>{let c=a.toString().trim();return a.is("noinclude")&&c&&!c.startsWith("#")}).map(a=>{let c=R(a,n,r,"invalid-imagemap-link",o);return c.suggestions=[G(c,-1),Ct(c,"comment","# ")],c})):s.push(K(this,n,r,"imagemap-without-image",o))),s}getAttribute(t){return t==="invalid"?!this.image:super.getAttribute(t)}},Vi=tt(Nl),Ge=Q(Vi,0,"ImagemapToken",Tl,Ge),J(Vi,1,Ge)}}),Fl,Xi,Wl,ye,jl=$({"src/nowiki/comment.ts"(){"use strict";B(),pe(),Ut(),_(),ee(),Fl=[Yt(!1),Pt("<!--")],ye=class extends(Wl=It){constructor(t,e,s,n){super(t,s,n),Et(this,"closed"),this.closed=e}get type(){return"comment"}lint(t=this.getAbsoluteIndex()){if(this.closed)return[];let e="unclosed-comment",s=A.lintConfig.getSeverity(e);if(!s)return[];let n=K(this,{start:t},e,A.msg("unclosed","html-comment"),s);return n.suggestions=[zt(n.endIndex,"-->")],[n]}toString(t){return t?"":`<!--${this.innerText}${this.closed?"-->":""}`}print(){return super.print({pre:"&lt;!--",post:this.closed?"--&gt;":""})}},Xi=tt(Wl),ye=Q(Xi,0,"CommentToken",Fl,ye),J(Xi,1,ye)}}),Ll={};st(Ll,{CommentedToken:()=>Ml});var Ml,Ra=$({"src/commented.ts"(){"use strict";E(),jl(),Ml=class extends W{get type(){return"ext-inner"}constructor(t,e,s=[]){if(super(void 0,e,s,{AstText:":",CommentToken:":"}),t){let n=t.indexOf("<!--"),i=n!==-1&&t.indexOf("-->",n+4),l=0;for(;i!==!1&&i!==-1;)n>l&&this.insertAt(t.slice(l,n)),this.insertAt(new ye(t.slice(n+4,i),!0,e,s)),l=i+3,n=t.indexOf("<!--",l),i=n!==-1&&t.indexOf("-->",n+4);l<t.length&&this.insertAt(t.slice(l))}}lint(t=this.getAbsoluteIndex()){return super.lint(t,new RegExp(String.raw`<\s*(?:\/\s*)?(${this.name})\b`,"giu"))}}}}),Ol={};st(Ol,{NowikiToken:()=>El});var Pl,Rl,El,Ea=$({"src/nowiki/index.ts"(){"use strict";var t,e,s;Jt(),B(),_(),ee(),Pl=de(n=>new RegExp(String.raw`<\s*(?:/\s*)${n==="nowiki"?"":"?"}(${n})\b`,"giu")),Rl=new Set(["languages","section","templatestyles"]),El=(s=class extends It{constructor(){super(...arguments),T(this,t)}get type(){return"ext-inner"}lint(n=this.getAbsoluteIndex()){let{name:i}=this,l="void-ext",r=A.lintConfig.getSeverity(l,i);if(r&&M(this,t,e).call(this)){let o=K(this,{start:n},l,A.msg("nothing-in",i),r);return o.suggestions=[G(o)],[o]}return super.lint(n,Pl(i))}getAttribute(n){return n==="invalid"?M(this,t,e).call(this):super.getAttribute(n)}},t=new WeakSet,e=function(){let{name:n,firstChild:{data:i}}=this;return Rl.has(n)&&!!i},s)}}),_l,Zi,ql,Se,zl=$({"src/tagPair/ext.ts"(){"use strict";B(),ot(),_(),hi(),E(),ci(),yi(),_l=[cs()],Se=class extends(ql=se){get type(){return"ext"}constructor(t,e,s,n,i=A.getConfig(),l=!1,r=[]){let o=t.toLowerCase(),a=new gs(!e||/^\s/u.test(e)?e:` ${e}`,"ext-attrs",o,i,r),c=Mt(ft({},i),{ext:i.ext.filter(u=>u!==o),excludes:[...i.excludes]}),h;switch(c.inExt=!0,o){case"tab":c.ext=c.ext.filter(u=>u!=="tabs");case"indicator":case"poem":case"ref":case"option":case"combooption":case"tabs":case"poll":case"seo":case"langconvert":case"phonos":o==="poem"&&c.excludes.push("heading"),h=new W(s,c,r);break;case"pre":{let{PreToken:u}=(Ia(),Z(Mr));h=new u(s,c,r);break}case"dynamicpagelist":{let{ParamTagToken:u}=(_r(),Z(Pr));h=new u(l,s,c,r);break}case"inputbox":{let{InputboxToken:u}=(ja(),Z(tl));h=new u(l,s,c,r);break}case"references":{let{NestedToken:u}=(Mi(),Z(xs));c.excludes.push("heading"),h=new u(s,l,["ref"],c,r);break}case"choose":{let{NestedToken:u}=(Mi(),Z(xs));h=new u(s,/<(option|choicetemplate)(\s[^>]*?)?(?:\/>|>([\s\S]*?)<\/(\1)>)/gu,["option","choicetemplate"],c,r);break}case"combobox":{let{NestedToken:u}=(Mi(),Z(xs));h=new u(s,/<(combooption)(\s[^>]*?)?(?:\/>|>([\s\S]*?)<\/(combooption\s*)>)/giu,["combooption"],c,r);break}case"gallery":{let{GalleryToken:u}=(Ma(),Z(bl));h=new u(s,c,r);break}case"imagemap":{let{ImagemapToken:u}=(Pa(),Z(Il));h=new u(s,c,r);break}case"hiero":{let{CommentedToken:u}=(Ra(),Z(Ll));h=new u(s,c,r);break}default:{let{NowikiToken:u}=(Ea(),Z(Ol));h=new u(s,c,r)}}h.setAttribute("name",o),h.type==="plain"&&(h.type="ext-inner"),super(t,a,h,n,i,r),this.seal("closed",!0)}lint(t=this.getAbsoluteIndex(),e){let s=super.lint(t,e),n=new nt(this,t);if(this.name!=="nowiki"){let r=this.inHtmlAttrs(),o="parsing-order",a=r&&A.lintConfig.getSeverity(o,r===2?"ext":"templateInTable");a&&s.push(K(this,n,o,"ext-in-html",a))}let i="var-anchor",l=A.lintConfig.getSeverity(i,"ref");return l&&this.name==="ref"&&this.closest("heading-title")&&s.push(K(this,n,i,"variable-anchor",l)),s}},Zi=tt(ql),Se=Q(Zi,0,"ExtToken",_l,Se),J(Zi,1,Se)}}),Ul={};st(Ul,{parseCommentAndExt:()=>Ve});var Ji,Bl,bs,Hl,Qi,Ve,vs=$({"parser/commentAndExt.ts"(){"use strict";Jt(),ht(),Sa(),Dt(),ka(),Aa(),zl(),jl(),Ji="<onlyinclude>",Bl="</onlyinclude>",{length:bs}=Ji,Hl=[!1,!0].map(t=>{let e=t?"includeonly":"(?:no|only)include",s=t?"noinclude":"includeonly";return Bn(n=>new RegExp(String.raw`<!--[\s\S]*?(?:-->|$)|<${e}(?:\s[^>]*)?/?>|</${e}\s*>|<(${n.join("|")})(\s[^>]*?)?(?:/>|>([\s\S]*?)</(${"\\1"}\s*)>)|<(${s})(\s[^>]*?)?(?:/>|>([\s\S]*?)(?:</(${s}\s*)>|$))`,"giu"))}),Qi=t=>{let e=t.indexOf(Ji);return{i:e,j:t.indexOf(Bl,e+bs)}},Ve=(t,e,s,n)=>{if(n){let{i:o,j:a}=Qi(t);if(o!==-1&&a!==-1){let c="",h=u=>{new dt(u,e,s),c+=`\0${s.length-1}n`};for(;o!==-1&&a!==-1;){let u=`\0${s.length}e`;new Ee(t.slice(o+bs,a),e,s),o>0&&h(t.slice(0,o)),c+=u,t=t.slice(a+bs+1),{i:o,j:a}=Qi(t)}return t&&h(t),c}}let{ext:i}=e,l=i.filter(o=>o!=="translate"&&o!=="tvar"),r=Mt(ft({},e),{ext:l});if(i.includes("translate")){let o=[];t=t.replace(/<nowiki>[\s\S]*?<\/nowiki>/giu,a=>(o.push(a),`\0${o.length-1}`)).replace(/<translate( nowrap)?>([\s\S]+?)?<\/translate>/gu,(a,c,h)=>{let u=s.length;return new Sr(c,h&&wt(h,o),r,s),`\0${u}g`}),t=wt(t,o)}return t.replace(Hl[n?1:0](l),(o,a,c,h,u,d,g,p,x)=>{let b=s.length,m="n";if(a)m="e",new Se(a,c,h,u,r,d,s);else if(o.startsWith("<!--")){m="c";let w=o.endsWith("-->");new ye(wt(o,s,1).slice(4,w?-3:void 0),w,e,s)}else d?new qe(d,g&&wt(g,s,1),p&&wt(p,s,1),x,e,s):new dt(o,e,s);return`\0${b}${m}`})}}}),Dl,Gl,Vl,Xl,Ki,Zl,Xe,_a=$({"src/html.ts"(){"use strict";var t,e,s,n,i;B(),jt(),ot(),hi(),_(),E(),Dl=new Set(["if","ifeq","ifexpr","ifexist","iferror","switch"]),Gl=new Set(["b","big","center","cite","code","del","dfn","em","font","i","ins","kbd","mark","pre","q","s","samp","small","strike","strong","sub","sup","tt","u","var"]),Vl=new Set(["strike","big","center","font","tt"]),Xl=[cs()],Xe=(i=class extends(Zl=W){constructor(l,r,o,a,c,h){super(void 0,c,h),T(this,t),T(this,e),T(this,s),T(this,n),this.insertAt(r),this.setAttribute("name",l.toLowerCase()),N(this,t,o),N(this,e,a),N(this,s,l)}get type(){return"html"}get selfClosing(){return f(this,e)}get closing(){return f(this,t)}toString(l){return`<${this.closing?"/":""}${f(this,s)}${super.toString(l)}${f(this,e)?"/":""}>`}text(){let{closing:l}=this,r=f(this,s)+(l?"":super.text());return`<${l?"/":""}${r}${f(this,e)?"/":""}>`}getAttribute(l){return l==="invalid"?this.inTableAttrs()===2:l==="padding"?f(this,s).length+(this.closing?2:1):super.getAttribute(l)}lint(l=this.getAbsoluteIndex(),r){var o;let a=super.lint(l,r),{name:c,parentNode:h,closing:u,selfClosing:d}=this,g=new nt(this,l),p=this.inTableAttrs(),x="h1",b=A.lintConfig.getSeverity(x,"html");if(b&&c==="h1"&&!u){let y=K(this,g,x,"<h1>",b);y.suggestions=[{desc:"h2",range:[l+2,l+3],text:"2"}],a.push(y)}if(x="parsing-order",b=p&&A.lintConfig.getSeverity(x,p===2?"html":"templateInTable"),b){let y=K(this,g,x,"html-in-table",b);p===2&&(y.suggestions=[G(y)]),a.push(y)}if(x="obsolete-tag",b=A.lintConfig.getSeverity(x,c),b&&Vl.has(c)&&a.push(K(this,g,x,"obsolete-tag",b)),x="bold-header",b=A.lintConfig.getSeverity(x,c),b&&(c==="b"||c==="strong")&&((o=this.closest("heading-title,ext"))==null?void 0:o.type)==="heading-title"){let y=K(this,g,x,"bold-in-header",b);y.suggestions=[G(y)],a.push(y)}let{html:[,m,w]}=this.getAttribute("config"),k=w.includes(c),S=m.includes(c),v=!k&&!S;if(x="unmatched-tag",u&&(d||k)||d&&v){if(b=A.lintConfig.getSeverity(x,u?"both":"selfClosing"),b){let y=K(this,g,x,u?"closing-and-self-closing":"invalid-self-closing",b),C=Ds(l),I={desc:A.msg("no-self-closing"),range:[y.endIndex-2,y.endIndex-1],text:""};S?y.suggestions=[C,I]:u?y.fix=k?C:I:y.suggestions=[I,zt(y.endIndex,`></${c}>`,-2)],a.push(y)}}else if(!this.findMatchingTag()){let y=K(this,g,x,u?"unmatched-closing":"unclosed-tag"),C=this.closest("magic-word");if(C&&Dl.has(C.name))b=A.lintConfig.getSeverity(x,"conditional");else if(u)b=A.lintConfig.getSeverity(x,"closing"),y.suggestions=[G(y)];else{b=A.lintConfig.getSeverity(x,"opening");let I=h==null?void 0:h.childNodes;Gl.has(c)&&(I!=null&&I.slice(0,I.indexOf(this)).some(D=>D.type==="html"&&D.name===c&&!D.findMatchingTag())&&(y.suggestions=[zt(l+1,"/")]),this.closest("heading-title")&&(y.rule="format-leakage",b=A.lintConfig.getSeverity("format-leakage",c)))}b&&(y.severity=b,a.push(y))}return a}findMatchingTag(){return Qt(f(this,n),()=>{let{name:l,parentNode:r,closing:o,selfClosing:a}=this,{html:[,c,h]}=this.getAttribute("config"),u=h.includes(l),d=c.includes(l);if(u||d&&a)return this;if(!r)return;let{childNodes:g}=r,p=g.indexOf(this),x=o?g.slice(0,p).reverse():g.slice(p+1),b=[this],{rev:m}=kt;for(let w of x)if(!(!w.is("html")||w.name!==l||d&&f(w,e)))if(f(w,t)===o)b.push(w);else{let k=b.pop();if(k===this)return w;A.viewOnly&&(N(k,n,[m,w]),N(w,n,[m,k]))}if(A.viewOnly)for(let w of b)N(w,n,[m,void 0])},l=>{N(this,n,l),l[1]&&l[1]!==this&&N(l[1],n,[kt.rev,this])})}print(){return super.print({pre:`&lt;${this.closing?"/":""}${f(this,s)}`,post:`${f(this,e)?"/":""}&gt;`})}json(l,r=this.getAbsoluteIndex()){let o=super.json(void 0,r);return Object.assign(o,{closing:this.closing,selfClosing:f(this,e)}),o}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i),Ki=tt(Zl),Xe=Q(Ki,0,"HtmlToken",Xl,Xe),J(Ki,1,Xe)}}),Jl={};st(Jl,{parseHtml:()=>Kl});var Ql,Kl,qa=$({"parser/html.ts"(){"use strict";yi(),_a(),Ql=/^(\/?)([a-z][^\s/>]*)((?:\s|\/(?!>))[^>]*?)?(\/?>)([^<]*)$/iu,Kl=(t,e,s)=>{var n;let{html:i}=e;(n=e.htmlElements)!=null||(e.htmlElements=new Set([...i[0],...i[1],...i[2]]));let l=t.split("<"),r=l.shift();for(let o of l){let a=Ql.exec(o),c=a==null?void 0:a[2],h=c==null?void 0:c.toLowerCase();if(!a||!e.htmlElements.has(h)){r+=`<${o}`;continue}let[,u,,d="",g,p]=a,{length:x}=s,b=new gs(d,"html-attrs",h,e,s),m=b.hasAttr("itemprop");if(h==="meta"&&!(m&&b.hasAttr("content"))||h==="link"&&!(m&&b.hasAttr("href"))){r+=`<${o}`,s.length=x;continue}r+=`\0${s.length}x${p}`,new Xe(c,b,u==="/",g==="/>",e,s)}return r}}}),Yi,Yl=$({"src/table/base.ts"(){"use strict";hi(),E(),fe(),yi(),Yi=class extends cs(1)(W){constructor(t,e,s,n,i,l=[],r){super(void 0,i,l,r),this.append(new te(e,"table-syntax",i,l),new gs(n,"table-attrs",s,i,l))}escape(){}}}}),to,tn,Nt,ws,Ze,Je,ys,eo=$({"src/table/td.ts"(){"use strict";B(),ot(),Js(),_(),E(),Yl(),ys=class extends(tn=Yi,to=[is(!1)],tn){constructor(t,e,s,n=[]){var i;let l=/\||\0\d+!\x7F/u.exec(e!=null?e:""),r=l?e.slice(0,l.index):"";/\[\[|-\{/u.test(r)&&(l=null,r=""),super(/^(?:\n[^\S\n]*(?:[|!]|\|\+|\{\{\s*!\s*\}\}\+?)|(?:\||\{\{\s*!\s*\}\}){2}|!!|\{\{\s*!!\s*\}\})$/u,t,"td",r,s,n),J(ws,5,this),_t(this,Ze),_t(this,Nt,""),l&&([da(this,Nt)._]=l);let o=new W(e==null?void 0:e.slice(((i=l==null?void 0:l.index)!=null?i:NaN)+ut(this,Nt).length),s,n);o.type="td-inner",o.setAttribute("stage",4),this.insertAt(o)}get type(){return"td"}get rowspan(){return this.getAttr("rowspan")}get colspan(){return this.getAttr("colspan")}get subtype(){return Es(this,Ze,Je).call(this).subtype}afterBuild(){ut(this,Nt).includes("\0")&&vt(this,Nt,this.buildFromStr(ut(this,Nt),0)),super.afterBuild()}toString(t){let{childNodes:[e,s,n]}=this;return e.toString(t)+s.toString(t)+ut(this,Nt)+n.toString(t)}text(){let{childNodes:[t,e,s]}=this;return t.text()+e.text()+ut(this,Nt)+s.text()}getGaps(t){return t===1?ut(this,Nt).length:0}lint(t=this.getAbsoluteIndex(),e){let s=super.lint(t,e),n=new nt(this,t+this.getRelativeIndex(this.length-1)),i="pipe-like",l=["td","double"].map(r=>A.lintConfig.getSeverity(i,r));for(let r of this.lastChild.childNodes)if(r.type==="text"){let{data:o}=r;if(o.includes("|")){let a=o.includes("||"),c=l[a?1:0];if(c){let h=R(r,n,i,"pipe-in-table",c);if(a){let u={caption:"|+",td:"|",th:"!"}[this.subtype];h.fix=Ct(h,"newline",o.replace(/\|\|/gu,`
${u}`))}else h.suggestions=[Xs(h.startIndex,o)];s.push(h)}}}return s}isIndependent(){return this.firstChild.text().startsWith(`
`)}getAttr(t){let e=super.getAttr(t);return t==="rowspan"||t==="colspan"?parseInt(e)||1:e}escape(){}print(){let{childNodes:[t,e,s]}=this;return`<span class="wpb-td">${t.print()}${e.print()}${ut(this,Nt)}${s.print()}</span>`}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e),{rowspan:n,colspan:i}=this;return Object.assign(s,{subtype:this.subtype},n!==1&&{rowspan:n},i!==1&&{colspan:i}),s}},ws=tt(tn),Nt=new WeakMap,Ze=new WeakSet,Je=function(){var t;let e=this.firstChild.text(),s=e.slice(-1),n="td";if(s==="!"?n="th":s==="+"&&(n="caption"),this.isIndependent())return{subtype:n};let{previousSibling:i}=this;return ft({},Es(t=i,Ze,Je).call(t))},Je=Q(ws,17,"#getSyntax",to,Ze,Je),Ps(ws,ys)}}),en,so=$({"src/table/trBase.ts"(){"use strict";B(),_(),Yl(),eo(),en=class extends Yi{lint(t=this.getAbsoluteIndex(),e){let s=super.lint(t,e),n=this.childNodes.find(({type:o})=>o==="table-inter");if(!n)return s;let i=Ne(n),l="fostered-content",r=i&&A.lintConfig.getSeverity(l,i===2?void 0:"transclusion");if(r){let o=R(n,{start:t},l,"content-outside-table",r);o.startIndex++,o.startLine++,o.startCol=0,s.push(o)}return s}getRowCount(){return Number(this.childNodes.some(t=>t instanceof ys&&t.isIndependent()&&!t.firstChild.text().endsWith("+")))}}}}),io,no,ro,lo,sn,Ss,ks,za=$({"src/table/index.ts"(){"use strict";B(),jt(),ot(),Js(),_(),so(),fe(),io=(t,e)=>new Array(t).fill(void 0).map((s,n)=>e(n)),no=({type:t})=>t==="tr"||t==="table-syntax",ro=class extends Array{},ks=class extends(sn=en,lo=[is(!1)],sn){constructor(t,e,s,n){super(/^(?:\{\||\{\{\{\s*!\s*\}\}|\{\{\s*\(!\s*\}\})$/u,t,"table",e,s,n,{}),J(Ss,5,this)}get type(){return"table"}get closed(){return this.lastChild.is("table-syntax")}lint(t=this.getAbsoluteIndex(),e){let s=super.lint(t,e),n=new nt(this,t),i=["unclosed-table","table-layout"],l=i.map(r=>A.lintConfig.getSeverity(r));if(l[0]&&!this.closed&&s.push(R(this.firstChild,n,i[0],A.msg("unclosed","table"),l[0])),l[1]){let r=this.getLayout(),{length:o}=r;if(o>1){let a=1,c=1/0,h=0;for(;h<o;h++){let u=r[h],d=u.length;if(d<a)break;d<c&&(c=d);let g=u.indexOf(u[d-1])+1;if(g>c)break;g>a&&(a=g)}if(h<o){let u=this.getNthRow(h),d=R(u,n,i[1],"inconsistent-table",l[1]);d.startIndex++,d.startLine++,d.startCol=0,s.push(d)}}}return s}close(t=`
|}`,e){let s=this.getAttribute("config"),n=this.getAttribute("accum");kt.run(()=>{let i=new te(e?t:void 0,"table-syntax",s,n);super.insertAt(i)})}getLayout(t){let e=this.getAllRows(),{length:s}=e,n=ro.from(io(s,()=>[]));for(let i=0;i<n.length;i++){let l=n[i],r=0,o=0,a;for(let c of e[i].childNodes.slice(2))if(c.is("td")){if(c.isIndependent()&&(a=c.subtype!=="caption"),a){let h={row:i,column:r},{rowspan:u,colspan:d}=c;for(r++;l[o];)o++;for(let g=i;g<Math.min(i+u,s);g++)for(let p=o;p<o+d;p++)n[g][p]=h;o+=d}}else if(no(c))break}return n}getAllRows(){return[...super.getRowCount()?[this]:[],...this.childNodes.slice(1).filter(t=>t.is("tr")&&t.getRowCount()>0)]}getNthRow(t,e,s){let n=super.getRowCount();if(t===0&&n)return this;n&&t--;for(let i of this.childNodes.slice(2)){let{type:l}=i;if(l==="tr"&&i.getRowCount()&&(t--,t<0))return i}}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e);return s.closed=this.closed,s}},Ss=tt(sn),Q(Ss,1,"getLayout",lo,ks),Ps(Ss,ks)}}),oo,Ua=$({"src/table/tr.ts"(){"use strict";so(),oo=class extends en{get type(){return"tr"}constructor(t,e,s,n){super(/^\n[^\S\n]*(?:\|-+|\{\{\s*!\s*\}\}-+|\{\{\s*!-\s*\}\}-*)$/u,t,"tr",e,s,n)}}}}),nn,ao=$({"src/nowiki/listBase.ts"(){"use strict";ee(),nn=class extends It{get indent(){return this.innerText.split(":").length-1}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e),{indent:n}=this;return n&&(s.indent=n),s}}}}),rn,co=$({"src/nowiki/dd.ts"(){"use strict";ao(),rn=class extends nn{get type(){return"dd"}}}}),uo={};st(uo,{parseTable:()=>go});var ho,ln,go,Ba=$({"parser/table.ts"(){"use strict";E(),za(),Ua(),eo(),co(),ho=t=>t.lastChild.constructor!==W,ln=(t,e)=>t.is("td")?e.pop():t,go=({firstChild:{data:t},type:e,name:s},n,i)=>{let l=[],r=t.split(`
`),o=e==="root"||e==="parameter-value"||e==="ext-inner"&&s==="poem"?"":`
${r.shift()}`,a,c=(h,u)=>{if(!u){o+=h;return}let{lastChild:d}=u;if(ho(u)){let g=new W(h,n,i);g.type="table-inter",g.setAttribute("stage",3),u.insertAt(g)}else d.setText(d.toString()+h)};for(let h of r){a=l.pop();let[u]=/^(?:\s|\0\d+[cno]\x7F)*/u.exec(h),d=h.slice(u.length),g=/^(:*)((?:\s|\0\d+[cn]\x7F)*)(\{\||\{(?:\0\d+[cn]\x7F)*\0\d+!\x7F|\0\d+\{\x7F)(.*)$/u.exec(d);if(g){for(;a&&!a.is("td");)a=l.pop();let[,k,S,v,y]=g;k&&new rn(k,n,i),c(`
${u}${k&&`\0${i.length-1}d`}${S}\0${i.length}b`,a),l.push(...a?[a]:[],new ks(v,y,n,i));continue}else if(!a){o+=`
${h}`;continue}let p=/^(?:(\|\}|\0\d+!\x7F\}|\0\d+\}\x7F)|(\|-+|\0\d+!\x7F-+|\0\d+-\x7F-*)(?!-)|(!|(?:\||\0\d+!\x7F)\+?))(.*)$/u.exec(d);if(!p){c(`
${h}`,a),l.push(a);continue}let[,x,b,m,w]=p;if(x){for(;!a.is("table");)a=l.pop();a.close(`
${u}${x}`,!0),c(w,l[l.length-1])}else if(b){a=ln(a,l),a.is("tr")&&(a=l.pop());let k=new oo(`
${u}${b}`,w,n,i);l.push(a,k),a.insertAt(k)}else{a=ln(a,l);let k=m==="!"?/!!|(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu:/(?:\||\0\d+!\x7F){2}|\0\d+\+\x7F/gu,S=k.exec(w),v=0,y=`
${u}${m}`,C=I=>{let D=new ys(y,w.slice(v,S==null?void 0:S.index),n,i);return I.insertAt(D),D};for(;S;)C(a),{lastIndex:v}=k,[y]=S,S=k.exec(w);l.push(a,C(a))}}return o.slice(1)}}}),po,Ha=$({"src/nowiki/hr.ts"(){"use strict";ee(),po=class extends It{get type(){return"hr"}}}}),fo,on,mo,Qe,Da=$({"src/nowiki/doubleUnderscore.ts"(){"use strict";pe(),Ut(),ee(),fo=[Yt(),Pt("__")],Qe=class extends(mo=It){get type(){return"double-underscore"}constructor(t,e,s,n){var i,l;super(t,s,n);let r=t.toLowerCase(),{doubleUnderscore:[,,o,a]}=s;this.setAttribute("name",(l=e?(i=a==null?void 0:a[t])==null?void 0:i.toLowerCase():o==null?void 0:o[r])!=null?l:r)}toString(){return`__${this.innerText}__`}print(){return super.print({pre:"__",post:"__"})}},on=tt(mo),Qe=Q(on,0,"DoubleUnderscoreToken",fo,Qe),J(on,1,Qe)}}),xo={};st(xo,{parseHrAndDoubleUnderscore:()=>bo});var bo,Ga=$({"parser/hrAndDoubleUnderscore.ts"(){"use strict";Ha(),Da(),Ur(),bo=({firstChild:{data:t},type:e,name:s},n,i)=>{var l,r,o;let{doubleUnderscore:[a,c,h]}=n;return(l=n.insensitiveDoubleUnderscore)!=null||(n.insensitiveDoubleUnderscore=new Set(a)),(r=n.sensitiveDoubleUnderscore)!=null||(n.sensitiveDoubleUnderscore=new Set(c)),(o=n.regexHrAndDoubleUnderscore)!=null||(n.regexHrAndDoubleUnderscore=new RegExp(`__(${[...a,...c].join("|")})__`,"giu")),e!=="root"&&(e!=="ext-inner"||s!=="poem")&&(t=`\0${t}`),t=t.replace(/^((?:\0\d+[cno]\x7F)*)(-{4,})/gmu,(u,d,g)=>(new po(g,n,i),`${d}\0${i.length-1}r`)).replace(n.regexHrAndDoubleUnderscore,(u,d)=>{var g;let p=n.sensitiveDoubleUnderscore.has(d),x=d.toLowerCase(),b=n.insensitiveDoubleUnderscore.has(x);return p||b?(new Qe(d,p,n,i),`\0${i.length-1}${b&&((g=h==null?void 0:h[x])!=null?g:x)==="toc"?"u":"n"}`):u}),n.excludes.includes("heading")||(t=t.replace(/^((?:\0\d+[cn]\x7F)*)(={1,6})(.+)\2((?:\s|\0\d+[cn]\x7F)*)$/gmu,(u,d,g,p,x)=>{let b=`${d}\0${i.length}h`;return new xe(g.length,[p,x],n,i),b})),e==="root"||e==="ext-inner"&&s==="poem"?t:t.slice(1)}}}),vo,Va=$({"src/nowiki/quote.ts"(){"use strict";var t,e;B(),ot(),_(),ee(),vo=(e=class extends It{constructor(s,n,i,l){super(s,i,l),T(this,t),N(this,t,n)}get type(){return"quote"}get bold(){return this.innerText.length!==2}get italic(){return this.innerText.length!==3}get closing(){return ft(ft({},this.bold?{bold:f(this,t).bold}:void 0),this.italic?{italic:f(this,t).italic}:void 0)}text(){let{parentNode:s,innerText:n}=this;return s!=null&&s.is("image-parameter")&&s.name!=="caption"?"":n}lint(s=this.getAbsoluteIndex()){var n;let{previousSibling:i,bold:l,closing:r}=this,o=(i==null?void 0:i.type)==="text"?i.data:void 0,a=[],c=new nt(this,s),h=["lonely-apos","bold-header"],u=[void 0,"word"].map(g=>A.lintConfig.getSeverity(h[0],g)),d=A.lintConfig.getSeverity(h[1]);if(o!=null&&o.endsWith("'")){let g=u[(r.bold||r.italic)&&/[a-z\d]'$/iu.test(o)?1:0];if(g){let p=K(this,c,h[0],A.msg("lonely","'"),g),{startLine:x,startCol:b}=p,[,{length:m}]=/(?:^|[^'])('+)$/u.exec(o),w=s-m,k=Mt(ft({},p),{startIndex:w,endIndex:s,endLine:x,startCol:b-m,endCol:b});k.suggestions=[ge(w,"&apos;",m),G(k)],a.push(k)}}if(d&&l&&((n=this.closest("heading-title,ext"))==null?void 0:n.type)==="heading-title"){let g=K(this,c,h[1],"bold-in-header",d);g.suggestions=[G(g)],a.push(g)}return a}json(s,n=this.getAbsoluteIndex()){let i=super.json(void 0,n);return Object.assign(i,{bold:this.bold,italic:this.italic}),i}},t=new WeakMap,e)}}),wo={};st(wo,{parseQuotes:()=>an});var an,yo=$({"parser/quotes.ts"(){"use strict";Va(),an=(t,e,s,n)=>{var i;let l=t.split(/('{2,})/u),{length:r}=l;if(r===1)return t;let o=0,a=0,c,h,u;for(let p=1;p<r;p+=2){let x=l[p].length;switch(x){case 2:a++;break;case 4:l[p-1]+="'",l[p]="'''";case 3:if(o++,c!==void 0)break;l[p-1].endsWith(" ")?h===void 0&&u===void 0&&(u=p):l[p-1].slice(-2,-1)===" "?c=p:h!=null||(h=p);break;default:l[p-1]+="'".repeat(x-5),l[p]="'''''",a++,o++}}if(a%2===1&&o%2===1){let p=(i=c!=null?c:h)!=null?i:u;p!==void 0&&(l[p]="''",l[p-1]+="'")}let d=!0,g=!0;for(let p=1;p<r;p+=2){let x=l[p].length,b=x!==2,m=x!==3;b&&(d=!d),m&&(g=!g),new vo(l[p],{bold:b&&d,italic:m&&g},e,s),l[p]=`\0${s.length-1}q`}return l.join("")}}}),So={};st(So,{parseExternalLinks:()=>cn});var cn,ko=$({"parser/externalLinks.ts"(){"use strict";ht(),Cl(),Hi(),cn=(t,e,s,n)=>{var i;return(i=e.regexExternalLinks)!=null||(e.regexExternalLinks=new RegExp(String.raw`\[((?:\0\d+[cn]\x7F)*(?:\0\d+f\x7F|(?:(?:${e.protocol}|//)${oe}|\0\d+m\x7F)${ae}(?=[[\]<>"\t${qt}]|\0\d)))([${qt}]*(?![${qt}]))([^\]\x01-\x08\x0A-\x1F\uFFFD]*)\]`,"giu")),t.replace(e.regexExternalLinks,(l,r,o,a)=>{let{length:c}=s,h=/&[lg]t;/u.exec(r);return h&&(o="",a=r.slice(h.index)+o+a,r=r.slice(0,h.index)),n?(new De(r,"ext-link-url",e,s),`[\0${c}f${o}${a}]`):(new we(r,o,a,e,s),`\0${c}w`)})}}}),Ao,Xa=$({"src/link/category.ts"(){"use strict";ht(),os(),Ao=class extends Ht{get type(){return"category"}get sortkey(){let{childNodes:[,t]}=this;return t&&Ce(t.text())}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e),{sortkey:n}=this;return n&&(s.sortkey=n),s}}}}),$o={};st($o,{parseLinks:()=>un});var Co,un,Za=$({"parser/links.ts"(){"use strict";_(),yo(),ko(),yl(),pl(),Xa(),Co=/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(\||\0\d+!\x7F)([\s\S]*)$/u,un=(t,e,s,n)=>{var i;(i=e.regexLinks)!=null||(e.regexLinks=new RegExp(String.raw`^\s*(?:${e.protocol}|//)`,"iu"));let l=e.inExt?/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)([\s\S]*?[^\]]))?\]\]([\s\S]*)$/u:/^((?:(?!\0\d+!\x7F)[^\n[\]{}|])+)(?:(\||\0\d+!\x7F)([\s\S]*?[^\]])?)?\]\]([\s\S]*)$/u,r=t.split("[["),o=r.shift();for(let a=0;a<r.length;a++){let c=!1,h,u,d,g,p=r[a],x=l.exec(p);if(x)[,h,u,d,g]=x,g.startsWith("]")&&d!=null&&d.includes("[")&&(d+="]",g=g.slice(1));else{let S=Co.exec(p);S&&(c=!0,[,h,u,d]=S)}if(h===void 0||e.regexLinks.test(h)||/\0\d+[exhbru]\x7F/u.test(h)){o+=`[[${p}`;continue}let b=h.trim().startsWith(":");if(b&&c){o+=`[[${p}`;continue}let{ns:m,valid:w}=A.normalizeTitle(h,0,!1,e,{halfParsed:!0,temporary:!0,decode:!0,selfLink:!0});if(w){if(c){if(m!==6){o+=`[[${p}`;continue}let S=!1;for(a++;a<r.length;a++){let v=r[a],y=v.split("]]");if(y.length>2){S=!0,d+=`[[${y[0]}]]${y[1]}`,g=y.slice(2).join("]]");break}else if(y.length===2)d+=`[[${y[0]}]]${y[1]}`;else{d+=`[[${v}`;break}}if(d=un(d,e,s,n),!S){o+=`[[${h}${u}${d}`;continue}}}else{o+=`[[${p}`;continue}d&&(d=an(d,e,s,n));let k=Bi;b||(m===6?(d&&(d=cn(d,e,s,!0)),k=qi):m===14&&(k=Ao)),d===void 0&&u&&(d=""),o+=`\0${s.length}l${g}`,new k(h,d,e,s,u)}return o}}}),Io={};st(Io,{parseMagicLinks:()=>To});var hn,dn,gn,pn,To,Ja=$({"parser/magicLinks.ts"(){"use strict";ht(),Hi(),hn=String.raw`[${qt}\t]|&nbsp;|&#0*160;|&#x0*a0;`,dn=`(?:${hn})+`,gn=`(?:${hn}|-)`,pn=String.raw`(?:RFC|PMID)${dn}\d+\b|ISBN${dn}(?:97[89]${gn}?)?(?:\d${gn}?){9}[\dx]\b`,To=(t,e,s)=>{if(!e.regexMagicLinks)try{e.regexMagicLinks=new RegExp(String.raw`(^|[^\p{L}\p{N}_])(?:(?:${e.protocol})(${oe}${ae})|${pn})`,"giu")}catch(n){e.regexMagicLinks=new RegExp(String.raw`(^|\W)(?:(?:${e.protocol})(${oe}${ae})|${pn})`,"giu")}return t.replace(e.regexMagicLinks,(n,i,l)=>{let r=i?n.slice(i.length):n;if(l){let o="",a=/&(?:lt|gt|nbsp|#x0*(?:3[ce]|a0)|#0*(?:6[02]|160));/iu.exec(r);a&&(o=r.slice(a.index),r=r.slice(0,a.index));let c=r.includes("(")?/[^,;\\.:!?][,;\\.:!?]+$/u:/[^,;\\.:!?)][,;\\.:!?)]+$/u,h=c.exec(r);if(h){let u=1;h[0][1]===";"&&/&(?:[a-z]+|#x[\da-f]+|#\d+)$/iu.test(r.slice(0,h.index))&&(u=2),o=r.slice(h.index+u)+o,r=r.slice(0,h.index+u)}return o.length>=l.length?n:(new De(r,void 0,e,s),`${i}\0${s.length-1}w${o}`)}else if(!/^(?:RFC|PMID|ISBN)/u.test(r))return n;return new De(r,"magic-link",e,s),`${i}\0${s.length-1}i`})}}}),No,Qa=$({"util/html.ts"(){"use strict";No=(t,e)=>t.startsWith(e)?e.length:[...e].findIndex((s,n)=>s!==t[n])}}),Fo,Ka=$({"src/nowiki/list.ts"(){"use strict";ao(),Fo=class extends nn{get type(){return"list"}}}}),Wo={};st(Wo,{parseList:()=>jo});var jo,Ya=$({"parser/list.ts"(){"use strict";Qa(),Ka(),co(),jo=(t,e,s,n)=>{let i=/^((?:\0\d+[cno]\x7F)*)([;:*#]+)(\s*)/u.exec(t);if(!i)return e.lastPrefix="",t;let[l,r,o,a]=i,c=o.replace(/;/gu,":"),h=No(c,e.lastPrefix),u=((h>1?o.slice(h-1):o)+a).split(/(?=;)/u),d=u[0].startsWith(";"),g=u.length-(d?0:1);if(h>1){let P=o.slice(0,h-1);if(d){let q=P.split(/(?=;)/u);u.unshift(...q),g+=P.includes(";")?q.length:0}else u[0]=P+u[0]}e.lastPrefix=c;let p=r+u.map((P,q)=>`\0${n.length+q}d`).join("")+t.slice(l.length);for(let P of u)new Fo(P,s,n);if(!g)return p;let{html:[x,,b]}=s,m=/:+|-\{|\0\d+[xq]\x7F/gu,w=m,k=w.exec(p),S=0,v=!1,y=!1,C=0,I=(P,q)=>(new rn(P,s,n),`${p.slice(0,q)}\0${n.length-1}d${p.slice(q+P.length)}`),D=P=>{P?S&&S--:S++};for(;k&&g;){let{0:P,index:q}=k;if(P==="-{"){if(!C){let{lastIndex:U}=w;w=/-\{|\}-/gu,w.lastIndex=U}C++}else if(P==="}-"){if(C--,!C){let{lastIndex:U}=w;w=m,w.lastIndex=U}}else if(P.endsWith("x")){let{name:U,closing:O,selfClosing:V}=n[Number(P.slice(1,-2))];(x.includes(U)||!V&&!b.includes(U))&&D(O)}else if(P.endsWith("q")){let{bold:U,italic:O}=n[Number(P.slice(1,-2))];U&&(D(v),v=!v),O&&(D(y),y=!y)}else if(S===0){if(P.length>=g)return I(P.slice(0,g),q);g-=P.length,w.lastIndex=q+4+String(n.length).length,p=I(P,q)}k=w.exec(p)}return p}}}),As,Lo,fn,Mo,Ke,tc=$({"src/converterFlags.ts"(){"use strict";var t,e;B(),ot(),as(),_(),E(),Bt(),As=new Set(["A","T","R","D","-","H","N"]),Lo=[_e()],Ke=(e=class extends(Mo=W){constructor(s,n,i=[]){super(void 0,n,i,{}),T(this,t),this.safeAppend(s.map(l=>new mt(l,"converter-flag",n,i)))}get type(){return"converter-flags"}afterBuild(){N(this,t,this.childNodes.map(s=>s.text().trim())),super.afterBuild()}toString(s){return super.toString(s,";")}text(){return super.text(";")}getUnknownFlags(){return new Set(f(this,t).filter(s=>/\{{3}[^{}]+\}{3}/u.test(s)))}getVariantFlags(){let s=new Set(this.getAttribute("config").variants);return new Set(f(this,t).filter(n=>s.has(n)))}isInvalidFlag(s,n,i,l){return typeof s=="object"&&(s=s.text().trim(),n=this.getVariantFlags(),i=this.getUnknownFlags(),l=new Set(f(this,t).filter(r=>As.has(r)))),!!s&&!n.has(s)&&!i.has(s)&&(n.size>0||!l.has(s))}lint(s=this.getAbsoluteIndex(),n){let i=this.getVariantFlags(),l=this.getUnknownFlags(),r=new Set(f(this,t).filter(d=>As.has(d))),o=f(this,t).filter(d=>!d).length,a=f(this,t).length-l.size-o,c=super.lint(s,n);if(i.size===a||r.size===a)return c;let h="no-ignored",u=A.lintConfig.getSeverity(h,"conversionFlag");if(u){let d=new nt(this,s);for(let g=0;g<this.length;g++){let p=this.childNodes[g],x=p.text().trim();if(this.isInvalidFlag(x,i,l,r)){let b=R(p,d,h,"invalid-conversion-flag",u);i.size===0&&As.has(x.toUpperCase())?b.fix=Vs(b,x):b.suggestions=[G(b,g&&-1)],c.push(b)}}}return c}print(){return super.print({sep:";"})}},t=new WeakMap,e),fn=tt(Mo),Ke=Q(fn,0,"ConverterFlagsToken",Lo,Ke),J(fn,1,Ke)}}),$s,ec=$({"src/converterRule.ts"(){"use strict";_(),E(),Bt(),$s=class extends W{get type(){return"converter-rule"}get variant(){var t,e;return(e=(t=this.childNodes[this.length-2])==null?void 0:t.text().trim().toLowerCase())!=null?e:""}constructor(t,e=!0,s=A.getConfig(),n=[]){super(void 0,s,n);let i=t.indexOf(":"),l=t.slice(0,i).indexOf("=>"),r=l===-1?t.slice(0,i):t.slice(l+2,i);e&&s.variants.includes(r.trim().toLowerCase())?(super.insertAt(new mt(r,"converter-rule-variant",s,n)),super.insertAt(new mt(t.slice(i+1),"converter-rule-to",s,n)),l!==-1&&super.insertAt(new mt(t.slice(0,l),"converter-rule-from",s,n),0)):super.insertAt(new mt(t,"converter-rule-to",s,n))}toString(t){let{childNodes:e,firstChild:s,lastChild:n}=this;return e.length===3?`${s.toString(t)}=>${e[1].toString(t)}:${n.toString(t)}`:super.toString(t,":")}text(){let{childNodes:t,firstChild:e,lastChild:s}=this;return t.length===3?`${e.text()}=>${t[1].text()}:${s.text()}`:super.text(":")}getGaps(t){return t===0&&this.length===3?2:1}print(){let{childNodes:t}=this;if(t.length===3){let[e,s,n]=t;return`<span class="wpb-converter-rule">${e.print()}=>${s.print()}:${n.print()}</span>`}return super.print({sep:":"})}json(t,e=this.getAbsoluteIndex()){let s=super.json(void 0,e);return s.variant=this.variant,s}}}}),Oo,mn,Po,Ye,sc=$({"src/converter.ts"(){"use strict";ht(),Ut(),Ot(),E(),tc(),ec(),Oo=[Wt,Pt("-{")],Ye=class extends(Po=W){get type(){return"converter"}constructor(t,e,s,n=[]){super(void 0,s,n),this.insertAt(new Ke(t,s,n));let[i]=e,l=i.includes(":"),r=new $s(i,l,s,n);l&&r.length===1||!l&&e.length===2&&!yt(e[1]).trim()?this.insertAt(new $s(e.join(";"),!1,s,n)):this.append(r,...e.slice(1).map(o=>new $s(o,!0,s,n)))}toString(t){let{childNodes:[e,...s]}=this;return`-{${e.toString(t)}${e.length>0?"|":""}${s.map(n=>n.toString(t)).join(";")}}-`}text(){let{childNodes:[t,...e]}=this;return`-{${t.text()}|${Xt(e,";")}}-`}getGaps(t){return t||this.firstChild.length>0?1:0}print(){let{childNodes:[t,...e]}=this;return`<span class="wpb-converter">-{${t.print()}${t.length>0?"|":""}${he(e,{sep:";"})}}-</span>`}},mn=tt(Po),Ye=Q(mn,0,"ConverterToken",Oo,Ye),J(mn,1,Ye)}}),Ro={};st(Ro,{parseConverter:()=>Eo});var Eo,ic=$({"parser/converter.ts"(){"use strict";sc(),Eo=(t,e,s)=>{var n;(n=e.regexConverter)!=null||(e.regexConverter=new RegExp(String.raw`;(?=(?:[^;]*?=>)?\s*(?:${e.variants.join("|")})\s*:|(?:\s|\0\d+[cn]\x7F)*$)`,"iu"));let i=/-\{/gu,l=/-\{|\}-/gu,r=[],o=i,a=o.exec(t);for(;a;){let{0:c,index:h}=a;if(c==="}-"){let u=r.pop(),{length:d}=s,g=t.slice(u.index+2,h),p=g.indexOf("|"),[x,b]=p===-1?[[],g]:[g.slice(0,p).split(";"),g.slice(p+1)],m=b.replace(/(&[#a-z\d]+);/giu,"$1"),w=m.split(e.regexConverter).map(k=>k.replace(/\x01/gu,";"));new Ye(x,w,e,s),t=`${t.slice(0,u.index)}\0${d}v${t.slice(h+2)}`,r.length===0&&(o=i),o.lastIndex=u.index+3+String(d).length}else r.push(a),o=l,o.lastIndex=h+2;a=o.exec(t)}return t}}}),Cs={};st(Cs,{Token:()=>W});var _o,W,E=$({"src/index.ts"(){"use strict";var t,e,s,n,i,l,r,o,a,c,h,u,d,g,p,x,b,m,w,k,S;ht(),Zt(),B(),jt(),_(),xa(),ba(),_o=["category","html-attr#id,ext-attr#id,table-attr#id"],W=(S=class extends Pe{constructor(v,y=A.getConfig(),C=[],I){super(),T(this,o),T(this,t,"plain"),T(this,e,0),T(this,s),T(this,n),T(this,i),T(this,l,!1),T(this,r),typeof v=="string"&&this.insertAt(v),N(this,s,y),N(this,n,C),C.push(this)}get type(){return f(this,t)}set type(v){N(this,t,v)}parseOnce(v=f(this,e),y=!1,C){if(v<f(this,e)||this.length===0||!this.isPlain())return this;if(f(this,e)>=St)return this;switch(v){case 0:if(this.type==="root"){f(this,n).pop();let I=M(this,o,a).call(this);y&&(y=!I)}N(this,i,y),M(this,o,c).call(this,y);break;case 1:M(this,o,h).call(this);break;case 2:M(this,o,u).call(this);break;case 3:M(this,o,d).call(this);break;case 4:M(this,o,g).call(this);break;case 5:M(this,o,p).call(this,C);break;case 6:M(this,o,x).call(this,C);break;case 7:M(this,o,b).call(this);break;case 8:M(this,o,m).call(this);break;case 9:M(this,o,w).call(this);break;case 10:M(this,o,k).call(this)}if(this.type==="root")for(let I of f(this,n))I==null||I.parseOnce(v,y,C);return ra(this,e)._++,this}buildFromStr(v,y){let C=v.split(/[\0\x7F]/u).map((I,D)=>{if(D%2===0)return new si(I);if(isNaN(I.slice(-1)))return f(this,n)[Number(I.slice(0,-1))];throw new Error(`Failed to build! Unrecognized token: ${I}`)});return y===0?C.map(String).join(""):y===1?Xt(C):C}build(){N(this,e,St);let{length:v,firstChild:y}=this,C=y==null?void 0:y.toString();if(v===1&&y.type==="text"&&C.includes("\0")&&(xn(this,0,1,this.buildFromStr(C)),this.normalize(),this.type==="root"))for(let I of f(this,n))I==null||I.build()}afterBuild(){if(this.type==="root")for(let v of f(this,n))v==null||v.afterBuild();N(this,l,!0)}parse(v=St,y,C){for(v=Math.min(v,St);f(this,e)<v;)this.parseOnce(f(this,e),y,C);return v&&(this.build(),this.afterBuild()),this}isPlain(){return this.constructor===S}getAttribute(v){var y;switch(v){case"config":return f(this,s);case"include":return(y=f(this,i))!=null?y:!!f(this.getRootNode(),i);case"accum":return f(this,n);case"built":return f(this,l);case"stage":return f(this,e);case"invalid":return this.type==="table-inter"&&Ne(this)===2;default:return super.getAttribute(v)}}setAttribute(v,y){switch(v){case"stage":f(this,e)===0&&this.type==="root"&&f(this,n).shift(),N(this,e,y);break;default:super.setAttribute(v,y)}}insertAt(v,y=this.length){let C=typeof v=="string"?new si(v):v;super.insertAt(C,y);let{type:I}=C;return I==="root"&&(C.type="plain"),C}normalizeTitle(v,y=0,C){return A.normalizeTitle(v,y,f(this,i),f(this,s),C)}inTableAttrs(){var v,y;return((v=this.closest("table-attrs,ext"))==null?void 0:v.type)==="table-attrs"&&((y=this.closest("table-attrs,arg,magic-word,template"))!=null&&y.is("table-attrs")?2:1)}inHtmlAttrs(){var v;return(v=this.closest("html-attrs,ext"))!=null&&v.is("html-attrs")?2:this.inTableAttrs()}lint(v=this.getAbsoluteIndex(),y){var C;let I=super.lint(v,y);if(this.type==="root"){let D=new Map,P="no-duplicate",q=["category","id"].map(j=>A.lintConfig.getSeverity(P,j)),U=_o.filter((j,F)=>q[F]).join();if(U){for(let j of this.querySelectorAll(U)){let F;if(j.is("category"))F=j.name;else{let H=j.getValue();H&&H!==!0&&(F=`#${H}`)}if(F){let H=D.get(F);H?H.add(j):D.set(F,new Set([j]))}}for(let[j,F]of D)if(F.size>1&&!j.startsWith("#mw-customcollapsible-")){let H=!j.startsWith("#"),Y=`duplicate-${H?"category":"id"}`,gt=q[H?0:1];I.push(...[...F].map(rt=>{let at=K(rt,{start:rt.getAbsoluteIndex()},P,Y,gt);return H&&(at.suggestions=[G(at)]),at}))}}let O=/<!--\s*lint-(disable(?:(?:-next)?-line)?|enable)(\s[\sa-z,-]*)?-->/gu,V=this.toString(),lt=[],et=O.exec(V);for(;et;){let{1:j,index:F}=et,H=(C=et[2])==null?void 0:C.trim();lt.push({line:this.posFromIndex(F).top+(j==="disable-line"?0:1),from:j==="disable"?O.lastIndex:void 0,to:j==="enable"?O.lastIndex:void 0,rules:H?new Set(H.split(",").map(Y=>Y.trim())):void 0}),et=O.exec(V)}if(I=I.filter(({rule:j,startLine:F,startIndex:H})=>{let Y={pos:0};for(let{line:gt,from:rt,to:at,rules:Ft}of lt){if(gt>F+1)break;if(!(Ft&&!Ft.has(j))){if(gt===F&&rt===void 0&&at===void 0)return!1;rt<=H&&rt>Y.pos?(Y.pos=rt,Y.type="from"):at<=H&&at>Y.pos&&(Y.pos=at,Y.type="to")}}return Y.type!=="from"}),I.some(({fix:j})=>j)){let j=I.map(({fix:Y})=>Y).filter(Boolean).sort(({range:[Y,gt]},{range:[rt,at]})=>gt===at?rt-Y:at-gt),F=1/0,H=V;for(let{range:[Y,gt],text:rt}of j)gt<=F&&(H=H.slice(0,Y)+rt+H.slice(gt),F=Y);Object.assign(I,{output:H})}}return I}toString(v,y){return v?super.toString(!0,y):Qt(f(this,r),()=>super.toString(!1,y),C=>{let I=this.getRootNode();I.type==="root"&&f(I,l)&&N(this,r,C)})}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakMap,l=new WeakMap,r=new WeakMap,o=new WeakSet,a=function(){let{parseRedirect:v}=(ya(),Z(mr)),y=this.firstChild.toString(),C=v(y,f(this,s),f(this,n));return C&&this.setText(C),!!C},c=function(v){let{parseCommentAndExt:y}=(vs(),Z(Ul));this.setText(y(this.firstChild.toString(),f(this,s),f(this,n),v))},h=function(){let{parseBraces:v}=(Li(),Z(Qr)),y=this.type==="root"?this.firstChild.toString():`\0${this.firstChild.toString()}`,C=v(y,f(this,s),f(this,n));this.setText(this.type==="root"?C:C.slice(1))},u=function(){if(f(this,s).excludes.includes("html"))return;let{parseHtml:v}=(qa(),Z(Jl));this.setText(v(this.firstChild.toString(),f(this,s),f(this,n)))},d=function(){if(f(this,s).excludes.includes("table"))return;let{parseTable:v}=(Ba(),Z(uo));this.setText(v(this,f(this,s),f(this,n)))},g=function(){if(f(this,s).excludes.includes("hr"))return;let{parseHrAndDoubleUnderscore:v}=(Ga(),Z(xo));this.setText(v(this,f(this,s),f(this,n)))},p=function(v){let{parseLinks:y}=(Za(),Z($o));this.setText(y(this.firstChild.toString(),f(this,s),f(this,n),v))},x=function(v){if(f(this,s).excludes.includes("quote"))return;let{parseQuotes:y}=(yo(),Z(wo)),C=this.firstChild.toString().split(`
`);for(let I=0;I<C.length;I++)C[I]=y(C[I],f(this,s),f(this,n),v);this.setText(C.join(`
`))},b=function(){if(f(this,s).excludes.includes("extLink"))return;let{parseExternalLinks:v}=(ko(),Z(So));this.setText(v(this.firstChild.toString(),f(this,s),f(this,n)))},m=function(){if(f(this,s).excludes.includes("magicLink"))return;let{parseMagicLinks:v}=(Ja(),Z(Io));this.setText(v(this.firstChild.toString(),f(this,s),f(this,n)))},w=function(){if(f(this,s).excludes.includes("list"))return;let{parseList:v}=(Ya(),Z(Wo)),{firstChild:y,type:C,name:I}=this,D=y.toString().split(`
`),P={lastPrefix:""},q=C==="root"||C==="ext-inner"&&I==="poem"?0:1;for(;q<D.length;q++)D[q]=v(D[q],P,f(this,s),f(this,n));this.setText(D.join(`
`))},k=function(){if(f(this,s).variants.length>0){let{parseConverter:v}=(ic(),Z(Ro));this.setText(v(this.firstChild.toString(),f(this,s),f(this,n)))}},S)}}),kt,Is,xn,jt=$({"util/debug.ts"(){"use strict";kt={running:!1,run(t){let{running:e}=this;this.running=!0;try{let{Token:s}=(E(),Z(Cs)),n=t();return n instanceof s&&!n.getAttribute("built")&&n.afterBuild(),this.running=e,n}catch(s){throw this.running=e,s}},rev:0},Is=t=>e=>e.type===t,xn=(t,e,s,n=[])=>{var i,l;let r=t.getChildNodes(),o;r.length===s?(o=r,r=n):o=r.splice(e,s,...n);for(let a=0;a<n.length;a++){let c=n[a];c.setAttribute("parentNode",t),c.setAttribute("nextSibling",r[e+a+1]),c.setAttribute("previousSibling",r[e+a-1])}return(i=r[e-1])==null||i.setAttribute("nextSibling",r[e]),(l=r[e+n.length])==null||l.setAttribute("previousSibling",r[e+n.length-1]),r===n&&t.setAttribute("childNodes",r),o}}}),qo,Ts,bn,vn,zo,wn,Uo,yn,nc=$({"lib/lintConfig.ts"(){"use strict";On(),qo=new Set([0,1,2]),Ts=new Map([[0,!1],[1,"warning"],[2,"error"]]),bn={"bold-header":[1,{}],"format-leakage":[1,{}],"fostered-content":[1,{}],h1:[1,{}],"illegal-attr":[2,{}],"insecure-style":2,"invalid-gallery":[2,{parameter:1}],"invalid-imagemap":[2,{}],"invalid-invoke":[2,{}],"invalid-isbn":2,"lonely-apos":[1,{}],"lonely-bracket":[1,{extLink:2}],"lonely-http":[1,{}],"nested-link":[2,{}],"no-arg":1,"no-duplicate":[2,{category:1,id:1,unknownImageParameter:1}],"no-ignored":[2,{fragment:1,galleryComment:1,galleryNoImage:1,include:1,nonWordAttributes:1,redirect:1}],"obsolete-attr":1,"obsolete-tag":1,"parsing-order":[2,{templateInTable:1}],"pipe-like":[1,{double:2}],"table-layout":1,"tag-like":[2,{disallowed:1,invalid:1}],"unbalanced-header":2,"unclosed-comment":[1,{}],"unclosed-quote":1,"unclosed-table":2,unescaped:2,"unknown-page":1,"unmatched-tag":[1,{}],"unterminated-url":[1,{}],"url-encoding":[1,{}],"var-anchor":[1,{}],"void-ext":[2,{}]},Object.freeze(bn),vn=t=>typeof t=="number"&&qo.has(t),zo=t=>vn(t)||Array.isArray(t)&&t.length===2&&vn(t[0])&&t[1]&&typeof t[1]=="object",wn=(t,e,s)=>{if(_s.includes(e)){if(zo(s))return t[e]=s,!0}else throw new RangeError(`Unknown lint rule: ${e}`);throw new RangeError(`Invalid lint config for ${e}: ${JSON.stringify(s)}`)},Uo=class{constructor(t){if(Object.assign(this,JSON.parse(JSON.stringify(bn))),!!t)for(let[e,s]of Object.entries(t))wn(this,e,s)}getSeverity(t,e){var s;let n=this[t];return typeof n=="number"?Ts.get(n):e&&(s=Ts.get(n[1][e]))!=null?s:Ts.get(n[0])}},yn=t=>new Proxy(new Uo(t),{set:wn})}}),Bo={};st(Bo,{Title:()=>Ho});var Ho,rc=$({"lib/title.ts"(){"use strict";var t,e,s,n,i,l;Jt(),ht(),Ho=(l=class{constructor(r,o,a,{temporary:c,decode:h,selfLink:u}={}){T(this,t),T(this,e),T(this,s),T(this,n),T(this,i),Et(this,"valid"),Et(this,"encoded",!1);let d=r.trim().startsWith("../");if(h&&r.includes("%"))try{let p=/%(?!21|3[ce]|5[bd]|7[b-d])[\da-f]{2}/iu.test(r);r=Te(r),this.encoded=p}catch(p){}if(r=Ce(r).replace(/[_ ]+/gu," ").trim(),d)N(this,n,0);else{let p=o;r.startsWith(":")&&(p=0,r=r.slice(1).trim());let x=r.split(":");if(x.length>1){let b=ce(x[0]),m=Object.prototype.hasOwnProperty.call(a.nsid,b)&&a.nsid[b];m&&(p=m,r=x.slice(1).join(":").trim())}N(this,n,p)}let g=r.indexOf("#");if(g!==-1){let p=r.slice(g).trim().slice(1);if(p.includes("%"))try{p=Te(p)}catch(x){}N(this,i,p.replace(/ /gu,"_")),r=r.slice(0,g).trim()}this.valid=!!(r||u&&this.ns===0&&f(this,i)!==void 0)&&Ce(r)===r&&!/^:|\0\d+[eh!+-]\x7F|[<>[\]{}|\n]|%[\da-f]{2}|(?:^|\/)\.{1,2}(?:$|\/)/iu.test(d?/^(?:\.\.\/)+(.*)/u.exec(r)[1]:r),this.main=r,N(this,e,a.namespaces),N(this,s,a.articlePath||"/wiki/$1"),f(this,s).includes("$1")||N(this,s,f(this,s)+`${f(this,s).endsWith("/")?"":"/"}$1`),c||Object.defineProperties(this,{encoded:{enumerable:!1,writable:!1}})}get ns(){return f(this,n)}get fragment(){return f(this,i)}get main(){return f(this,t)}set main(r){r=r.replace(/_/gu," ").trim(),N(this,t,r&&r[0].toUpperCase()+r.slice(1))}get prefix(){let r=f(this,e)[this.ns];return r+(r&&":")}get title(){return this.getRedirection()[1]}get extension(){let{main:r}=this,o=r.lastIndexOf(".");return o===-1?void 0:r.slice(o+1).toLowerCase()}getRedirection(){return[!1,(this.prefix+this.main).replace(/ /gu,"_")]}setFragment(r){N(this,i,r)}getUrl(r){throw new Error("Title.getUrl method is only available in the LSP version!")}},t=new WeakMap,e=new WeakMap,s=new WeakMap,n=new WeakMap,i=new WeakMap,l)}}),Do={};st(Do,{default:()=>A}),L.exports=Z(Do);var Ns,Sn,Go,Gt,kn,Vo,A,_=$({"index.ts"(){On(),jt(),Zt(),ht(),nc(),Ns=!0,Sn=yn(),Gt={rules:_s,config:zs,get i18n(){return ft(ft({},Un),Go)},set i18n(t){Go=t},get lintConfig(){return Sn},set lintConfig(t){Sn=yn(t)},get viewOnly(){return Ns},set viewOnly(t){Ns&&!t&&kt.rev++,Ns=t},getConfig(t){let e=t!=null?t:this.config,{doubleUnderscore:s,ext:n,parserFunction:i,variable:l}=e;for(let r=0;r<2;r++)s.length>r+2&&s[r].length===0&&(s[r]=Object.keys(s[r+2]));return n.includes("translate")&&!l.includes("translationlanguage")&&(l.push("translationlanguage"),Array.isArray(i[1])?i[1].push("TRANSLATIONLANGUAGE"):i[1].TRANSLATIONLANGUAGE="translationlanguage"),Mt(ft(ft({},zs),e),{excludes:[]})},msg(t,e=""){var s;return t&&((s=this.i18n[t])!=null?s:t).replace("$1",this.msg(e))},normalizeTitle(t,e=0,s,n=Gt.getConfig(),i){let{Title:l}=(rc(),Z(Bo)),r;if(i!=null&&i.halfParsed)r=new l(t,e,n,i);else{let{Token:o}=(E(),Z(Cs));r=kt.run(()=>{let a=new o(t,n);a.type="root",a.parseOnce(0,s).parseOnce();let c=new l(a.toString(),e,n,i);a.build();for(let h of["main","fragment"]){let u=c[h];if(u!=null&&u.includes("\0")){let d=a.buildFromStr(u,1);h==="main"?c.main=d:c.setFragment(d)}}return c})}return r},parse(t,e,s=St,n=Gt.getConfig()){t=Pn(t);let i;typeof s!="number"&&(i=Array.isArray(s)?s:[s],s=Math.max(...i.map(r=>Mn[r]||St)));let{Token:l}=(E(),Z(Cs));return kt.run(()=>{let r=new l(t,n);return r.type="root",r.parse(s,e)})},async partialParse(t,e,s,n=Gt.getConfig()){},createLanguageService(t={}){throw new Error("Parser.createLanguageService method is only available in the LSP version!")}},kn={},Vo=new Set(["lintConfig","normalizeTitle","parse","createLanguageService"]);for(let t in Gt)Vo.has(t)||(kn[t]={enumerable:!1});Object.defineProperties(Gt,kn),Object.assign(typeof globalThis=="object"?globalThis:self,{Parser:Gt}),A=Gt}});_()});la()})()});var lc=ea();sa();var ia=["bold-header","format-leakage","table-layout","unknown-page","unclosed-table","unterminated-url","var-anchor"];Parser.lintConfig={"fostered-content":[1,{transclusion:0}],h1:1,"illegal-attr":[2,{tabindex:1,unknown:2,value:2}],"insecure-style":0,"lonely-apos":[1,{word:0}],"lonely-bracket":[1,{extLink:2,single:0}],"lonely-http":0,"no-arg":0,"no-duplicate":[2,{category:1,id:1,unknownImageParameter:0}],"unmatched-tag":0};for(let ct of ia)Parser.lintConfig[ct]=1;var Ws={},oc=ct=>{Parser.config=ct},ac=()=>Parser.getConfig(),cc=ct=>{let xt={};for(let At in ct)At.startsWith("codemirror-wikilint-")&&(xt[At.slice(20)]=ct[At]);Parser.i18n=xt},uc=()=>Parser.i18n,hc=ct=>{Parser.lintConfig=ct},dc=ct=>{if(Ws.wikitext===ct)return Ws.diagnostics;let xt=Parser.parse(ct).lint().map(At=>(ia.includes(At.rule)&&(At.severity="info"),At));return Ws.wikitext=ct,Ws.diagnostics=xt,xt};lc(oc,ac,dc,cc,uc,hc);})();
